0001   0000             		; --- December, 2008 by ARTRAG                      ---
0002   0000             
0003   0000                             output "deepdung.rom"
0004   0000                     org 0000h
0005   0000                                     
0006   0000                     include intro\introplayer.asm
0001+  0000             ntiles     equ     256
0002+  0000             
0003+  0000             		  
0004+  0000             ;-------------------------------------
0005+  0000             ;-------------------------------------
0006+  0000             		
0007+  0000             ; Set VDP for writing at address CDE (17-bits) 
0008+  0000             
0009+  0000             _vdpsetvramwr:
0010+  0000 79          	ld a,c     		
0011+  0001             
0012+  0001 CB 02       	rlc d
0013+  0003 17          	rla
0014+  0004 CB 02       	rlc d
0015+  0006 17          	rla
0016+  0007 CB 3A       	srl d 			; 1st shift, il secondo dopo la out
0017+  0009             
0018+  0009 D3 99       	out (0x99),a 	; set bits 14-16
0019+  000B 3E 8E       	ld a,14+128
0020+  000D D3 99       	out (0x99),a
0021+  000F             
0022+  000F CB 3A       	srl d 			; 2nd shift.            
0023+  0011             
0024+  0011 7B          	ld a,e 			; set bits 0-7
0025+  0012 D3 99       	out (0x99),a
0026+  0014 7A          	ld a,d 			; set bits 8-13
0027+  0015 E6 3F       	and	0x3F			
0028+  0017 F6 40       	or 0x40 		; + write access
0029+  0019 D3 99       	out (0x99),a
0030+  001B C9          	ret		
0031+  001C             
0032+  001C             ; Set VDP for reading at address CDE (17-bits) 
0033+  001C             
0034+  001C             _vdpsetvramrd:
0035+  001C 79          	ld a,c      
0036+  001D             
0037+  001D CB 02       	rlc d
0038+  001F 17          	rla
0039+  0020 CB 02       	rlc d
0040+  0022 17          	rla
0041+  0023 CB 3A       	srl d 			; 1st shift, il secondo dopo la out
0042+  0025             
0043+  0025 D3 99       	out (0x99),a 	; set bits 14-16
0044+  0027 3E 8E       	ld a,14+128
0045+  0029 D3 99       	out (0x99),a
0046+  002B             
0047+  002B CB 3A       	srl d 			; 2nd shift.            
0048+  002D             
0049+  002D 7B          	ld a,e 			; set bits 0-7
0050+  002E D3 99       	out (0x99),a
0051+  0030 7A          	ld a,d 			; set bits 8-13
0052+  0031 E6 3F       	and	0x3F
0053+  0033 D3 99       	out (0x99),a
0054+  0035 C9          	ret		
0055+  0036             
0056+  0036             
0057+  0036             ;-------------------------------------
0058+  0036             ; INTERRUPT CODE
0059+  0036             ;-------------------------------------
0060+  0036             
0061+  0036 00                    ds	$0038 - $
0062+  0038 F5                    push    af
0063+  0039 DB 99                 in      a,(99h)
0064+  003B F1                    pop     af
0065+  003C FB                    ei
0066+  003D ED 4D                 reti
0067+  003F             
0068+  003F             
0069+  003F             ;-------------------------------------
0070+  003F             ; Entry point
0071+  003F             ;-------------------------------------
0072+  003F             intro_START:
0073+  003F 0E 00       		ld	c,0
0074+  0041 11 00 00    		ld	de,0
0075+  0044 CD 00 00    		call	_vdpsetvramwr
0076+  0047 3E 01       		ld	a,1
0077+  0049 D3 98       		out	(0x98),a
0078+  004B             
0079+  004B 0E 01       		ld	c,1
0080+  004D 11 00 00    		ld	de,0
0081+  0050 CD 00 00    		call	_vdpsetvramwr
0082+  0053 3E 02       		ld	a,2
0083+  0055 D3 98       		out	(0x98),a
0084+  0057             		
0085+  0057 0E 00       		ld	c,0
0086+  0059 11 00 00    		ld	de,0		
0087+  005C CD 1C 00    		call	_vdpsetvramrd
0088+  005F DB 98       		in	a,(0x98)
0089+  0061 FE 01       		cp	1
0090+  0063 C2 B8 00    		jp nz,_vdpinit
0091+  0066             		
0092+  0066 FB          		ei
0093+  0067 76          		halt
0094+  0068 CD B8 00            call	_vdpinit
0095+  006B F3          		di
0096+  006C 3E 22       		ld		a, 0x22
0097+  006E D3 99       		out		(0x99),a
0098+  0070 3E 81       		ld		a,1+128
0099+  0072 D3 99       		out		(0x99),a
0100+  0074             
0101+  0074 CD E1 00    		call 	LOAD_VRAM
0102+  0077 1E 00       		ld		e,0
0103+  0079 CD D7 01    		call 	_SetPalet
0104+  007C             						
0105+  007C 3E E2       		ld		a, 0xE2 
0106+  007E D3 99       		out		(0x99),a
0107+  0080 3E 81       		ld		a,1+128
0108+  0082 D3 99       		out		(0x99),a
0109+  0084 FB          		ei
0110+  0085             
0111+  0085 06 B4       		ld      b,60*3
0112+  0087 CD 9D 00    		call    wait
0113+  008A             
0114+  008A FB          		ei
0115+  008B 76          		halt
0116+  008C             		
0117+  008C 1E 01       		ld		e,1
0118+  008E CD D7 01    		call 	_SetPalet
0119+  0091 CD B8 00    		call    _vdpinit
0120+  0094 3E 22       		ld		a, 0x22
0121+  0096 D3 99       		out		(0x99),a
0122+  0098 3E 81       		ld		a,1+128
0123+  009A D3 99       		out		(0x99),a
0124+  009C             		
0125+  009C C9          		ret
0126+  009D             
0127+  009D             
0128+  009D             
0129+  009D             ;-------------------------------------
0130+  009D             ;-------------------------------------
0131+  009D             wait:
0132+  009D 76          1:          halt
0133+  009E CD A4 00                call    skip
0134+  00A1 10 FA                   djnz    1b
0135+  00A3 C9                      ret
0136+  00A4             
0137+  00A4             ;
0138+  00A4             ;-------------------------------------
0139+  00A4             
0140+  00A4             skip:
0141+  00A4             
0142+  00A4 CD AB 7A                call MAIN._joy
0143+  00A7 E6 10                   and    00010000B
0144+  00A9 28 0A                   jr     z,2f        ; skip on joystick button
0145+  00AB 1E 08                   ld      e,8
0146+  00AD CD 25 53                call    checkkbd  ; skip on space
0147+  00B0 E6 01                   and    1
0148+  00B2 28 01                   jr     z,2f
0149+  00B4 C9                      ret
0150+  00B5 06 01       2:          ld b,1
0151+  00B7 C9                      ret
0152+  00B8             
0153+  00B8             ;-------------------------------------
0154+  00B8             ; Instead of CHGMOD
0155+  00B8             ;-------------------------------------
0156+  00B8             
0157+  00B8 F3          _vdpinit:   di
0158+  00B9 21 CB 00                ld hl,_vdpregs
0159+  00BC 01 99 80                ld bc,0x8099
0160+  00BF ED A3       1:          outi
0161+  00C1 04                      inc b
0162+  00C2 ED 41                   out (c),b
0163+  00C4 04                      inc b
0164+  00C5 CB 58                   bit 3,b
0165+  00C7 28 F6                   jr z,1b
0166+  00C9 FB          			ei
0167+  00CA C9                      ret
0168+  00CB             
0169+  00CB             _vdpregs:
0170+  00CB 02                      defb 0x02 ; Reg# 0 000000[M3][EV]
0171+  00CC E2                      defb 0xE2 ; Reg# 1 [4/16k][BLANK][IE][M1][M2]0[SIZE][MAG]
0172+  00CD 06                      defb 0x06 ; Reg# 2 0000[NAME TABLE BASE ADDRESS]          = 1800h
0173+  00CE FF                      defb 0xFF ; Reg# 3 [COLOR BASE ADDRESS]                   = 2000h     ; regular mode for colors
0174+  00CF 03                      defb 0x03 ; Reg# 4 00000[PATTERN GENERATOR BASE ADDRESS]  = 0000h     ; regular mode for patterns
0175+  00D0             
0176+  00D0 36                      defb 0x36 ; Reg# 5 0[SPRITE ATTRIBUTE TABLE BASE ADDRESS] = 1b00h
0177+  00D1 07                      defb 0x07 ; Reg# 6 00000[SPRITE PTRN GNRTR BASE ADDRESS]  = 3800h
0178+  00D2 00                      defb 0x00 ; Reg# 7 [TEXT COLOR 4bts][BACKDROP COLOR 4bts]
0179+  00D3             
0180+  00D3             
0181+  00D3             
0182+  00D3             
0183+  00D3             ;-------------------------------------
0184+  00D3             ; support i/o code
0185+  00D3             ;-------------------------------------
0186+  00D3             
0187+  00D3             outs768:
0188+  00D3             
0189+  00D3 11 00 18            ld      de,ntiles*8*3
0190+  00D6             2:
0191+  00D6 0E 98               ld      c,0x98
0192+  00D8             
0193+  00D8 ED A3       1:      outi
0194+  00DA 1D                  dec     e
0195+  00DB 20 FB               jr      nz,1b
0196+  00DD 15                  dec     d
0197+  00DE 20 F8               jr      nz,1b
0198+  00E0             
0199+  00E0 C9                  ret
0200+  00E1             
0201+  00E1             
0202+  00E1             
0203+  00E1             ;-------------------------------------
0204+  00E1             ; Load the vram
0205+  00E1             ;-------------------------------------
0206+  00E1             
0207+  00E1             LOAD_VRAM:
0208+  00E1 21 0B 02            ld      hl,pat
0209+  00E4 AF                  xor     a
0210+  00E5 D3 99               out     (0x99),a
0211+  00E7 3E 40               ld      a,0x0000/256 + 0x40 ; PGT
0212+  00E9 D3 99               out     (0x99),a
0213+  00EB             
0214+  00EB CD D3 00            call    outs768
0215+  00EE             
0216+  00EE 21 0B 1A    		ld      hl,col
0217+  00F1 AF                  xor     a
0218+  00F2 D3 99               out     (0x99),a
0219+  00F4 3E 60               ld      a,0x2000/256 + 0x40 ; PCT
0220+  00F6 D3 99               out     (0x99),a
0221+  00F8             
0222+  00F8 CD D3 00            call    outs768
0223+  00FB             		
0224+  00FB AF                  xor     a
0225+  00FC D3 99               out     (0x99),a
0226+  00FE 3E 58               ld      a,0x1800/256 + 0x40 ; PNT
0227+  0100 D3 99               out     (0x99),a
0228+  0102             
0229+  0102             		
0230+  0102 AF          		xor	a
0231+  0103 D3 98       1:		out	(0x98),a
0232+  0105 3C          		inc	a
0233+  0106 20 FB       		jr	nz,1b
0234+  0108 D3 98       1:		out	(0x98),a
0235+  010A 3C          		inc	a
0236+  010B 20 FB       		jr	nz,1b
0237+  010D D3 98       1:		out	(0x98),a
0238+  010F 3C          		inc	a
0239+  0110 20 FB       		jr	nz,1b
0240+  0112             
0241+  0112 C9                  ret
0242+  0113             
0243+  0113             ;-------------------------------------
0244+  0113             ; palette data
0245+  0113             ;-------------------------------------
0246+  0113             
0247+  0113             
0248+  0113             
0249+  0113             levelcolors:
0250+  0113 17 01 A7 01 	dw levelcolors0,levelcolors1
0251+  0117             levelcolors0:
0252+  0117 00 00 00    	db 0,0,0
0253+  011A 05 04 04    	db 5,4,4
0254+  011D 07 07 07    	db 7,7,7
0255+  0120 06 04 06    	db 6,4,6
0256+  0123 03 02 02    	db 3,2,2
0257+  0126 06 05 04    	db 6,5,4
0258+  0129 04 04 03    	db 4,4,3
0259+  012C 06 04 05    	db 6,4,5
0260+  012F 01 01 00    	db 1,1,0
0261+  0132 05 03 04    	db 5,3,4
0262+  0135 02 02 02    	db 2,2,2
0263+  0138 02 01 01    	db 2,1,1
0264+  013B 01 00 00    	db 1,0,0
0265+  013E 03 03 02    	db 3,3,2
0266+  0141 04 03 02    	db 4,3,2
0267+  0144 05 05 04    	db 5,5,4
0268+  0147             
0269+  0147 00 00 00     DB 0,0,0
0270+  014A 07 07 07     DB 7,7,7
0271+  014D 06 06 06     DB 6,6,6
0272+  0150 04 03 02     DB 4,3,2
0273+  0153 06 05 05     DB 6,5,5
0274+  0156 02 01 00     DB 2,1,0
0275+  0159 05 05 05     DB 5,5,5
0276+  015C 02 02 01     DB 2,2,1
0277+  015F 04 04 03     DB 4,4,3
0278+  0162 05 05 04     DB 5,5,4
0279+  0165 03 02 01     DB 3,2,1
0280+  0168 05 03 02     DB 5,3,2
0281+  016B 01 01 00     DB 1,1,0
0282+  016E 05 04 03     DB 5,4,3
0283+  0171 03 03 02     DB 3,3,2
0284+  0174 04 03 03     DB 4,3,3
0285+  0177             	
0286+  0177             _levelcolors0:
0287+  0177              ;   R,B,G
0288+  0177 00 00 01    	DB  0,0,1
0289+  017A 06 02 04    	DB  6,2,4
0290+  017D 03 01 01    	DB  3,1,1
0291+  0180 07 04 06    	DB  7,4,6
0292+  0183 04 02 03    	DB  4,2,3
0293+  0186 02 02 02    	DB  2,2,2
0294+  0189 06 03 05    	DB  6,3,5
0295+  018C 02 00 00    	DB  2,0,0
0296+  018F 04 01 01    	DB  4,1,1
0297+  0192 07 06 07    	DB  7,6,7
0298+  0195 05 01 03    	DB  5,1,3
0299+  0198 01 01 01    	DB  1,1,1
0300+  019B 05 01 01    	DB  5,1,1
0301+  019E 06 04 05    	DB  6,4,5
0302+  01A1 06 03 04    	DB  6,3,4
0303+  01A4 07 07 07    	DB  7,7,7
0304+  01A7              
0305+  01A7             levelcolors1:
0306+  01A7              ;   R,B,G
0307+  01A7 00 00 00    	db 0,0,0  	;0
0308+  01AA 00 00 00    	db 0,0,0	;1
0309+  01AD 01 02 04    	db 1,2,4	;2
0310+  01B0 02 03 06    	db 2,3,6	;3
0311+  01B3 02 05 02    	db 2,5,2	;4
0312+  01B6 03 07 03    	db 3,7,3	;5
0313+  01B9 06 01 02    	db 6,1,2	;6
0314+  01BC 02 06 06    	db 2,6,6	;7
0315+  01BF 07 01 01    	db 7,1,1	;8
0316+  01C2 07 02 03    	db 7,2,3	;9
0317+  01C5 06 02 05    	db 6,2,5	;10
0318+  01C8 07 03 06    	db 7,3,6	;11
0319+  01CB 02 01 03    	db 2,1,3	;12
0320+  01CE 05 04 02    	db 5,4,2	;13
0321+  01D1 05 05 05    	db 5,5,5
0322+  01D4 07 07 07    	db 7,7,7
0323+  01D7             
0324+  01D7             	
0325+  01D7             		
0326+  01D7             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0327+  01D7             		
0328+  01D7             _SetPalet:   
0329+  01D7             
0330+  01D7             VDP_0	equ	0xF3DF
0331+  01D7             VDP_8	equ	0xFFE7
0332+  01D7             VDP_25	equ	0xFFFA
0333+  01D7             
0334+  01D7 3A E7 FF    		ld	a,(VDP_8)				
0335+  01DA F6 20       		or	32						; set TP bit
0336+  01DC 32 E7 FF    		ld	(VDP_8),a
0337+  01DF D3 99               out (0x99),a			; color 0 from the palette
0338+  01E1 3E 88               ld  a,8 + 128
0339+  01E3 D3 99               out (0x99),a
0340+  01E5             		
0341+  01E5 AF          		xor a 						; Set pointer to zero.
0342+  01E6 D3 99               out (0x99),a        
0343+  01E8 3E 90               ld  a,16 + 128				; set palette pointer 
0344+  01EA D3 99               out (0x99),a
0345+  01EC             
0346+  01EC 6B          		ld	l,e
0347+  01ED 26 00       		ld	h,0
0348+  01EF 29          		add	hl,hl
0349+  01F0 11 13 01    		ld  de,levelcolors			
0350+  01F3 19          		add	hl,de
0351+  01F4 5E          		ld	e,(hl)
0352+  01F5 23          		inc	hl
0353+  01F6 56          		ld	d,(hl)
0354+  01F7 EB          		ex	de,hl
0355+  01F8             		
0356+  01F8 0E 9A               ld c,0x9A
0357+  01FA 06 10               ld	b,16
0358+  01FC 7E          1:      ld	a,(hl)
0359+  01FD 23          		inc	hl		
0360+  01FE 07          		RLCA
0361+  01FF 07          		RLCA
0362+  0200 07          		RLCA
0363+  0201 07          		RLCA
0364+  0202 B6          		or	(hl)
0365+  0203 23          		inc	hl
0366+  0204 ED 79       		out	(c),a
0367+  0206 ED A3       		outi
0368+  0208 20 F2               jr	nz,1b
0369+  020A             		
0370+  020A C9                  ret
0371+  020B             		
0372+  020B             ;-------------------------------------
0373+  020B             ; tile data
0374+  020B             ;-------------------------------------
0375+  020B             pat:
0376+  020B             	;incbin DRAGON2_.PAT
0377+  020B             	;incbin DDA3.pat
0378+  020B             	incbin DDA3NEW.pat,7
0379+  1A0B             col:
0380+  1A0B             	;incbin DRAGON2_.COL
0381+  1A0B             	;incbin DDA3.col
0382+  1A0B             	incbin DDA3NEW.col,7
0383+  320B             
0384+  320B             SAMPLE_END:
0385+  320B             
0386+  320B             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0387+  320B             
0388+  320B             
0389+  320B             
0390+  320B             FINISH:
0391+  320B             
0392+  320B             
0393+  320B             
0394+  320B             
0395+  320B             
0396+  320B             
0397+  320B             
0398+  320B             
0399+  320B             
0400+  320B             
0401+  320B             
0402+  320B             
0403+  320B             
0007   320B             
0008   320B 00          		ds	$4000 - $        
0009   4000                     org 4000h
0010   4000             		; --- ROM HEADER ---
0011   4000                             dw  0x4241,INIT,0,0,0,0,0,0   ; Rom starts in INIT label
0011   4000 41428244000000000000000000000000
0012   4010             
0013   4010                     include SETPAGES48K.ASM
0001+  4010             		; -----------------------------------------------------
0002+  4010             		; --- RUTINAS PARA COLOCAR LAS PAGINAS DEL CARTUCHO ---
0003+  4010             		; --- MODO 48K                                      ---
0004+  4010             		; -----------------------------------------------------
0005+  4010             		; --- SIEMPRE DEBEN IR EN LA PAGINA 1 DEL CARTUCHO! ---
0006+  4010             		; -----------------------------------------------------
0007+  4010             
0008+  4010             		; --- RUTINAS PRINCIPALES DEL MODULO ---
0009+  4010             		; SETPAGES48K:	BIOS-ROM-YY-ZZ	 -> ROM-ROM-ROM-ZZ (SITUA PAGINAS 2 Y 0, EN ESTE ORDEN)
0010+  4010             		;               ADEMAS GUARDA LOS SLOTS DEL JUEGO Y LA BIOS POR SI HAY QUE INTERCAMBIAR
0011+  4010             		; SETGAMEPAGE0:	XX-ROM-YY-ZZ     -> ROM-ROM-YY-ZZ (NO TOCA LA PAGINA 2)
0012+  4010             		; RESTOREBIOS:  XX-ROM-YY-ZZ     -> BIOS-ROM-YY-ZZ (VUELVE A SITUAR LA BIOS)
0013+  4010             		; SETPAGE0:	POSICIONA SLOT EN LA PAGINA 0
0014+  4010             
0015+  4010             		; --- VARIABLES EN RAM NECESARIAS ---
0016+  4010             		; SLOTBIOS:	BYTE PARA ALMACENAR EL SLOT DE LA BIOS
0017+  4010             		; SLOTGAME:	BYTE PARA ALMACENAR EL SLOT DEL JUEGO
0018+  4010             
0019+  4010             SLOTBIOS equ 0xffca     ; some unused locations
0020+  4010             SLOTGAME equ 0xffcb     ; some unused locations
0021+  4010             
0022+  4010             		INCLUDE	"SETPAGES32K.ASM"
0001++ 4010             		; -----------------------------------------------------
0002++ 4010             		; --- RUTINAS PARA COLOCAR LAS PAGINAS DEL CARTUCHO ---
0003++ 4010             		; -----------------------------------------------------
0004++ 4010             		; --- SIEMPRE DEBEN IR EN LA PAGINA 1 DEL CARTUCHO! ---
0005++ 4010             		; -----------------------------------------------------
0006++ 4010             
0007++ 4010             RSLREG  equ 0138h ;
0008++ 4010             ENASLT  equ 0024h ;
0009++ 4010             
0010++ 4010             		; --- RUTINAS PRINCIPALES DEL MODULO ---
0011++ 4010             		; GETSLOT:	OBTIENE EL VALOR DEL SLOT QUE LE INDIQUEMOS
0012++ 4010             		; SETPAGES32K:	BIOS-ROM-YY-ZZ	 -> BIOS-ROM-ROM-ZZ (SITUA PAGINA 2)
0013++ 4010             
0014++ 4010             		; --- VARIABLES EN RAM NECESARIAS ---
0015++ 4010             		; NINGUNA
0016++ 4010             
0017++ 4010             GETSLOT:	; --- Rutina que construye el valor del SLOT para llamar a ENASLT ---
0018++ 4010             		; --- Entrada: a = SLOT                                           ---
0019++ 4010             		; --- Salida: a = valor para ENASLT                               ---
0020++ 4010             		; --- AUTOR: Konamiman                                            ---
0021++ 4010 E6 03       		and	$03				; Proteccion, nos aseguramos de que el valor esta en 0-3
0022++ 4012 4F          		ld	c,a				; c = slot de la pagina
0023++ 4013 06 00       		ld	b,0				; bc = slot de la pagina
0024++ 4015 21 C1 FC    		ld	hl,$FCC1			; Tabla de slots expandidos
0025++ 4018 09          		add	hl,bc				; hl -> variable que indica si este slot esta expandido
0026++ 4019 7E          		ld	a,[hl]				; Tomamos el valor
0027++ 401A E6 80       		and	$80				; Si el bit mas alto es cero...
0028++ 401C 28 09       		jr	z,_EXIT			; ...nos vamos a @@EXIT
0029++ 401E             		; --- El slot esta expandido ---
0030++ 401E B1          		or	c				; Slot basico en el lugar adecuado
0031++ 401F 4F          		ld	c,a				; Guardamos el valor en c
0032++ 4020 23          		inc	hl				; Incrementamos hl una...
0033++ 4021 23          		inc	hl				; ...dos...
0034++ 4022 23          		inc	hl				; ...tres...
0035++ 4023 23          		inc	hl				; ...cuatro veces
0036++ 4024 7E          		ld	a,[hl]				; a = valor del registro de subslot del slot donde estamos
0037++ 4025 E6 0C       		and	$0C				; Nos quedamos con el valor donde esta nuestro cartucho
0038++ 4027 B1          _EXIT:		or	c				; Slot extendido/basico en su lugar
0039++ 4028 C9          		ret					; Volvemos
0040++ 4029             
0041++ 4029             SETPAGES32K:	; --- Posiciona las paginas de un megarom o un 32K ---
0042++ 4029 3E C9       		ld	a,$C9				; Codigo de RET
0043++ 402B 32 2E 40    		ld	[_NOPRET],a			; Modificamos la siguiente instruccion si estamos en RAM
0044++ 402E 00          _NOPRET:	nop					; No hacemos nada si no estamos en RAM
0045++ 402F             		; --- Si llegamos aqui no estamos en RAM, hay que posicionar la pagina ---
0046++ 402F CD 38 01    		call	RSLREG				; Leemos el contenido del registro de seleccion de slots
0047++ 4032 0F          		rrca					; Rotamos a la derecha...
0048++ 4033 0F          		rrca					; ...dos veces
0049++ 4034 CD 10 40    		call	GETSLOT				; Obtenemos el slot de la pagina 1 ($4000-$BFFF)
0050++ 4037 26 80       		ld	h,$80				; Seleccionamos pagina 2 ($8000-$BFFF)
0051++ 4039 C3 24 00    		jp	ENASLT				; Posicionamos la pagina 2 y volvemos
0023+  403C             
0024+  403C             SETPAGES48K:	; --- Posiciona las paginas de un cartucho de 48K ---
0025+  403C CD 29 40    		call	SETPAGES32K			; Colocamos la pagina 2 del cartucho
0026+  403F             		; --- Guardamos el slot de la BIOS por si tenemos que restaurarla ---
0027+  403F 3A C1 FC    		ld	a,[$FCC1]			; Valor del slot de la BIOS
0028+  4042 32 CA FF    		ld	[SLOTBIOS],a			; Grabamos el slot de la BIOS para recuperarlo si hace falta
0029+  4045             		; --- Guardamos el slot del juego por si hay que restaurarlo ---
0030+  4045 CD 38 01    		call	RSLREG				; Leemos el contenido del registro de seleccion de slots
0031+  4048 0F          		rrca					; Rotamos a la derecha...
0032+  4049 0F          		rrca					; ...dos veces
0033+  404A CD 10 40    		call	GETSLOT				; Obtenemos el slot de la pagina 1 ($4000-$7FFF) y volvemos
0034+  404D 32 CB FF    		ld	[SLOTGAME],a			; Grabamos el slot del juego para recuperarlo si hace falta
0035+  4050             SETGAMEPAGE0:	; --- RUTINA QUE POSICIONA LA PAGINA 0 DEL JUEGO ---
0036+  4050             		; ---     ANTES HAY QUE LLAMAR A SETPAGES48K     ---
0037+  4050 3A CB FF    		ld	a,[SLOTGAME]			; Leemos el slot del juego
0038+  4053 C3 59 40    		jp	SETPAGE0			; Situamos la pagina 0 del juego y volvemos
0039+  4056             RESTOREBIOS:	; --- RUTINA QUE VUELVE A SITUAR LA BIOS ---
0040+  4056             		; --- ANTES HAY QUE LLAMAR A SETPAGES48K ---
0041+  4056 3A CA FF    		ld	a,[SLOTBIOS]			; Leemos el slot de la BIOS
0042+  4059             SETPAGE0:	; --- RUTINA QUE POSICIONA SLOT EN LA PAGINA 0 ---
0043+  4059             		; --- AUTOR: Ramones                           ---
0044+  4059             		; --- ENTRADA: a = slot con formato FxxxSSPP   ---
0045+  4059 F3          		di					; Desactivamos las interrupciones
0046+  405A 47          		ld	b,a				; Guardamos el slot
0047+  405B DB A8       		in	a,[$0A8]			; Leemos el registro principal de slots
0048+  405D E6 FC       		and	$FC				; Nos quedamos con los valores de las tres paginas superiores
0049+  405F 57          		ld	d,a				; D = Valor del slot primario
0050+  4060 78          		ld	a,b				; Recuperamos el slot
0051+  4061 E6 03       		and	$03				; Nos fijamos en el slot primario
0052+  4063 B2          		or	d				; Colocamos los bits de las paginas superiores
0053+  4064 57          		ld	d,a				; Guardamos en D el valor final para el slot primario
0054+  4065             		; Comprobamos si esta expandido
0055+  4065 78          		ld	a,b				; Recuperamos el slot
0056+  4066 CB 7F       		bit	7,a				; Miramos el bit de expansion
0057+  4068 28 1D       		jr	z,_SETPRIMARY			; ...y saltamos si no esta expandido
0058+  406A             		; Si llegamos aqui el slot esta expandido
0059+  406A E6 03       		and	03h				; Nos quedamos con el slot primario
0060+  406C 0F          		rrca					; Rotamos ciclicamente a la derecha una...
0061+  406D 0F          		rrca					; ...y dos veces
0062+  406E 4F          		ld	c,a				; Guardamos el valor en c
0063+  406F 7A          		ld	a,d				; Recuperamos el valor final para el slot primario
0064+  4070 E6 3F       		and	$3F				; Nos quedamos con las paginas 0, 1 y 2
0065+  4072 B1          		or	c				; Colocamos los bits para la pagina 3
0066+  4073 4F          		ld	c,a				; C:=valor del slot primario incluso en pagina 3
0067+  4074 78          		ld	a,b				; Recuperamos otra vez el slot
0068+  4075 E6 0C       		and	$0C				; Nos quedamos con el valor del subslot
0069+  4077 0F          		rrca					; Rotamos ciclicamente a la derecha una...
0070+  4078 0F          		rrca					; ...y dos veces
0071+  4079 47          		ld	b,a				; B:= Slot expandido en pagina 3
0072+  407A 79          		ld	a,c				; valor del slot primario incluyendo pagina 3
0073+  407B D3 A8       		out	[$A8],a				; Slots : Primario, xx, xx, Primario
0074+  407D 3A FF FF    		ld	a,[$FFFF]			; Leemos registro de seleccion de subslots
0075+  4080 2F          		cpl					; Complementamos (recordemos que siempre hay que complementarlo)
0076+  4081 E6 FC       		and	$FC				; Nos quedamos con las paginas superiores
0077+  4083 B0          		or	b				; Colocamos el valor del slot expandido en pagina 0
0078+  4084 32 FF FF    		ld	[$FFFF],a			; Seleccionamos el slot expandido
0079+  4087             _SETPRIMARY:	; --- Colocamos el slot primario ---
0080+  4087 7A          		ld	a,d				; Valor final del slot primario
0081+  4088 D3 A8       		out	[$A8],a				; Slots: Seleccionado, xx, xx, Ram
0082+  408A C9          		ret					; Volvemos
0014   408B             
0015   408B             		INCLUDE "sccdetect\SCCaudio.asm"
0001+  408B             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0002+  408B             ;
0003+  408B             ;   Mapper Konami 5 (mapper +  scc)
0004+  408B             ;
0005+  408B             ; Bank 1: 5000h - 57FFh (5000h used)
0006+  408B             ; Bank 2: 7000h - 77FFh (7000h used)
0007+  408B             ; Bank 3: 9000h - 97FFh (9000h used)
0008+  408B             ; Bank 4: B000h - B7FFh (B000h used)
0009+  408B             
0010+  408B             Bank1   equ      0x5000
0011+  408B             Bank2   equ      0x7000
0012+  408B             Bank3   equ      0x9000
0013+  408B             Bank4   equ      0xB000
0014+  408B             
0015+  408B             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0016+  408B             ;
0017+  408B             
0018+  408B             Audio_init_code:
0019+  408B             
0020+  408B             ; some ayFX init
0021+  408B             
0022+  408B CD C3 BA        call	ayFX_SETUP
0023+  408E             
0024+  408E             ; some PT3 init
0025+  408E             
0026+  408E CD BF A0        call    PT3_MUTE
0027+  4091             
0028+  4091             ; some scc init
0029+  4091             
0030+  4091 CD 95 40        call 	_SCC_PSG_Volume_balance
0031+  4094 C9          	ret
0032+  4095             	
0033+  4095             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0034+  4095             ;
0035+  4095             ;   compute SCC/PSG Volume balance
0036+  4095             ;
0037+  4095             
0038+  4095             
0039+  4095             _SCC_PSG_Volume_balance:
0040+  4095             
0041+  4095 3A D5 E5        ld  a,(_psg_vol_fix)
0042+  4098 C6 0F           add a,15
0043+  409A 20 02           jr  nz,1f
0044+  409C 3E 01           ld  a,1
0045+  409E             1:        
0046+  409E 87              add	a,a				; a:=a*2
0047+  409F 87              add	a,a				; a:=a*4
0048+  40A0 87              add	a,a				; a:=a*8
0049+  40A1 87              add	a,a				; a:=a*16
0050+  40A2 5F              ld	e,a				; e:=a
0051+  40A3 16 00           ld	d,0				; de:=a
0052+  40A5 21 CB E4        ld	hl,VT_			; hl:=PT3 volume table
0053+  40A8 19              add	hl,de			; hl is a pointer to the relative volume table
0054+  40A9             
0055+  40A9 22 FD E5        ld  (VolBalance),hl
0056+  40AC C9              ret
0057+  40AD             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0058+  40AD             ;
0059+  40AD             ;   Interrupt handler
0060+  40AD             ;
0061+  40AD             
0062+  40AD                 
0063+  40AD             
0064+  40AD             Audio_I_O_code:
0065+  40AD             
0066+  40AD             	
0067+  40AD             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0068+  40AD             ; Audio I/O
0069+  40AD             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0070+  40AD             
0071+  40AD                 ; --- Place this instruction on interrupt --- 
0072+  40AD             	; --- or after HALT instruction to synchronize music ---
0073+  40AD             
0074+  40AD CD F7 40        call    PT3_ROUT		 ; Write values on PSG registers
0075+  40B0                 
0076+  40B0 C2 CC 43        jp      nz,1f
0077+  40B3 CD 87 43        call    probewavechanges
0078+  40B6 CD 18 43        call    SCCROUT
0079+  40B9 C9          	ret
0080+  40BA             
0081+  40BA             
0082+  40BA             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0083+  40BA             ; Audio Internal code
0084+  40BA             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0085+  40BA             Audio_Internal_code:
0086+  40BA             
0087+  40BA 3E BF           ld  a,010111111B
0088+  40BC 32 D2 E4        ld  (AYREGS+7),a
0089+  40BF             
0090+  40BF             ; Only if musics are in ROM
0091+  40BF             
0092+  40BF             
0093+  40BF                 ; --- To speed up VDP writes you can place this instruction after all of them, but before next INT ---
0094+  40BF CD 91 A4        call    PT3_PLAY			; Calculates PSG values for next frame
0095+  40C2             
0096+  40C2 21 CB E4        ld      hl,AYREGS
0097+  40C5 11 F0 E5        ld      de,AYREGS_CPY
0098+  40C8 01 0D 00        ld      bc,13
0099+  40CB ED B0           ldir                        ; save a copy of AY register to avoid that SCCROUT get affected by AYFX
0100+  40CD             
0101+  40CD                 ; --- PSG/SCC volume balance
0102+  40CD                 ; only for music
0103+  40CD             
0104+  40CD ED 5B FD E5     ld  de,(VolBalance)
0105+  40D1             
0106+  40D1 DD 21 D3 E4     ld	ix,AYREGS+8
0107+  40D5                
0108+  40D5 DD 6E 00        ld  l,(ix+0)
0109+  40D8 26 00           ld  h,0
0110+  40DA 19              add hl,de
0111+  40DB 7E              ld  a,(hl)
0112+  40DC DD 77 00        ld  (ix+0),a
0113+  40DF             
0114+  40DF DD 6E 01        ld  l,(ix+1)
0115+  40E2 26 00           ld  h,0
0116+  40E4 19              add hl,de
0117+  40E5 7E              ld  a,(hl)
0118+  40E6 DD 77 01        ld  (ix+1),a
0119+  40E9                 
0120+  40E9 DD 6E 02        ld  l,(ix+2)
0121+  40EC 26 00           ld  h,0
0122+  40EE 19              add hl,de
0123+  40EF 7E              ld  a,(hl)
0124+  40F0 DD 77 02        ld  (ix+2),a
0125+  40F3                 
0126+  40F3                 ; ayFX player section
0127+  40F3              
0128+  40F3                 ; --- To speed up VDP writes you can place this instruction after all of them, but before next INT ---
0129+  40F3 CD 16 BB        call     ayFX_FRAME			; Calculates PSG values for next frame
0130+  40F6             
0131+  40F6 C9          	ret
0132+  40F7             
0133+  40F7             
0134+  40F7             ;-------------------------------------
0135+  40F7             
0136+  40F7             PT3_ROUT:
0137+  40F7 AF                  XOR A
0138+  40F8                     
0139+  40F8 21 D2 E4    		LD	HL,AYREGS+7
0140+  40FB CB FE       		set	7,(hl)        ; --- FIXES BITS 6 AND 7 OF MIXER ---
0141+  40FD CB B6       		res	6,(hl)        ; --- FIXES BITS 6 AND 7 OF MIXER ---
0142+  40FF             
0143+  40FF 0E A0       		LD C,0xA0
0144+  4101 21 CB E4    		LD HL,AYREGS
0145+  4104             _LOUT:
0146+  4104 ED 79               OUT (C),A
0147+  4106 0C          		INC C
0148+  4107 ED A3       		OUTI
0149+  4109 0D          		DEC C
0150+  410A 3C          		INC A
0151+  410B FE 0D       		CP 13
0152+  410D 20 F5       		JR NZ,_LOUT
0153+  410F ED 79       		OUT (C),A
0154+  4111 7E          		LD A,(HL)
0155+  4112 A7          		AND A
0156+  4113 F8          		RET M
0157+  4114 0C          		INC C
0158+  4115 ED 79       		OUT (C),A
0159+  4117 C9          		RET
0160+  4118             
0161+  4118             
0162+  4118             
0163+  4118             
0164+  4118             ;-------------------------------------
0165+  4118             
0166+  4118             
0167+  4118             
0168+  4118             
0016   4118             		INCLUDE "sccdetect\SCCWAVES.ASM"
0001+  4118             
0002+  4118             
0003+  4118             ;--------------------------------------------------------
0004+  4118             _WAVESSCC:                                               ; 15 instruments
0005+  4118             
0006+  4118             
0007+  4118             
0008+  4118               
0009+  4118 00          	ds     32;     empty
0010+  4138             ;    db     242,235,234,209,219,213,219,205,202,238,225,6,4,10,17,26,8,254,8,255,5,21,27,27,53,54,31,46,38,7,254,240			; 01_piano.wav
0011+  4138             
0012+  4138                 db     242,235,234,209,219,213,219,205,202,238,225,6,4,10,17,26,8,254,8,255,5,21,27,27,53,54,31,46,38,7,254,240			; 01_piano.wav
0012+  4138 F2EBEAD1DBD5DBCDCAEEE106040A111A08FE08FF05151B1B35361F2E2607FEF0
0013+  4158                 db     43,30,15,11,250,248,236,234,237,251,2,248,3,248,237,242,239,231,253,246,14,11,0,8,239,223,240,229,1,33,47,58		; 02_harpsch.wav
0013+  4158 2B1E0F0BFAF8ECEAEDFB02F803F8EDF2EFE7FDF60E0B0008EFDFF0E501212F3A
0014+  4178                 db     59,59,50,38,25,15,254,234,218,205,209,223,228,233,245,3,23,45,58,57,40,13,245,223,208,200,193,199,224,254,27,49	; 03_harp.wav
0014+  4178 3B3B3226190FFEEADACDD1DFE4E9F503172D3A39280DF5DFD0C8C1C7E0FE1B31
0015+  4198                 db     210,195,203,222,255,21,33,25,20,16,0,251,245,238,253,20,27,29,22,14,9,0,246,236,232,237,2,25,33,24,253,230		; 04_strgs.wav
0015+  4198 D2C3CBDEFF152119141000FBF5EEFD141B1D160E0900F6ECE8ED02192118FDE6
0016+  41B8                 db     204,194,205,226,255,23,39,52,34,16,1,239,232,247,1,21,39,41,23,15,5,254,248,244,231,242,11,15,24,18,246,215		; 05_slwstr.wav
0016+  41B8 CCC2CDE2FF172734221001EFE8F701152729170F05FEF8F4E7F20B0F1812F6D7
0017+  41D8                 db     49,42,33,25,18,5,238,213,196,195,214,243,10,20,16,2,245,239,239,244,250,255,2,2,254,249,244,245,255,19,40,51		; 06_flute.wav
0017+  41D8 312A21191205EED5C4C3D6F30A141002F5EFEFF4FAFF0202FEF9F4F5FF132833
0018+  41F8                 db     59,63,60,47,30,16,10,8,4,0,250,244,240,242,246,248,247,240,232,225,219,215,208,203,206,217,234,255,17,33,46,55	; 07_fltvib.wav
0018+  41F8 3B3F3C2F1E100A080400FAF4F0F2F6F8F7F0E8E1DBD7D0CBCED9EAFF11212E37
0019+  4218                 db     0,0,254,255,1,3,6,4,255,250,240,228,219,220,250,41,192,35,1,3,4,5,0,252,252,255,2,1,248,245,248,253				; 08_trmpt.wav
0019+  4218 0000FEFF01030604FFFAF0E4DBDCFA29C0230103040500FCFCFF0201F8F5F8FD
0020+  4238                 db     243,4,27,23,16,23,20,22,22,4,254,231,213,215,216,230,243,1,27,43,58,58,38,23,5,236,221,224,224,222,226,229		; 09_strpzz.wav
0020+  4238 F3041B17101714161604FEE7D5D7D8E6F3011B2B3A3A261705ECDDE0E0DEE2E5
0021+  4258                 db     240,7,23,31,46,35,43,24,14,5,230,228,214,207,215,221,239,3,13,32,35,45,43,32,26,0,247,228,212,214,209,221		; 10_clst.wav
0021+  4258 F007171F2E232B180E05E6E4D6CFD7DDEF030D20232D2B201A00F7E4D4D6D1DD
0022+  4278                 db     254,214,193,203,221,228,221,211,209,210,212,219,229,232,233,246,10,16,0,249,12,32,32,32,46,52,37,19,13,15,7,243	; 11_mrmb.wav
0022+  4278 FED6C1CBDDE4DDD3D1D2D4DBE5E8E9F60A1000F90C2020202E3425130D0F07F3
0023+  4298                 db     6,216,0,15,241,219,239,3,12,46,245,23,20,229,6,21,212,228,211,211,18,1,245,49,19,246,37,32,15,19,223,244			; 12_vln.wav
0023+  4298 06D8000FF1DBEF030C2EF51714E50615D4E4D3D31201F53113F625200F13DFF4
0024+  42B8                 db     242,194,210,213,212,210,236,5,15,38,40,30,26,26,20,24,250,243,245,235,243,234,220,237,246,252,30,47,28,38,43,29	; 13_vlnvb.wav
0024+  42B8 F2C2D2D5D4D2EC050F26281E1A1A1418FAF3F5EBF3EADCEDF6FC1E2F1C262B1D
0025+  42D8                 db     58,63,62,57,51,47,44,43,45,49,54,58,59,60,59,59,58,58,57,57,56,56,56,55,55,54,54,54,53,53,52,52					; 14_snrdr.wav
0025+  42D8 3A3F3E39332F2C2B2D31363A3B3C3B3B3A3A3939383838373736363635353434
0026+  42F8             	db	   38,209,31,234,227,231,255,13,34,44,23,248,228,255,23,34,18,8,4,2,255,254,255,246,238,237,245,243,226,215,213,17	; 15_aaaaaaa.wav
0026+  42F8 26D11FEAE3E7FF0D222C17F8E4FF172212080402FFFEFFF6EEEDF5F3E2D7D511
0027+  4318             
0028+  4318             	
0029+  4318             
0030+  4318             ;-------------------------------------
0031+  4318             ;  scc eches for PT3
0032+  4318             ;-------------------------------------
0033+  4318             SCC_REG     EQU 009880h           ;SCC ADDRESS FUNCTION
0034+  4318             
0035+  4318             SCCROUT:
0036+  4318                         ;Frequencies
0037+  4318 CD E4 43    		call en_scc
0038+  431B 3E 3F               ld  a,03Fh
0039+  431D 32 00 90            ld  (Bank3),a
0040+  4320             
0041+  4320 2A F0 E5            LD  HL,(AYREGS_CPY+0)       ; A-> ch 1 
0042+  4323 22 80 98            LD  (SCC_REG+0),HL
0043+  4326 2A F2 E5            LD  HL,(AYREGS_CPY+2)       ; C-> ch 2
0044+  4329 22 82 98            LD  (SCC_REG+2),HL
0045+  432C 2A F4 E5            LD  HL,(AYREGS_CPY+4)       ; B-> ch 3
0046+  432F 22 84 98            LD  (SCC_REG+4),HL
0047+  4332             
0048+  4332                         ;VOLUMES
0049+  4332             
0050+  4332 3A F8 E5            ld      a,(AYREGS_CPY+8)
0051+  4335 32 8A 98            ld      (SCC_REG+0x0A),a    ; A-> ch 1 
0052+  4338 3A F9 E5            ld      a,(AYREGS_CPY+9)
0053+  433B 32 8B 98            LD      (SCC_REG+0x0B),A    ; C-> ch 2
0054+  433E 3A FA E5            ld      a,(AYREGS_CPY+10)
0055+  4341 32 8C 98            LD      (SCC_REG+0x0C),A    ; B-> ch 3
0056+  4344             
0057+  4344                         ;MIXER
0058+  4344             
0059+  4344 3A F7 E5            ld      a,(AYREGS_CPY+7)
0060+  4347 EE 07               xor     7        
0061+  4349 E6 07               and     7
0062+  434B 32 8F 98            ld      (SCC_REG+0x0F),a
0063+  434E             
0064+  434E                     ; ld  a,(__BBR)
0065+  434E                     ; inc a
0066+  434E                     ; ld  (Bank3),a
0067+  434E             
0068+  434E CD ED 43    		call en_slot
0069+  4351 C9                  RET
0070+  4352             
0071+  4352             
0072+  4352             ;-------------------------------------
0073+  4352             ; A-> ch 1 
0074+  4352             ; B-> ch 2
0075+  4352             ; C-> ch 3
0076+  4352             
0077+  4352             
0078+  4352             setsccwaves:
0079+  4352             
0080+  4352 F3              di
0081+  4353             	
0082+  4353 CD E4 43    	call en_scc
0083+  4356             	
0084+  4356 3E 3F           ld      a,3fh
0085+  4358 32 00 90        ld      (Bank3),a
0086+  435B             
0087+  435B 11 00 98        ld      de,0x09800
0088+  435E 3A D9 E5        ld      a,(wchA)                            ; A->ch1
0089+  4361 CD 74 43        call    sccchan                             
0090+  4364             
0091+  4364 3A DA E5        ld      a,(wchB)                            ; B->ch2
0092+  4367 CD 74 43        call    sccchan
0093+  436A             
0094+  436A 3A DB E5        ld      a,(wchC)                            ; C->ch3
0095+  436D CD 74 43        call    sccchan
0096+  4370             
0097+  4370 CD ED 43       	call en_slot
0098+  4373             
0099+  4373 C9          	ret
0100+  4374             
0101+  4374             
0102+  4374             sccchan:
0103+  4374 E5              push    hl
0104+  4375 6F              ld      l,a
0105+  4376 26 00           ld      h,0
0106+  4378                 rept 4
0107+  4378~                add     hl,hl
0108+  4378                 endm
0108+  4378 29          >    add     hl,hl
0108+  4379 29          >    add     hl,hl
0108+  437A 29          >    add     hl,hl
0108+  437B 29          >    add     hl,hl
0109+  437C 01 18 41        ld      bc, _WAVESSCC
0110+  437F 09              add     hl,bc
0111+  4380 01 20 00        ld      bc,32
0112+  4383 ED B0           ldir
0113+  4385 E1              pop     hl
0114+  4386 C9              ret
0115+  4387             
0116+  4387             
0117+  4387             
0118+  4387             
0119+  4387             probewavechanges:
0120+  4387 CD E4 43       	call en_scc
0121+  438A             
0122+  438A 21 D6 E5         ld  hl,OSmplA
0123+  438D             
0124+  438D 3A 88 E4         ld  a,(ChanA+29)
0125+  4390 BE               cp  (hl)
0126+  4391 C4 A8 43         call  nz,changeA
0127+  4394             
0128+  4394 23               inc hl
0129+  4395 3A A6 E4         ld  a,(ChanB+29)
0130+  4398 BE               cp  (hl)
0131+  4399 C4 B5 43         call  nz,changeB
0132+  439C             
0133+  439C 23               inc hl
0134+  439D 3A C4 E4         ld  a,(ChanC+29)
0135+  43A0 BE               cp  (hl)
0136+  43A1 C4 C2 43         call  nz,changeC
0137+  43A4             
0138+  43A4 CD ED 43    	call en_slot
0139+  43A7 C9              ret
0140+  43A8             
0141+  43A8             
0142+  43A8             changeA:
0143+  43A8 77              ld      (hl),a
0144+  43A9 CD D7 43        call    samp2wav
0145+  43AC 32 D9 E5        ld      (wchA),a
0146+  43AF 11 00 98        ld      de,0x09800                      ; A->ch1
0147+  43B2 C3 CC 43        jp      1f
0148+  43B5                 
0149+  43B5             changeB:
0150+  43B5 77              ld      (hl),a
0151+  43B6 CD D7 43        call    samp2wav
0152+  43B9 32 DA E5        ld      (wchB),a
0153+  43BC 11 20 98        ld      de,0x09800+32*1                 ; B->ch2
0154+  43BF C3 CC 43        jp      1f
0155+  43C2             
0156+  43C2             changeC:
0157+  43C2 77              ld      (hl),a
0158+  43C3 CD D7 43        call    samp2wav
0159+  43C6 32 DB E5        ld      (wchC),a
0160+  43C9 11 40 98        ld      de,0x09800+32*2                 ; C->ch3
0161+  43CC             
0162+  43CC             1:
0163+  43CC 4F              ld      c,a
0164+  43CD             
0165+  43CD 3E 3F           ld      a,3fh
0166+  43CF 32 00 90        ld      (Bank3),a
0167+  43D2             
0168+  43D2 79              ld      a,c
0169+  43D3 CD 74 43        call    sccchan      
0170+  43D6                 
0171+  43D6                 ; ld      a,(__BBR)
0172+  43D6                 ; ld      (Bank2),a
0173+  43D6                 ; inc     a
0174+  43D6                 ; ld      (Bank3),a
0175+  43D6                 ; inc     a
0176+  43D6                 ; ld      (Bank4),a
0177+  43D6             
0178+  43D6 C9              ret
0179+  43D7             
0180+  43D7             
0181+  43D7             
0182+  43D7             samp2wav:
0183+  43D7 D9               exx
0184+  43D8 21 DC E5         ld hl,_waves
0185+  43DB 0F               rrca
0186+  43DC 5F               ld e,a
0187+  43DD 16 00            ld d,0
0188+  43DF 19               add   hl,de
0189+  43E0 7E               ld    a,(hl)
0190+  43E1 87               add   a,a
0191+  43E2 D9               exx
0192+  43E3 C9               ret
0193+  43E4                  
0194+  43E4             en_scc:
0195+  43E4 3A EE E5    		ld	a,[SCC]				; Recuperamos el slot
0196+  43E7 26 80       		ld	h,0x80
0197+  43E9 CD 24 00    		call enaslt
0198+  43EC C9          		ret
0199+  43ED             		
0200+  43ED             		; in	a,[$0A8]			; Leemos el registro principal de slots
0201+  43ED             		; and		11001111b		; D = Valor del slot primario
0202+  43ED             		; ld		d,a
0203+  43ED             		; ld	a,[SCC]				; Recuperamos el slot
0204+  43ED             		; and	$03					; Nos fijamos en el slot primario
0205+  43ED             		; rept 4
0206+  43ED             		; add	a,a
0207+  43ED             		; endm
0208+  43ED             		; or	d				; Colocamos los bits de las paginas superiores
0209+  43ED             		; out	[$A8],a				; Slots: Seleccionado, xx, xx, Ram
0210+  43ED             		; ret
0211+  43ED             en_slot:
0212+  43ED 3A CB FF    		ld	a,[SLOTGAME]
0213+  43F0 26 80       		ld	h,0x80
0214+  43F2 CD 24 00    		call enaslt
0215+  43F5 C9          		ret
0216+  43F6             
0217+  43F6             		; in	a,[$0A8]			; Leemos el registro principal de slots
0218+  43F6             		; and		11001111b		; D = Valor del slot primario
0219+  43F6             		; ld		d,a
0220+  43F6             		; ld	a,[SLOTGAME]
0221+  43F6             		; and	$03					; Nos fijamos en el slot primario
0222+  43F6             		; rept 4
0223+  43F6             		; add	a,a
0224+  43F6             		; endm
0225+  43F6             		; or	d				; Colocamos los bits de las paginas superiores
0226+  43F6             		; out	[$A8],a				; Slots: Seleccionado, xx, xx, Ram
0227+  43F6             		; ret
0017   43F6             		INCLUDE "sccdetect\SCCDETEC.ASM"		
0001+  43F6             ;------------------------------------------------------------
0002+  43F6             ; SCC-search v1.0
0003+  43F6             ; by Alwin Henseler
0004+  43F6             ; using method described in bulletin # 18 MSX-club Enschede
0005+  43F6             ; input: none
0006+  43F6             ; output: B=slot that contains SCC (=255 if no SCC found)
0007+  43F6             
0008+  43F6             enaslt:          equ #0024
0009+  43F6             exptbl:          equ #fcc1
0010+  43F6             slttbl:          equ #fcc5
0011+  43F6             
0012+  43F6             
0013+  43F6             
0014+  43F6                              ; db 254
0015+  43F6                              ; dw begin,end-1,begin
0016+  43F6             
0017+  43F6                              ; org #c000
0018+  43F6             				 
0019+  43F6             
0020+  43F6             begin:
0021+  43F6             				TEXTAREA #c000
0022+  C000 DB A8                        in a,(#a8)        ; read prim. slotregister
0023+  C002 1F                           rra
0024+  C003 1F                           rra
0025+  C004 1F                           rra
0026+  C005 1F                           rra
0027+  C006 E6 03                        and %00000011     ; A = prim.slot page 2
0028+  C008 06 00                        ld b,0
0029+  C00A 4F                           ld c,a
0030+  C00B 21 C1 FC                     ld hl,exptbl
0031+  C00E 09                           add hl,bc
0032+  C00F CB 7E                        bit 7,(hl)        ; page 2-slot expanded ?
0033+  C011 28 0C                        jr z,scctest
0034+  C013 21 C5 FC                     ld hl,slttbl
0035+  C016 09                           add hl,bc
0036+  C017 7E                           ld a,(hl)         ; A = sec.sel.reg. of page 2-slot
0037+  C018 1F                           rra
0038+  C019 1F                           rra
0039+  C01A E6 0C                        and %00001100     ; bit 1/2 = sec.slot page 2
0040+  C01C B1                           or c
0041+  C01D CB FF                        set 7,a           ; compose sec.slot-code
0042+  C01F F5          scctest:         push af           ; save page 2-slot on the stack
0043+  C020 3A C1 FC                     ld a,(exptbl)     ; 1st slot to test
0044+  C023             
0045+  C023 F5          testslot:        push af           ; save test-slot on the stack
0046+  C024 26 80                        ld h,#80
0047+  C026 CD 24 00                     call enaslt       ; switch slot-to-test in 8000-bfffh
0048+  C029 21 00 90                     ld hl,#9000
0049+  C02C 46                           ld b,(hl)         ; save contents of address 9000h
0050+  C02D 36 3F                        ld (hl),#3f       ; activate SCC (if present)
0051+  C02F 26 9C                        ld h,#9c          ; address of SCC-register mirrors
0052+  C031 11 00 98                     ld de,#9800       ; 9800h = address of SCC-registers
0053+  C034 1A          testreg:         ld a,(de)
0054+  C035 4F                           ld c,a            ; save contents of address 98xxh
0055+  C036 7E                           ld a,(hl)         ; read byte from address 9cxxh
0056+  C037 2F                           cpl               ; and invert it
0057+  C038 12                           ld (de),a         ; write inverted byte to 98xxh
0058+  C039 BE                           cp (hl)           ; same value on 9cxxh ?
0059+  C03A 79                           ld a,c
0060+  C03B 12                           ld (de),a         ; restore value on 98xxh
0061+  C03C 20 0D                        jr nz,nextslot    ; unequal -> no SCC -> continue search
0062+  C03E 23                           inc hl
0063+  C03F 13                           inc de            ; next test-addresses
0064+  C040 CB 7D                        bit 7,l           ; 128 adresses (registers) tested ?
0065+  C042 28 F0                        jr z,testreg      ; no -> repeat mirror-test
0066+  C044 78                           ld a,b
0067+  C045 32 00 90                     ld (#9000),a      ; restore value on 9000h
0068+  C048 C1                           pop bc            ; retrieve slotcode (=SCC-slot) from stack
0069+  C049 18 24                        jr done           ; SCC found, restore page 2-slot & return
0070+  C04B             
0071+  C04B 78          nextslot:        ld a,b
0072+  C04C 32 00 90                     ld (#9000),a      ; restore value on 9000h
0073+  C04F C1                           pop bc            ; retrieve slotcode from stack
0074+  C050 CB 78                        bit 7,b           ; test-slot = sec.slot ?
0075+  C052 28 07                        jr z,nextprim
0076+  C054 78                           ld a,b
0077+  C055 C6 04                        add a,4           ; increase sec.slotnumber
0078+  C057 CB 67                        bit 4,a           ; sec.slot = 4 ?
0079+  C059 28 C8                        jr z,testslot
0080+  C05B 78          nextprim:        ld a,b
0081+  C05C E6 03                        and %00000011
0082+  C05E FE 03                        cp 3              ; prim.slot = 3 ?
0083+  C060 28 0B                        jr z,noscc
0084+  C062 3C                           inc a             ; increase prim.slotnumber
0085+  C063 16 00                        ld d,0
0086+  C065 5F                           ld e,a
0087+  C066 21 C1 FC                     ld hl,exptbl
0088+  C069 19                           add hl,de
0089+  C06A B6                           or (hl)           ; combine slot-expansion with slotcode
0090+  C06B 18 B6                        jr testslot
0091+  C06D             
0092+  C06D 06 FF       noscc:           ld b,255          ; code for no SCC
0093+  C06F F1          done:            pop af            ; retrieve page 2-slot from stack
0094+  C070 C5                           push bc
0095+  C071 26 80                        ld h,#80
0096+  C073 CD 24 00                     call enaslt       ; restore original page 2-slot
0097+  C076 C1                           pop bc
0098+  C077 FB                           ei
0099+  C078 C9                           ret
0100+  C079             				 ENDT
0101+  446F             end:
0102+  446F             				 
0103+  446F             ; -------------------------------------------------------------
0104+  446F             
0105+  446F             
0106+  446F             ; ====================
0107+  446F             ;    Initialization
0108+  446F             ; ====================
0109+  446F             SCCINIT
0110+  446F 21 F6 43    				ld	hl,begin
0111+  4472 11 00 C0    				ld	de,0C000H
0112+  4475 01 7A 00    				ld	bc,end-begin+1
0113+  4478 ED B0       				ldir
0114+  447A CD 00 C0    				call	0C000H
0115+  447D 78          				ld	a,b
0116+  447E 32 EE E5    				ld	(SCC),a
0117+  4481 C9          				ret
0118+  4482             
0119+  4482             ; SLOT            .db     0
0120+  4482             ; PAGE1RAM        .db     0
0121+  4482             ; RAMSLOT         .db     0
0122+  4482             
0123+  4482             ; SCC             .db     0
0124+  4482             ; SUB             .db     0FFH
0125+  4482             
0018   4482             INIT:	
0019   4482             
0020   4482 3E 0F               ld a,15
0021   4484 32 E9 F3            ld (forclr),a
0022   4487 21 01 01            ld hl,0101h	 ; COLOR ,1,1
0023   448A 22 EA F3            ld (bakclr),hl
0024   448D             
0025   448D AF                  xor a
0026   448E 32 DB F3            ld (0F3DBh),a ; key clik off
0027   4491 32 DE F3            ld (0F3DEh),a ; KEY OFF
0028   4494             
0029   4494 CD 3A 51            call test_easteregg
0030   4497             
0031   4497 3E 02               ld a,2
0032   4499 CD 5F 00            call 05Fh       ; screen 2
0033   449C CD 41 00            call disscr
0034   449F F3                  di					        ; Disable interrupts
0035   44A0                     
0036   44A0 CD 3C 40            call SETPAGES48K
0037   44A3 CD 3F 00            call intro_START
0038   44A6 CD 56 40            call RESTOREBIOS
0039   44A9             
0040   44A9 3E 02               ld a,2
0041   44AB CD 5F 00            call 05Fh       ; screen 2
0042   44AE CD 44 00            call enascr
0043   44B1             
0044   44B1 3E FD               ld      a,-3
0045   44B3 32 D5 E5            ld      (_psg_vol_fix),a
0046   44B6             		
0047   44B6 CD 6F 44    		call 	SCCINIT
0048   44B9 CD 95 40    		call 	_SCC_PSG_Volume_balance
0049   44BC                     
0050   44BC CD 0C 53            call    CheckIf60Hz
0051   44BF 3D                  dec a
0052   44C0 32 48 E4            ld (vsf),a                ; 0=>60Hz, !0=>50Hz
0053   44C3             
0054   44C3 21 49 E4            ld      hl,cnt
0055   44C6 36 01               ld      (hl),1               ; reset the tic counter
0056   44C8             
0057   44C8 21 EE 52            ld      hl,INTERRUPT
0058   44CB 22 A0 FD            ld      (0xFD9F+1),hl
0059   44CE 3E C3               ld      a,0xC3
0060   44D0 32 9F FD            ld      (0xFD9F),a          ; install INTERRUPT
0061   44D3             
0062   44D3 CD C3 BA            call    ayFX_SETUP
0063   44D6             
0064   44D6 AF                  xor a
0065   44D7 32 4A E4            ld     [PT3_SETUP],a       ; LOOP the song
0066   44DA             
0067   44DA CD BF A0            call    PT3_MUTE
0068   44DD                     
0069   44DD             		
0070   44DD 21 84 BA            ld	hl,MUSIC6			; hl <- initial address of module 
0071   44E0 CD CF A0            call	PT3_INIT			; Inits PT3 player
0072   44E3             
0073   44E3 FB                  ei					       ; Enable interrupts
0074   44E4 76                  halt
0075   44E5             
0076   44E5 C3 7C 53            jp      startAdr
0077   44E8             
0078   44E8             easteregg:
0079   44E8                         incbin   intruder4K_redux\loader.bin,7
0080   513A             ;;;;;;;;;;;;;;;;;;;;;;;;;
0081   513A             ; test for easter eggs
0082   513A             ;
0083   513A             test_easteregg:
0084   513A 1E 07               ld      e,7
0085   513C CD 25 53            call    checkkbd
0086   513F FE FB               cp      255-4           ; key ESC
0087   5141 C0                  ret     nz
0088   5142             
0089   5142 21 E8 44            ld      hl,easteregg
0090   5145 11 00 C0            ld      de,0xc000
0091   5148 01 53 0C            ld      bc,test_easteregg-easteregg+1
0092   514B ED B0               ldir
0093   514D C3 A1 C0            jp      0xc0A1
0094   5150             
0095   5150             
0096   5150             
0097   5150             
0098   5150                     include "setdiff.asm"
0001+  5150             
0002+  5150             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0003+  5150             ;
0004+  5150             ; set difficulty level
0005+  5150             ;
0006+  5150             setdiff:
0007+  5150 3A 9E FC            ld      a,(jiffy)         ; init random seed from jiffy clock
0008+  5153 32 67 E1            ld      (storedseed),a
0009+  5156             
0010+  5156             
0011+  5156             1:
0012+  5156 CD AB 7A             call MAIN._joy
0013+  5159 E6 1F                and    00011111B
0014+  515B FE 1F                cp     00011111B
0015+  515D 20 08                jr     nz,2f
0016+  515F             
0017+  515F 3E 08                ld     a,8
0018+  5161 CD 41 01             call   0x0141
0019+  5164 3C                   inc    a
0020+  5165 20 EF                jr     nz,1b
0021+  5167             
0022+  5167 CD 57 5D    2:       call    MAIN.cls
0023+  516A             
0024+  516A             
0025+  516A             
0026+  516A 06 01               ld      b,1         ; option: 0 = EASY, 1 = NORMAL, 2 = HARD
0027+  516C             
0028+  516C             selection_loop:
0029+  516C                     rept    10
0030+  516C~                        halt
0031+  516C                     endm
0031+  516C 76          >            halt
0031+  516D 76          >            halt
0031+  516E 76          >            halt
0031+  516F 76          >            halt
0031+  5170 76          >            halt
0031+  5171 76          >            halt
0031+  5172 76          >            halt
0031+  5173 76          >            halt
0031+  5174 76          >            halt
0031+  5175 76          >            halt
0032+  5176             
0033+  5176             
0034+  5176 CD 57 52            call    disparrow
0035+  5179             
0036+  5179             1:
0037+  5179 CD AB 7A             call MAIN._joy
0038+  517C E6 1F                and    00011111B
0039+  517E FE 1F                cp     00011111B
0040+  5180 28 08                jr     z,2f
0041+  5182             
0042+  5182 3E 08                ld     a,8
0043+  5184 CD 41 01             call   0x0141
0044+  5187 3C                   inc    a
0045+  5188 20 EF                jr     nz,1b
0046+  518A             2:
0047+  518A             
0048+  518A             ;----- keyboard
0049+  518A             ; 8 RIGHT DOWN UP LEFT DEL INS HOME SPACE
0050+  518A             1:
0051+  518A CD AB 7A             call MAIN._joy
0052+  518D 65                   ld     h,l
0053+  518E E6 1F                and    00011111B
0054+  5190 FE 1F                cp     00011111B
0055+  5192 3E FF                ld     a,255
0056+  5194 20 09                jr     nz,2f
0057+  5196             
0058+  5196 3E 08                ld     a,8
0059+  5198 CD 41 01             call   0x0141
0060+  519B 3C                   inc    a
0061+  519C 28 EC                jr     z,1b
0062+  519E 3D                   dec    a
0063+  519F 6F          2:       ld     l,a                     ; in L the keyboard and in H the joystick
0064+  51A0             
0065+  51A0 E5                   push    hl
0066+  51A1 3E 01                ld      a,1                    ; plyr_hit SFX
0067+  51A3 0E 00                ld      c,0                    ;   Priority
0068+  51A5 CD CE BA             call    ayFX_INIT
0069+  51A8 E1                   pop     hl
0070+  51A9             
0071+  51A9 CB 75                bit    6,l                ; DOWN
0072+  51AB 20 08                jr     nz,1f
0073+  51AD             
0074+  51AD 04                   inc    b
0075+  51AE 3E 04                ld     a,4                ; reached last item
0076+  51B0 B8                   cp     b
0077+  51B1 20 02                jr     nz,1f
0078+  51B3             
0079+  51B3 06 00                ld     b,0
0080+  51B5             
0081+  51B5 CB 6D       1:       bit    5,l                ; UP
0082+  51B7 20 06                jr     nz,1f
0083+  51B9             
0084+  51B9 05                   dec    b
0085+  51BA F2 BF 51             jp     p,1f
0086+  51BD             
0087+  51BD 06 03                ld     b,3                ; reached first item
0088+  51BF             
0089+  51BF CB 45       1:       bit    0,l                ; space
0090+  51C1 28 1D                jr     z,_space_pressed
0091+  51C3             
0092+  51C3             ;;;;;;;
0093+  51C3             
0094+  51C3 CB 4C                bit    1,h                ; DOWN
0095+  51C5 20 08                jr     nz,1f
0096+  51C7             
0097+  51C7 04                   inc    b
0098+  51C8 3E 04                ld     a,4                ; reached last item
0099+  51CA B8                   cp     b
0100+  51CB 20 02                jr     nz,1f
0101+  51CD             
0102+  51CD 06 00                ld     b,0
0103+  51CF             
0104+  51CF CB 44       1:       bit    0,h                ; UP
0105+  51D1 20 06                jr     nz,1f
0106+  51D3             
0107+  51D3 05                   dec    b
0108+  51D4 F2 D9 51             jp     p,1f
0109+  51D7             
0110+  51D7 06 03                ld     b,3                ; reached first item
0111+  51D9             
0112+  51D9 CB 64       1:       bit    4,h                ; space
0113+  51DB 28 03                jr     z,_space_pressed
0114+  51DD             
0115+  51DD             
0116+  51DD C3 6C 51             jp selection_loop
0117+  51E0             
0118+  51E0             _space_pressed:
0119+  51E0             
0120+  51E0             1:
0121+  51E0 CD AB 7A             call MAIN._joy
0122+  51E3 E6 10                and    00010000B
0123+  51E5 20 08                jr     nz,1f
0124+  51E7             
0125+  51E7 3E 08                ld     a,8
0126+  51E9 CD 41 01             call   0x0141
0127+  51EC 3C                   inc    a
0128+  51ED 20 F1                jr     nz,1b
0129+  51EF             1:
0130+  51EF             
0131+  51EF 3E 03                ld     a,3
0132+  51F1 B8                   cp     b
0133+  51F2 28 22                jr     z,manageseed
0134+  51F4             
0135+  51F4 04                  inc     b
0136+  51F5             
0137+  51F5 21 21 52            ld      hl,EASY
0138+  51F8 05                  dec     b
0139+  51F9 28 0F               jr      z,setparam
0140+  51FB             
0141+  51FB 21 33 52            ld      hl,NORMAL
0142+  51FE 05                  dec     b
0143+  51FF 28 09               jr      z,setparam
0144+  5201             
0145+  5201 21 45 52            ld      hl,HARD
0146+  5204 05                  dec     b
0147+  5205 28 03               jr      z,setparam
0148+  5207             _default:
0149+  5207 21 33 52            ld      hl,DEFAULT
0150+  520A             setparam:
0151+  520A             
0152+  520A 11 25 C0            ld      de,diffparameters+PAGE0
0153+  520D 01 12 00            ld      bc,18
0154+  5210 ED B0               ldir
0155+  5212             
0156+  5212 CD 57 5D            call    MAIN.cls
0157+  5215                     
0158+  5215 C9                  ret
0159+  5216             ;;;;;;;;;;;;;;;;;;;;;;;;;
0160+  5216             
0161+  5216             manageseed:
0162+  5216 CD 45 53               call    inputhex         ; init from the keyboard
0163+  5219 32 67 E1               ld      (storedseed),a
0164+  521C 06 03                  ld      b,3
0165+  521E C3 6C 51               jp      selection_loop
0166+  5221             
0167+  5221             ;;;;;;;;;;;;;;;;;;;;;;;;;
0168+  5221             
0169+  5221             
0170+  5221             EASY:   db 0x20,0x15,1,2,3,1,2,3,4,2,2,3,4,2, 5,64,128,180
0170+  5221 2015010203010203040202030402054080B4
0171+  5233             DEFAULT:
0172+  5233             NORMAL: db 0x30,0x20,1,2,3,1,1,2,3,1,1,2,3,1, 4,64,150,170
0172+  5233 3020010203010102030101020301044096AA
0173+  5245             HARD:   db 0x35,0x20,1,2,3,1,1,2,3,1,1,2,3,1, 3,96,145,165
0173+  5245 3520010203010102030101020301036091A5
0174+  5257             
0175+  5257             
0176+  5257             ;
0177+  5257             ; _lastlevel = 0x30    ; last dungeon level (bcd)
0178+  5257             ; _dragonlevel = 0x20  ; dungeon level (bcd) where dragons are
0179+  5257             ; ; 
0180+  5257             ; _heal0 = 0x02 ; healing effect of a potion (bcd)
0181+  5257             ; _heal1 = 0x03 ; healing effect of a potion (bcd)
0182+  5257             ; _heal2 = 0x04 ; healing effect of a potion (bcd)
0183+  5257             ; _heal3 = 0x05 ; healing effect of a potion (bcd)
0184+  5257             ; ; 
0185+  5257             ; _weap0 = 0x02 ; attack bonus
0186+  5257             ; _weap1 = 0x03 ; attack bonus
0187+  5257             ; _weap2 = 0x04 ; attack bonus
0188+  5257             ; _weap3 = 0x05 ; attack bonus
0189+  5257             ; ; 
0190+  5257             ; _shld0 = 0x02 ; shield bonus
0191+  5257             ; _shld1 = 0x03 ; shield bonus
0192+  5257             ; _shld2 = 0x04 ; shield bonus
0193+  5257             ; _shld3 = 0x05 ; shield bonus
0194+  5257             ; ; 
0195+  5257             ; _chests = 0x04 ; number of chests
0196+  5257             ; ;
0197+  5257             ; _batgobac = 0xc0 ; higher value = harder to kill
0198+  5257             ; _dragonac = 0xf0
0199+  5257             ; _ghostac =  0xf7
0200+  5257             
0201+  5257             ;;;;;;;;;;;;;;;;;;;;;;;;;
0202+  5257             
0203+  5257             
0204+  5257             
0205+  5257             disparrow:
0206+  5257 C5                  push    bc
0207+  5258 11 95 52            ld      de,menutext
0208+  525B 21 EA 18            ld      hl,0x1800+7*32+10
0209+  525E 06 06               ld      b,6
0210+  5260 3E 0C               ld      a,12
0211+  5262 CD 69 73            call    MAIN._printtext
0212+  5265 C1                  pop     bc
0213+  5266             
0214+  5266 C5                  push    bc
0215+  5267 04                  inc     b
0216+  5268             
0217+  5268 21 6A 19            ld      hl,0x1800+11*32+10            ; B == 1?
0218+  526B 11 75 19            ld      de,0x1800+11*32+21
0219+  526E             
0220+  526E 05                  dec     b
0221+  526F 28 18               jr      z,1f
0222+  5271             
0223+  5271 21 AA 19            ld      hl,0x1800+13*32+10            ; B == 2?
0224+  5274 11 B5 19            ld      de,0x1800+13*32+21
0225+  5277             
0226+  5277 05                  dec     b
0227+  5278 28 0F               jr      z,1f
0228+  527A             
0229+  527A 21 EA 19            ld      hl,0x1800+15*32+10            ; B == 3?
0230+  527D 11 F5 19            ld      de,0x1800+15*32+21
0231+  5280             
0232+  5280 05                  dec     b
0233+  5281 28 06               jr      z,1f
0234+  5283             
0235+  5283 21 2A 1A            ld      hl,0x1800+17*32+10            ; B == 4?
0236+  5286 11 35 1A            ld      de,0x1800+17*32+21
0237+  5289             
0238+  5289             1:
0239+  5289 3E DA               ld      a,218
0240+  528B CD 4D 00            call    wrtvrm
0241+  528E             
0242+  528E 3C                  inc     a
0243+  528F EB                  ex      de,hl
0244+  5290 CD 4D 00            call    wrtvrm
0245+  5293             
0246+  5293 C1                  pop     bc
0247+  5294 C9                  ret
0248+  5295             
0249+  5295             
0250+  5295             menutext:
0251+  5295                 db  'S'+127,'E'+127,'L'+127,'E'+127,'C'+127,'T'+127,255    ,'L'+127,'E'+127,'V'+127,'E'+127,'L'+127
0251+  5295 D2C4CBC4C2D3FFCBC4D5C4CB
0252+  52A1                 db  255    ,255    ,255    ,255    ,255    ,255    ,255    ,255    ,255    ,255    ,255    ,255
0252+  52A1 FFFFFFFFFFFFFFFFFFFFFFFF
0253+  52AD                 db  255    ,255    ,255    ,255    ,'E'+127,'A'+127,'S'+127,'Y'+127,255    ,255    ,255    ,255
0253+  52AD FFFFFFFFC4C0D2D8FFFFFFFF
0254+  52B9                 db  255    ,255    ,255    ,'N'+127,'O'+127,'R'+127,'M'+127,'A'+127,'L'+127,255    ,255    ,255
0254+  52B9 FFFFFFCDCED1CCC0CBFFFFFF
0255+  52C5                 db  255    ,255    ,255    ,255    ,'H'+127,'A'+127,'R'+127,'D'+127,255    ,255    ,255    ,255
0255+  52C5 FFFFFFFFC7C0D1C3FFFFFFFF
0256+  52D1             
0257+  52D1                 db  255    ,'S'+127,'E'+127,'E'+127,'D'+127,255    ,'I'+127,'N'+127,'P'+127,'U'+127,'T'+127,255
0257+  52D1 FFD2C4C4C3FFC8CDCFD4D3FF
0099   52DD             
0100   52DD             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0101   52DD             seq:
0102   52DD 2A 4D E4            ld  hl,(PT3_CrPsPtr)
0103   52E0 ED 5B 4B E4         ld  de,(PT3_MODADDR)
0104   52E4 A7                  and a
0105   52E5 ED 52               sbc hl,de
0106   52E7 11 C9 00            ld  de,101+100
0107   52EA A7                  and a
0108   52EB ED 52               sbc hl,de
0109   52ED C9                  ret
0110   52EE             
0111   52EE             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0112   52EE             
0113   52EE             INTERRUPT:
0114   52EE             
0115   52EE 3A 48 E4              ld      a,(vsf)
0116   52F1 A7                    and     a
0117   52F2 C2 FF 52              jp      nz,PAL               ; if PAL call at any interrupt
0118   52F5             
0119   52F5             NTSC:
0120   52F5 21 49 E4              ld      hl,cnt               ; if NTSC call 5 times out of 6
0121   52F8 35                    dec     (hl)
0122   52F9 C2 FF 52              jp      nz,PAL               ; skip one tic out of 6 when at 60hz
0123   52FC             
0124   52FC 36 06                 ld      (hl),6               ; reset the tic counter
0125   52FE C9                    ret                          ; interrupt exit
0126   52FF             
0127   52FF             PAL:                             ; execute the PSG and ayFX core
0128   52FF             
0129   52FF             
0130   52FF                     ; --- Place this instruction on interrupt or after HALT instruction to synchronize music ---
0131   52FF CD F7 40            call	PT3_ROUT			; Write values on PSG registers
0132   5302 CD 87 43        call    probewavechanges
0133   5305 CD 18 43        call    SCCROUT
0134   5308             
0135   5308 CD BA 40    	call Audio_Internal_code
0136   530B             		
0137   530B             	    ; --- To speed up VDP writes you can place this instruction after all of them, but before next INT ---
0138   530B                     ;call	PT3_PLAY			; Calculates PSG values for next frame
0139   530B             
0140   530B             		
0141   530B             		; --- You can place here your favourite FX system and write the values to AYREGS label ---
0142   530B                     ;call	ayFX_FRAME			; Calculates PSG values for next frame
0143   530B             
0144   530B             		; --- so on next frame the FX will be played automatically when calling PT3_ROUT       ---
0145   530B             
0146   530B C9                  ret
0147   530C             
0148   530C             
0149   530C             ;;;;;;;;;;;;;;;;;;;;;
0150   530C             ;; Keyboard testing
0151   530C             ;; ayFX
0152   530C             ;
0153   530C             ;        ld	a,(ayFX_PRIORITY)
0154   530C             ;        cp      255
0155   530C             ;        ret     nz              ; play only if no sfx is active
0156   530C             ;
0157   530C             ;; // 0 "7" "6" "5" "4" "3" "2" "1" "0"
0158   530C             ;
0159   530C             ;        ld      e,0
0160   530C             ;        call    checkkbd
0161   530C             ;
0162   530C             ;        ld      b,8
0163   530C             ;        ld      c,a
0164   530C             ;1:
0165   530C             ;        ld      a,b
0166   530C             ;        dec     a
0167   530C             ;        ld      l,a
0168   530C             ;
0169   530C             ;        ld      a,c
0170   530C             ;        add     a,a
0171   530C             ;        ld      c,a
0172   530C             ;
0173   530C             ;        push    bc
0174   530C             ;        ld      a,l
0175   530C             ;        ld      c,0            ;   Priority
0176   530C             ;
0177   530C             ;        call    nc,ayFX_INIT
0178   530C             ;        pop     bc
0179   530C             ;        djnz    1B
0180   530C             ;        ret
0181   530C             
0182   530C             
0183   530C             
0184   530C             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0185   530C             ;;
0186   530C             ;; returns 1 in a and clears z flag if vdp is 60Hz
0187   530C             ;;
0188   530C             CheckIf60Hz:
0189   530C DB 99               in      a,(0x99)
0190   530E 00                  nop
0191   530F 00                  nop
0192   5310 00                  nop
0193   5311             vdpSync:
0194   5311 DB 99                in      a,(0x99)
0195   5313 E6 80                and     0x80
0196   5315 28 FA                jr      z,vdpSync
0197   5317                 
0198   5317 21 00 09             ld      hl,0x900
0199   531A             vdpLoop:
0200   531A 2B                   dec     hl
0201   531B 7C                   ld      a,h
0202   531C B5                   or      l
0203   531D 20 FB                jr      nz,vdpLoop
0204   531F                 
0205   531F DB 99                in      a,(0x99)
0206   5321 07                   rlca
0207   5322 E6 01                and     1
0208   5324 C9                   ret
0209   5325             
0210   5325             ;-------------------------------------
0211   5325             ; checkkbd: ckeck keyboard line
0212   5325             ; syntax:checkkbd <keyboar line #>
0213   5325             ; in:  e
0214   5325             ; out: l
0215   5325             ;-------------------------------------
0216   5325             
0217   5325             i8255portb  equ 0a9h        ; keyboard column input
0218   5325             i8255portc  equ 0aah        ; leds, motor, cassette, kbd line
0219   5325             
0220   5325             checkkbd:
0221   5325 DB AA               in  a,(i8255portc)
0222   5327 E6 F0               and 011110000B          ; upper 4 bits contain info to preserve
0223   5329 B3                  or  e
0224   532A D3 AA               out (i8255portc),a
0225   532C DB A9               in  a,(i8255portb)
0226   532E 6F                  ld  l,a
0227   532F C9                  ret
0228   5330             
0229   5330             
0230   5330             		; --- INCLUDE ACTUAL GAME code ---
0231   5330             
0232   5330                     INCLUDE	"WHACK_Z80.ASM"
0001+  5330             
0002+  5330             ;****************************************************************************
0003+  5330             ;*****
0004+  5330             ;***** Thanks to:
0005+  5330             ;*****
0006+  5330             ;***** Aleksi Eeben (http://www.cncd.fi/aeeben)
0007+  5330             ;***** for his 1K WHACK (c)2003 
0008+  5330             ;***** Rogue-like Dungeon Exploring Game for Unexpanded VIC 20
0009+  5330             ;*****
0010+  5330             ;*****
0011+  5330             ;****************************************************************************
0012+  5330             
0013+  5330             
0014+  5330             ;----- zeropage variables
0015+  5330             
0016+  5330             addx = 0x00 ; any xy-movement
0017+  5330             addy = 0x01
0018+  5330             
0019+  5330             stairupx = 0x02
0020+  5330             stairupy = 0x03
0021+  5330             
0022+  5330             stairdownx = 0x04
0023+  5330             stairdowny = 0x05
0024+  5330             
0025+  5330             manx = 0x06
0026+  5330             many = 0x07
0027+  5330             
0028+  5330             verd = 0x08 ; vertical door check
0029+  5330             hord = 0x09 ; horizontal door check
0030+  5330             
0031+  5330             underman = 0x0a
0032+  5330             
0033+  5330             gamevar = 0x0b
0034+  5330             
0035+  5330             HITPOINTS = 0x0b ; game variables
0036+  5330             
0037+  5330             
0038+  5330             DEF = 0x0c
0039+  5330             ATT = 0x0d
0040+  5330             
0041+  5330             mandir = 0x0e
0042+  5330             
0043+  5330             GOLD = 0x11
0044+  5330             GOLD100 = 0x12
0045+  5330             LEVEL = 0x13
0046+  5330             AMULET = 0x14
0047+  5330             
0048+  5330             
0049+  5330             flip = 0x16
0050+  5330             monx = 0x17
0051+  5330             mony = 0x18
0052+  5330             monster = 0x19
0053+  5330             
0054+  5330             scr = 0x1b ; screen line pointer (2bytes)
0055+  5330             color = 0x1d ; color memory pointer (2bytes)
0056+  5330             
0057+  5330             
0058+  5330             seed1 = 0x1f ; pseudo-random number generator
0059+  5330             seed2 = 0x20
0060+  5330             prevr = 0x21
0061+  5330             
0062+  5330             endgamevar = 0x21
0063+  5330             
0064+  5330             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0065+  5330             
0066+  5330             diffparameters = 0x22
0067+  5330             
0068+  5330             _lastlevel = 0x22    ; last dungeon level (bcd)
0069+  5330             _dragonlevel = 0x23  ; dungeon level (bcd) where dragons are
0070+  5330             ;
0071+  5330             _heal0 = 0x24 ; healing effect of a potion (bcd)
0072+  5330             _heal1 = 0x25 ; healing effect of a potion (bcd)
0073+  5330             _heal2 = 0x26 ; healing effect of a potion (bcd)
0074+  5330             _heal3 = 0x27 ; healing effect of a potion (bcd)
0075+  5330             ;
0076+  5330             _weap0 = 0x28 ; attack bonus
0077+  5330             _weap1 = 0x29 ; attack bonus
0078+  5330             _weap2 = 0x2a ; attack bonus
0079+  5330             _weap3 = 0x2b ; attack bonus
0080+  5330             ;
0081+  5330             _shld0 = 0x2c ; shield bonus
0082+  5330             _shld1 = 0x2d ; shield bonus
0083+  5330             _shld2 = 0x2e ; shield bonus
0084+  5330             _shld3 = 0x2f ; shield bonus
0085+  5330             ;
0086+  5330             _chests = 0x30 ; number of chests
0087+  5330             ;
0088+  5330             _batgobac = 0x31 ; higher value = harder to kill
0089+  5330             _dragonac = 0x32
0090+  5330             _ghostac =  0x33
0091+  5330             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0092+  5330             
0093+  5330             ;----- game constants
0094+  5330             
0095+  5330             MAXGOLD = 0x17 ; max gold in one pile (and-mask)
0096+  5330             ; LASTLEVEL = 0x30    ; last dungeon level (BCD)
0097+  5330             ; DRAGONLEVEL = 0x20  ; dungeon level (BCD) where dragons are
0098+  5330             ;
0099+  5330             ; HEAL0 = 0x02 ; healing effect of a potion (BCD)
0100+  5330             ; HEAL1 = 0x03 ; healing effect of a potion (BCD)
0101+  5330             ; HEAL2 = 0x04 ; healing effect of a potion (BCD)
0102+  5330             ; HEAL3 = 0x05 ; healing effect of a potion (BCD)
0103+  5330             ;
0104+  5330             ; WEAP0 = 0x02 ; attack bonus
0105+  5330             ; WEAP1 = 0x03 ; attack bonus
0106+  5330             ; WEAP2 = 0x04 ; attack bonus
0107+  5330             ; WEAP3 = 0x05 ; attack bonus
0108+  5330             ;
0109+  5330             ; SHLD0 = 0x02 ; shield bonus
0110+  5330             ; SHLD1 = 0x03 ; shield bonus
0111+  5330             ; SHLD2 = 0x04 ; shield bonus
0112+  5330             ; SHLD3 = 0x05 ; shield bonus
0113+  5330             
0114+  5330             ; CHESTS = 0x04 ; number of chests
0115+  5330             
0116+  5330             ; BATGOBAC = 0xc0 ; higher value = harder to kill
0117+  5330             ; DRAGONAC = 0xf0
0118+  5330             ; GHOSTAC =  0xf7
0119+  5330             
0120+  5330             CAVERUN = 0x07 ; max. cave run length (and-mask)
0121+  5330             
0122+  5330             DOORS = 0x20 ; number of doors to try
0123+  5330             ; CAVES = 0x40 ; number of caves = 2x doors
0124+  5330             ROOMS = 0x05 ; number of rooms
0125+  5330             
0126+  5330             
0127+  5330             MAPW = 24 ; number of columns in the level
0128+  5330             MAPH = 24 ; number of lines in the level
0129+  5330             
0130+  5330             floorchr    = 32
0131+  5330             wallchr     = 3
0132+  5330             doorchr     = 36
0133+  5330             amuletchr   = 43
0134+  5330             upchr       = 34
0135+  5330             downchr     = 35
0136+  5330             batchr      = 96
0137+  5330             goblinchr   = 98
0138+  5330             dragonchr   = 106
0139+  5330             ghostchr    = 114
0140+  5330             
0141+  5330             chestchr    = 38 ; chest
0142+  5330             goldchr     = 40 ; gold
0143+  5330             
0144+  5330             potion0chr   = 39 ; potion
0145+  5330             potion1chr   = 45 ; potion
0146+  5330             potion2chr   = 46 ; potion
0147+  5330             potion3chr   = 39 ; potion
0148+  5330             
0149+  5330             sword0chr   = 41 ; small sword
0150+  5330             sword1chr   = 49 ; middle sword
0151+  5330             sword2chr   = 48 ; large sword
0152+  5330             sword3chr   = 41 ; small sword
0153+  5330             
0154+  5330             shield0chr  = 42 ; small shield
0155+  5330             shield1chr  = 50 ; middle shield
0156+  5330             shield2chr  = 51 ; large shield
0157+  5330             shield3chr  = 42 ; small shield
0158+  5330             
0159+  5330             manchr      = '@' ; man
0160+  5330             
0161+  5330             gravechr    = 72 ;
0162+  5330             
0163+  5330             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0164+  5330             ; msx bios
0165+  5330             disscr: equ $0041
0166+  5330             enascr: equ $0044
0167+  5330             
0168+  5330             wrtvdp: equ $0047
0169+  5330             rdvrm:  equ $004a
0170+  5330             wrtvrm: equ $004d
0171+  5330             
0172+  5330             setrd:  equ $0050
0173+  5330             
0174+  5330             setwrt: equ $0053
0175+  5330             filvrm: equ $0056
0176+  5330             ldirmv: equ $0059
0177+  5330             ldirvm: equ $005c
0178+  5330             chgmod: equ $005F
0179+  5330             clrspr: equ $0069
0180+  5330             initxt: equ $006c
0181+  5330             init32: equ $006f
0182+  5330             
0183+  5330             forclr: equ $f3e9
0184+  5330             bakclr: equ $f3ea
0185+  5330             bdrclr: equ $f3eb
0186+  5330             
0187+  5330             jiffy:  equ $fc9e
0188+  5330             
0189+  5330                     
0190+  5330             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0191+  5330             ; input seed while entering the dungeon
0192+  5330             ;
0193+  5330             onedigit:
0194+  5330 CD 9F 00    1:      call     0x009F        
0195+  5333 FE 30               cp      '0'          ; <'0'
0196+  5335 38 F9               jr      c,1b
0197+  5337 FE 3A               cp      '9'+1        ; >'9'
0198+  5339 30 F5               jr      nc,1b
0199+  533B C6 E3               add     a,19-'0'
0200+  533D D3 98               out     (0x98),a
0201+  533F D6 13               sub     a,19
0202+  5341 C9                  ret
0203+  5342             
0204+  5342             seedtext:
0205+  5342 58 58 58            db  "XXX"
0206+  5345             seedtextend:        
0207+  5345             inputhex:
0208+  5345 21 6E 1A            ld      hl,0x1a6E   ; 0x1800
0209+  5348 CD 53 00            call    setwrt
0210+  534B 21 42 53            ld      hl,seedtext
0211+  534E 01 98 03            ld      bc,0x98 + (seedtextend-seedtext)*256
0212+  5351 7E          1:      ld      a,(hl)
0213+  5352 C6 7F               add     a,127
0214+  5354 D3 98               out     (0x98),a
0215+  5356 23                  inc     hl
0216+  5357 10 F8               djnz    1b
0217+  5359 21 6E 1A            ld      hl,0x1a6E+(seedtextend-seedtext)-3
0218+  535C CD 53 00            call    setwrt
0219+  535F             
0220+  535F CD 30 53            call onedigit
0221+  5362 CD 76 53            call    ax10
0222+  5365 CD 76 53            call    ax10
0223+  5368 6F                  ld      l,a
0224+  5369                     
0225+  5369 CD 30 53            call onedigit        
0226+  536C CD 76 53            call    ax10
0227+  536F 85                  add     a,l
0228+  5370 6F                  ld      l,a
0229+  5371                             
0230+  5371 CD 30 53            call onedigit        
0231+  5374 85                  add     a,l
0232+  5375 C9                  ret
0233+  5376             
0234+  5376             ax10:
0235+  5376 87                  add     a,a
0236+  5377 5F                  ld      e,a        
0237+  5378 87                  add     a,a
0238+  5379 87                  add     a,a
0239+  537A 83                  add     a,e                                
0240+  537B C9                  ret
0241+  537C             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0242+  537C             ;
0243+  537C             ;   program code
0244+  537C             ;
0245+  537C             
0246+  537C             startAdr
0247+  537C             
0248+  537C                     module MAIN
0249+  537C             
0250+  537C             
0251+  537C             
0252+  537C             ;----- entry, initialization
0253+  537C             
0254+  537C             entry:
0255+  537C 21 4D A6            ld	hl,MUSIC0			; hl <- initial address of module 
0256+  537F CD CF A0            call	PT3_INIT			; Inits PT3 player
0257+  5382             
0258+  5382 CD 06 6A            call   openscreen
0259+  5385             
0260+  5385 CD 96 5C            call    init_video
0261+  5388             
0262+  5388 21 64 AA            ld	hl,MUSIC1			; hl <- initial address of module 
0263+  538B CD CF A0            call	PT3_INIT			; Inits PT3 player
0264+  538E             
0265+  538E DD 21 03 C0         ld ix,PAGE0
0266+  5392             
0267+  5392 21 68 E1            ld hl,levels
0268+  5395 AF                  xor a
0269+  5396 06 00               ld b,0
0270+  5398             _clrlp
0271+  5398 77                  ld (hl),a ; set all levels to non-visited
0272+  5399 23                  inc hl
0273+  539A 10 FC               djnz _clrlp
0274+  539C             
0275+  539C             
0276+  539C 06 16               ld b,endgamevar-gamevar
0277+  539E 21 0F C0            ld hl,PAGE0+gamevar+1
0278+  53A1 AF                  xor a
0279+  53A2             _inilp
0280+  53A2 77                  ld (hl),a ; init game variables
0281+  53A3 23                  inc hl
0282+  53A4 10 FC               djnz _inilp
0283+  53A6             
0284+  53A6 DD 36 0B 25         ld (ix+HITPOINTS),0x25
0285+  53AA             ;        ld (ix+DEF),0x00
0286+  53AA             ;        ld (ix+ATT),0x00
0287+  53AA             
0288+  53AA             ; reset the number of rounds
0289+  53AA             
0290+  53AA 21 00 00            ld  hl,0
0291+  53AD 22 00 C0            ld  (nround),hl     
0292+  53B0 22 01 C0            ld  (nround+1),hl             
0293+  53B3             
0294+  53B3 CD 09 7A            call    initchest   ; all chests of all levels are closed
0295+  53B6             
0296+  53B6             ; initialize level seeds
0297+  53B6             
0298+  53B6 3A 67 E1            ld      a,(storedseed)         ; init random seed from jiffy clock or from custom entry
0299+  53B9 32 22 C0            ld      (PAGE0+seed1),a
0300+  53BC             
0301+  53BC 21 68 E2            ld      hl,seeds
0302+  53BF 06 28               ld      b,MAXLASTLEVEL
0303+  53C1 CD 34 57    1:      call    random
0304+  53C4 28 FB               jr      z,1b
0305+  53C6 77                  ld      (hl),a
0306+  53C7 23                  inc     hl
0307+  53C8 10 F7               djnz    1b
0308+  53CA             
0309+  53CA             
0310+  53CA             ; generate first level
0311+  53CA                     
0312+  53CA CD D4 58            call _stairdown     
0313+  53CD             
0314+  53CD             
0315+  53CD             ;----- main game loop
0316+  53CD             ;
0317+  53CD             MAINLOOP:
0318+  53CD             
0319+  53CD             ;- draw man
0320+  53CD             
0321+  53CD CD DC 57             call locateman
0322+  53D0             
0323+  53D0             ; l = man x-coordinate
0324+  53D0             ; h = man y-coordinate
0325+  53D0             
0326+  53D0 3E 18                ld a,24       ; posizione del manchr
0327+  53D2 CD 40 5A             call drawchar
0328+  53D5             
0329+  53D5             
0330+  53D5             ;- move monsters
0331+  53D5              
0332+  53D5 DD 34 16             inc (ix+flip) ; chessboard check
0333+  53D8 DD 7E 16             ld a,(ix+flip)
0334+  53DB E6 01                and 0x01
0335+  53DD             
0336+  53DD 26 17                ld h,MAPH-1 ; level lines
0337+  53DF              
0338+  53DF             _monylp
0339+  53DF 6F                   ld l,a
0340+  53E0             _monxlp
0341+  53E0 CD E2 57             call locate
0342+  53E3             
0343+  53E3 DD 74 18             ld (ix+mony),h
0344+  53E6 DD 75 17             ld (ix+monx),l
0345+  53E9             
0346+  53E9 DD 77 19             ld (ix+monster),a
0347+  53EC             
0348+  53EC FE 6A                cp dragonchr
0349+  53EE CA 06 54             jp z,_mon
0350+  53F1 FE 62                cp goblinchr
0351+  53F3 CA 06 54             jp z,_mon
0352+  53F6 FE 72                cp ghostchr
0353+  53F8 CA 06 54             jp z,_mon
0354+  53FB FE 60                cp batchr
0355+  53FD C2 C4 54             jp nz,_nomon
0356+  5400             
0357+  5400 CD 1A 57             call randomdir ; bats move in random
0358+  5403 C3 34 54             jp _movemon ; always branch
0359+  5406             
0360+  5406             _mon
0361+  5406             
0362+  5406             ;----- direction table (0 = down; 1 = right; 2 = up; 3 = left, 4 = no move)
0363+  5406             
0364+  5406 DD 7E 1F             ld a,(ix+seed1)
0365+  5409 A7                   and a
0366+  540A FA 21 54             jp m,_monv
0367+  540D             _monh
0368+  540D 7D                   ld a,l
0369+  540E DD BE 06             cp (ix+manx)
0370+  5411 CA 21 54             jp z,_monv
0371+  5414 DA 1C 54             jp c,_monn3
0372+  5417 3E 03                ld a,0x03
0373+  5419 C3 31 54             jp _monok
0374+  541C                      ;
0375+  541C             _monn3
0376+  541C 3E 01                ld a,0x01
0377+  541E C3 31 54             jp _monok
0378+  5421             _monv
0379+  5421 7C                   ld a,h
0380+  5422 DD BE 07             cp (ix+many)
0381+  5425 CA 0D 54             jp z,_monh
0382+  5428 DA 30 54             jp c,_monn2
0383+  542B 3E 02                ld a,0x02
0384+  542D C3 31 54             jp _monok
0385+  5430                       ;
0386+  5430             _monn2
0387+  5430 AF                   xor a
0388+  5431             _monok
0389+  5431             
0390+  5431 CD 1F 57             call setdir
0391+  5434              
0392+  5434             _movemon
0393+  5434 3E 20                ld a,floorchr ; wipe monster character
0394+  5436 CD 52 5A             call drawshaded
0395+  5439             
0396+  5439 CD 57 57             call movedir
0397+  543C FE 40                cp manchr
0398+  543E C2 AA 54             jp nz,_noattack ; check monster attack (man = char @)
0399+  5441                      
0400+  5441 CD 34 57             call   random
0401+  5444 DD BE 0C             cp     (ix+DEF)
0402+  5447 FA AF 54             jp     m,_monblocked   ; man resists the attack
0403+  544A             
0404+  544A F5                   push    af
0405+  544B 3E 0A                ld      a,10                       ; plyr_hit SFX
0406+  544D 0E 00                ld      c,0                        ;   Priority
0407+  544F CD CE BA             call    ayFX_INIT
0408+  5452 F1                   pop     af
0409+  5453             
0410+  5453             
0411+  5453 DD 7E 0B             ld a,(ix+HITPOINTS)                ; man hit looses hp
0412+  5456 3D                   dec a
0413+  5457 27                   daa
0414+  5458 DD 77 0B             ld (ix+HITPOINTS),a
0415+  545B C2 AF 54             jp nz,_monblocked
0416+  545E             
0417+  545E             	   ; you die
0418+  545E             
0419+  545E DD E5                push    ix
0420+  5460 E5                   push    hl
0421+  5461 21 E8 B4             ld	hl,MUSIC4			       ; hl <- initial address of module 
0422+  5464 CD CF A0            call	PT3_INIT			; Inits PT3 player
0423+  5467 E1                   pop     hl
0424+  5468 DD E1                pop     ix
0425+  546A             
0426+  546A DD 66 18             ld h,(ix+mony)
0427+  546D DD 6E 17             ld l,(ix+monx)
0428+  5470 CD E2 57             call locate
0429+  5473             
0430+  5473 DD 7E 19             ld a,(ix+monster)
0431+  5476 CD 52 5A             call drawshaded
0432+  5479             
0433+  5479 06 0C                ld      b,12
0434+  547B             
0435+  547B C5          2:       push   bc
0436+  547C             
0437+  547C CD D1 7A             call fastmanview
0438+  547F                      
0439+  547F CD DC 57             call   locateman
0440+  5482             
0441+  5482 21 00 04             ld     hl,visible-hidden             ; move from scr to visible area
0442+  5485 19                   add    hl,de
0443+  5486             
0444+  5486 C1                   pop    bc
0445+  5487 C5                   push   bc         
0446+  5488 3E 4C                ld     a,manchr+12                   ; death animation
0447+  548A 90                   sub    b
0448+  548B 77                   ld     (hl),a
0449+  548C             
0450+  548C CD A0 76             call   render
0451+  548F                      
0452+  548F 06 14                ld      b,20
0453+  5491 76          1:       halt
0454+  5492 10 FD                djnz     1b
0455+  5494             
0456+  5494 C1                   pop    bc
0457+  5495 10 E4                djnz  2b
0458+  5497             
0459+  5497             
0460+  5497             newgame:
0461+  5497             1:
0462+  5497 CD AB 7A             call _joy
0463+  549A E6 10                and    00010000B
0464+  549C 28 09                jr     z,2f
0465+  549E             
0466+  549E 76                   halt
0467+  549F 3E 08                ld a,8
0468+  54A1 CD 41 01             call 0x0141 ; getin for newgame
0469+  54A4 3C                   inc a
0470+  54A5 28 F0                jr z,1b
0471+  54A7             2:
0472+  54A7 C3 7C 53             jp entry
0473+  54AA             
0474+  54AA             _noattack
0475+  54AA FE 20                cp floorchr ; only walk on floor
0476+  54AC CA B8 54             jp z,_monmoved
0477+  54AF             
0478+  54AF             _monblocked ; blocked, restore coordinates
0479+  54AF DD 66 18             ld h,(ix+mony)
0480+  54B2 DD 6E 17             ld l,(ix+monx)
0481+  54B5 CD E2 57             call locate
0482+  54B8             _monmoved
0483+  54B8 DD 7E 19             ld a,(ix+monster)
0484+  54BB CD 52 5A             call drawshaded
0485+  54BE             
0486+  54BE DD 66 18             ld h,(ix+mony)
0487+  54C1 DD 6E 17             ld l,(ix+monx)
0488+  54C4             _nomon
0489+  54C4 2C                   inc l
0490+  54C5 2C                   inc l
0491+  54C6 3E 17                ld a,MAPW-1
0492+  54C8 BD                   cp l
0493+  54C9 D2 E0 53             jp nc,_monxlp
0494+  54CC             
0495+  54CC 2C                   inc l ; next line of chessboard
0496+  54CD 7D                   ld a,l
0497+  54CE E6 01                and 0x01
0498+  54D0             
0499+  54D0 25                   dec h
0500+  54D1 C2 DF 53             jp nz,_monylp
0501+  54D4             
0502+  54D4             
0503+  54D4             ;- draw man view
0504+  54D4             
0505+  54D4 CD D1 7A             call fastmanview
0506+  54D7             
0507+  54D7             ;----- render screen
0508+  54D7             
0509+  54D7 CD A0 76            call render
0510+  54DA             
0511+  54DA             ;----- end rendering
0512+  54DA             
0513+  54DA             ;- spawn monsters
0514+  54DA             
0515+  54DA CD 34 57             call random                    ; try to create a monster
0516+  54DD FA 11 55             jp m,_nospawn                  ; not every frame (50% prob)
0517+  54E0             
0518+  54E0 E6 01                and 0x01                       ; random monster type ( 6 = bat, 7 = goblin )
0519+  54E2 F6 06                or 0x06
0520+  54E4 6F                   ld l,a
0521+  54E5             
0522+  54E5 DD 7E 14             ld a,(ix+AMULET)               ; dragons if carrying amulet
0523+  54E8 A7                   and a
0524+  54E9 C2 F9 54             jp nz,_dragons
0525+  54EC             
0526+  54EC DD 7E 13             ld a,(ix+LEVEL)                ; no dragons if above DRAGONLEVEL
0527+  54EF DD BE 23             cp (ix+_dragonlevel)           ; and not carrying amulet
0528+  54F2 DA FB 54             jp c,_nodragons
0529+  54F5 2C                   inc l                          ; change bat in goblin and goblin in dragon
0530+  54F6 C3 FB 54             jp  _nodragons
0531+  54F9             _dragons
0532+  54F9 2C                   inc l                          ; change bat in dragons and dragons in ghosts
0533+  54FA 2C                   inc l                          ; ( 8 = dragon, 9 = ghost )
0534+  54FB             _nodragons
0535+  54FB 11 A0 5A             ld de,objchar
0536+  54FE 26 00                ld h,0
0537+  5500 19                   add hl,de
0538+  5501 7E                   ld a,(hl)
0539+  5502 08                   ex af,af
0540+  5503             
0541+  5503 CD C3 57             call randomxy                    ; find floor
0542+  5506                                                       ; de = hidden + y-coord * MAPW + x-coord
0543+  5506             
0544+  5506 21 00 04             ld hl,visible-hidden             ; move from scr to visible area
0545+  5509 19                   add hl,de
0546+  550A 7E                   ld a,(hl)
0547+  550B A7                   and a                            ; only spawn in non-visible squares
0548+  550C C2 11 55             jp nz,_nospawn
0549+  550F             
0550+  550F 08                   ex af,af
0551+  5510 12                   ld (de),a
0552+  5511             
0553+  5511             _nospawn
0554+  5511             
0555+  5511             
0556+  5511             
0557+  5511             ;- player actions
0558+  5511             
0559+  5511             
0560+  5511             ;----- keyboard
0561+  5511             ; 8 RIGHT DOWN UP LEFT DEL INS HOME SPACE
0562+  5511             waitkey
0563+  5511 CD AB 7A             call _joy
0564+  5514 E6 1F                and    00011111B
0565+  5516 FE 1F                cp     00011111B
0566+  5518 3E FF                ld     a,255
0567+  551A 20 09                jr     nz,somekey
0568+  551C             
0569+  551C 3E 08                ld a,8
0570+  551E CD 41 01             call 0x0141                ; MC moves
0571+  5521 3C                   inc a
0572+  5522 28 ED                jr z,waitkey               ; remve for real time!!
0573+  5524 3D                   dec a
0574+  5525             
0575+  5525             somekey
0576+  5525 26 00                ld h,0 ; 0 DOWN
0577+  5527 CB 77                bit 6,a
0578+  5529 28 20                jr z,_keyfound
0579+  552B CB 4D                bit  1,l
0580+  552D 28 1C                jr z,_keyfound
0581+  552F                      
0582+  552F 24                   inc h ; 1 RIGHT
0583+  5530 CB 7F                bit 7,a
0584+  5532 28 17                jr z,_keyfound
0585+  5534 CB 5D                bit  3,l
0586+  5536 28 13                jr z,_keyfound
0587+  5538                      
0588+  5538 24                   inc h ; 2 UP
0589+  5539 CB 6F                bit 5,a
0590+  553B 28 0E                jr z,_keyfound
0591+  553D CB 45                bit  0,l
0592+  553F 28 0A                jr z,_keyfound
0593+  5541                      
0594+  5541                      
0595+  5541 24                   inc h ; 3 LEFT
0596+  5542 CB 67                bit 4,a
0597+  5544 28 05                jr z,_keyfound
0598+  5546 CB 55                bit  2,l
0599+  5548 28 01                jr z,_keyfound
0600+  554A                      
0601+  554A                      
0602+  554A 24                   inc h ; 4 NO MOVE
0603+  554B             
0604+  554B             ;----- direction table (0 = down; 1 = right; 2 = up; 3 = left, 4 = no move)
0605+  554B             
0606+  554B             _keyfound
0607+  554B DD 74 0E             ld  (ix+mandir),h
0608+  554E CD 21 57             call setdirx
0609+  5551 CD DC 57             call locateman             ; de = hidden + y-coord * MAPW + x-coord
0610+  5554                       
0611+  5554 DD 7E 0A             ld a,(ix+underman)
0612+  5557 12                   ld (de),a
0613+  5558                      
0614+  5558 CD 57 57             call movedir
0615+  555B             
0616+  555B E5                   push hl
0617+  555C             
0618+  555C 21 A0 5A             ld hl,objchar
0619+  555F 0E 00                ld c,0
0620+  5561             _findobj
0621+  5561 BE                   cp (hl)
0622+  5562 CA 6A 55             jp z,_objfound
0623+  5565 23                   inc hl
0624+  5566 0C                   inc c
0625+  5567 C3 61 55             jp _findobj
0626+  556A             
0627+  556A             _objfound
0628+  556A 06 00               ld b,0
0629+  556C 21 6E 5A            ld hl,actionlist
0630+  556F 09                  add hl,bc
0631+  5570 09                  add hl,bc
0632+  5571                     
0633+  5571 5E 23 56 2B         ld de,(hl)
0634+  5575 FD 6B FD 62         ld iy,de
0635+  5579             
0636+  5579 E1                  pop hl
0637+  557A CD 34 57            call random                 ; many actions use random value
0638+  557D CB 3F               srl a
0639+  557F CD A0 55            call doact_
0640+  5582             
0641+  5582             ;------ update number of rounds
0642+  5582             
0643+  5582 3A 00 C0             ld     a,(nround)
0644+  5585 C6 01                add    a,0x01
0645+  5587 27                   daa
0646+  5588 32 00 C0             ld     (nround),a
0647+  558B 3A 01 C0             ld     a,(nround+1)
0648+  558E CE 00                adc    a,0x00
0649+  5590 27                   daa
0650+  5591 32 01 C0             ld     (nround+1),a
0651+  5594 3A 02 C0             ld     a,(nround+2)
0652+  5597 CE 00                adc    a,0x00
0653+  5599 27                   daa
0654+  559A 32 02 C0             ld     (nround+2),a
0655+  559D             
0656+  559D             ;----- end loop
0657+  559D             
0658+  559D C3 CD 53            jp MAINLOOP
0659+  55A0             
0660+  55A0             ;----- do action
0661+  55A0             
0662+  55A0             doact_
0663+  55A0 FD E9               jp iy
0664+  55A2             
0665+  55A2             ;----- write bcd number
0666+  55A2             
0667+  55A2             writebcd:
0668+  55A2 F5                   push af
0669+  55A3 CD AC 55             call _bcdone
0670+  55A6             
0671+  55A6 2B                   dec hl
0672+  55A7             
0673+  55A7 F1                   pop af
0674+  55A8 0F                   rrca
0675+  55A9 0F                   rrca
0676+  55AA 0F                   rrca
0677+  55AB 0F                   rrca
0678+  55AC             _bcdone
0679+  55AC E6 0F                and 0x0f
0680+  55AE C6 13                add a,19 ; '0'
0681+  55B0             
0682+  55B0 CD 4D 00             call wrtvrm 
0683+  55B3 C9                   ret
0684+  55B4             
0685+  55B4             ;----- restore precomputed seeds for new levels
0686+  55B4             
0687+  55B4             newlevel:
0688+  55B4 E5          		push	hl
0689+  55B5 DD 5E 13    		ld      e,(ix+LEVEL)
0690+  55B8 16 00       		ld	    d,0
0691+  55BA 21 68 E2            ld      hl,seeds
0692+  55BD 19          		add	    hl,de
0693+  55BE 7E          		ld	    a,(hl)
0694+  55BF 23                  inc     hl
0695+  55C0 4E                  ld      c,(hl)
0696+  55C1 E1          		pop	    hl
0697+  55C2 C9          		ret
0698+  55C3             
0699+  55C3             
0700+  55C3             ;----- move to level (a = $99 up, $01 down)
0701+  55C3             
0702+  55C3             movetolevel:
0703+  55C3             
0704+  55C3 DD 86 13            add a,(ix+LEVEL)
0705+  55C6 27                  daa
0706+  55C7 DD 77 13            ld (ix+LEVEL),a
0707+  55CA                     ;
0708+  55CA CD 9D 77            call    setdot
0709+  55CD                     ;
0710+  55CD             ;----- generate dungeon level
0711+  55CD             
0712+  55CD             generatelevel:
0713+  55CD             
0714+  55CD DD 36 16 00         ld  (ix+flip),0             ; tempory meaning : 1 = new level, 0 = visited level
0715+  55D1             
0716+  55D1 11 68 E1            ld de,levels
0717+  55D4 26 00               ld h,0
0718+  55D6 6F                  ld l,a
0719+  55D7 19                  add hl,de
0720+  55D8 7E                  ld a,(hl)
0721+  55D9 A7                  and a                       ; check if dungeon level visited
0722+  55DA C2 EB 55            jp nz,_oldlevel
0723+  55DD             
0724+  55DD DD 34 16            inc  (ix+flip)              ; tempory meaning : 1 = new level, 0 = visited level
0725+  55E0 CD B4 55            call    newlevel            ; new precomputed random seeds in a and c
0726+  55E3             
0727+  55E3 77                  ld (hl),a                   ; newlevel does not affect hl
0728+  55E4             
0729+  55E4 E5                  push hl
0730+  55E5 11 80 00            ld de,0x80
0731+  55E8 19                  add hl,de
0732+  55E9 71                  ld (hl),c
0733+  55EA E1                  pop hl
0734+  55EB             
0735+  55EB             _oldlevel
0736+  55EB 7E                  ld a,(hl)                   ; init pseudo-random generator
0737+  55EC DD 77 1F            ld (ix+seed1),a
0738+  55EF             
0739+  55EF 11 80 00            ld de,0x80
0740+  55F2 19                  add hl,de
0741+  55F3 7E                  ld a,(hl)
0742+  55F4 DD 77 20            ld (ix+seed2),a
0743+  55F7             
0744+  55F7 DD 7E 13            ld a,(ix+LEVEL)
0745+  55FA DD 77 21            ld (ix+prevr),a              ; use level number as previous random
0746+  55FD             
0747+  55FD             ;- fill map area with black wall character
0748+  55FD             
0749+  55FD             
0750+  55FD 21 03 CD            ld hl,visible
0751+  5600 11 03 C9            ld de,hidden
0752+  5603 01 70 03            ld bc,MAPW*(MAPH+2) + 256
0753+  5606 3E 03               ld a,wallchr
0754+  5608             _imaplp:
0755+  5608 36 00               ld (hl),0
0756+  560A 12                  ld (de),a
0757+  560B 23                  inc hl
0758+  560C 13                  inc de
0759+  560D 0D                  dec c
0760+  560E 20 F8               jr nz, _imaplp        
0761+  5610 10 F6               djnz   _imaplp
0762+  5612             
0763+  5612             ;
0764+  5612             ;- dungeon level generator
0765+  5612             ;- draw caves
0766+  5612             
0767+  5612 21 0C 0C            ld hl,MAPW/2+256*MAPH/2             ; y coord => H 
0768+  5615                                                         ; x coord => L
0769+  5615             
0770+  5615             ; coordinate x,y del punto iniziale nel livello
0771+  5615             
0772+  5615             ; lo schermo  MAPW colonne x MAPH righe
0773+  5615             
0774+  5615             
0775+  5615                    
0776+  5615 06 40              ld b,2*DOORS
0777+  5617             
0778+  5617             _nextcave
0779+  5617 C5                 push bc
0780+  5618 CD 1A 57           call randomdir   ; random cave direction
0781+  561B             
0782+  561B E6 07              and CAVERUN      ; random cave run length
0783+  561D             
0784+  561D 47                 ld   b,a
0785+  561E             _cavestep
0786+  561E C5                 push bc
0787+  561F CD 57 57           call movedir     ; draw one step of cave
0788+  5622 3E 20              ld   a,floorchr
0789+  5624 12                 ld   (de),a
0790+  5625 C1                 pop  bc
0791+  5626 10 F6              djnz _cavestep
0792+  5628             
0793+  5628 C1                 pop  bc
0794+  5629 10 EC              djnz _nextcave
0795+  562B             
0796+  562B             
0797+  562B             ;- draw rooms
0798+  562B             
0799+  562B 06 05               ld b,ROOMS
0800+  562D             
0801+  562D             _nextroom
0802+  562D C5                  push    bc
0803+  562E             
0804+  562E CD C3 57            call randomxy
0805+  5631             
0806+  5631 25                  dec h
0807+  5632 25                  dec h               ; y-=2;
0808+  5633 2D                  dec l               ; x--;
0809+  5634             
0810+  5634 06 05               ld b,0x05           ; roomsize
0811+  5636             _drawroom
0812+  5636 C5                  push    bc
0813+  5637             
0814+  5637 CD E2 57            call locate
0815+  563A 3E 20               ld a,floorchr
0816+  563C             
0817+  563C 12                  ld (de),a
0818+  563D 13                  inc de
0819+  563E 12                  ld (de),a
0820+  563F 13                  inc de
0821+  5640 12                  ld (de),a
0822+  5641             
0823+  5641 24                  inc h               ; y++;
0824+  5642             
0825+  5642 C1                  pop bc
0826+  5643 10 F1               djnz _drawroom
0827+  5645             
0828+  5645 C1                  pop bc
0829+  5646 10 E5               djnz _nextroom
0830+  5648             
0831+  5648             
0832+  5648             ;- draw some doors
0833+  5648             
0834+  5648 06 20               ld      b,DOORS
0835+  564A             _nextdoor
0836+  564A C5                  push    bc
0837+  564B             
0838+  564B AF                  xor a
0839+  564C DD 77 08            ld (ix+verd),a
0840+  564F DD 77 09            ld (ix+hord),a
0841+  5652             
0842+  5652 CD C3 57            call randomxy
0843+  5655             
0844+  5655 2D                  dec l                       ; check surrounding blocks
0845+  5656 CD CB 56            call hordcheck
0846+  5659             
0847+  5659 2C                  inc l
0848+  565A 2C                  inc l
0849+  565B CD CB 56            call hordcheck
0850+  565E             
0851+  565E 2D                  dec l
0852+  565F 25                  dec h
0853+  5660 CD E3 56            call verdcheck
0854+  5663             
0855+  5663 24                  inc h
0856+  5664 24                  inc h
0857+  5665 CD E3 56            call verdcheck
0858+  5668             
0859+  5668 DD 7E 08            ld a,(ix+verd)              ; if both same then no door
0860+  566B DD BE 09            cp (ix+hord)
0861+  566E CA 80 56            jp z,_nodoor
0862+  5671             
0863+  5671                                                 ; if sum not 2 then no door
0864+  5671 DD 86 09            add a,(ix+hord)
0865+  5674 FE 02               cp 0x02
0866+  5676 C2 80 56            jp nz,_nodoor
0867+  5679             
0868+  5679 25                  dec h                       ; draw door
0869+  567A CD E2 57            call locate
0870+  567D                     
0871+  567D 3E 24               ld a,doorchr
0872+  567F 12                  ld (de),a
0873+  5680             
0874+  5680             _nodoor
0875+  5680 C1                  pop     bc
0876+  5681 10 C7               djnz _nextdoor
0877+  5683             
0878+  5683                             
0879+  5683             ;- draw staircases and the amulet on last level
0880+  5683             
0881+  5683 CD C3 57            call randomxy               ; staircase down or amulet
0882+  5686 DD 75 04            ld (ix+stairdownx),l
0883+  5689 DD 74 05            ld (ix+stairdowny),h
0884+  568C             
0885+  568C DD 7E 13            ld a,(ix+LEVEL)             ; amulet on last level
0886+  568F             
0887+  568F DD BE 22            cp (ix+_lastlevel)
0888+  5692 3E 23               ld a,downchr
0889+  5694 C2 A0 56            jp nz,_noamulet
0890+  5697             
0891+  5697 DD 7E 14            ld a,(ix+AMULET)            ; but only once
0892+  569A A7                  and a
0893+  569B C2 A1 56            jp nz,_nodown
0894+  569E             
0895+  569E 3E 2B               ld a,amuletchr
0896+  56A0             _noamulet
0897+  56A0             
0898+  56A0 12                  ld (de),a
0899+  56A1             
0900+  56A1             _nodown
0901+  56A1 CD C3 57            call randomxy               ; staircase up
0902+  56A4             
0903+  56A4 DD 75 02            ld (ix+stairupx),l
0904+  56A7 DD 74 03            ld (ix+stairupy),h
0905+  56AA             
0906+  56AA 3E 22               ld  a,upchr
0907+  56AC 12                  ld (de),a
0908+  56AD             
0909+  56AD             ;- draw some chests
0910+  56AD             
0911+  56AD DD 46 30            ld b,(ix+_chests)
0912+  56B0             _nextchest:
0913+  56B0 C5                  push    bc
0914+  56B1 CD C3 57            call    randomxy            ; place a chest
0915+  56B4             
0916+  56B4 3E 26               ld      a,chestchr          ; set chest
0917+  56B6 12                  ld      (de),a
0918+  56B7                    
0919+  56B7 DD 7E 16            ld      a,(ix+flip)         ; tempory meaning : 1 = new level, 0 = visited level
0920+  56BA A7                  and a                       ; check if dungeon level is visited
0921+  56BB                                                 ; if NZ this is a new level
0922+  56BB C1                  pop     bc
0923+  56BC C5                  push    bc                  ; retrive b
0924+  56BD C4 3E 7A            call    nz,storechestinfo   ; store chest position ONLY in non visited levels
0925+  56C0             1:
0926+  56C0 C1                  pop     bc
0927+  56C1 10 ED               djnz    _nextchest
0928+  56C3             
0929+  56C3 DD 7E 16            ld      a,(ix+flip)         ; tempory meaning : 1 = new level, 0 = visited level
0930+  56C6 A7                  and a                       ; check if dungeon level is visited
0931+  56C7 CC 4E 7A            call   z,removeopenchests   ; remove open chests only in visited levels
0932+  56CA             
0933+  56CA                     ;- dungeon level done
0934+  56CA                     
0935+  56CA C9                  ret
0936+  56CB             
0937+  56CB                     ;- doorway check
0938+  56CB             
0939+  56CB             hordcheck:
0940+  56CB                     ld bc,(ix+scr)
0940+  56CB DD4E1BDD461C
0941+  56D1 E5                  push hl
0942+  56D2 26 00               ld h,0
0943+  56D4 09                  add hl,bc
0944+  56D5 7E                  ld a,(hl)
0945+  56D6 E1                  pop hl
0946+  56D7                     
0947+  56D7 FE 24               cp doorchr
0948+  56D9 CA F2 56            jp z,_baddoor
0949+  56DC FE 20               cp floorchr
0950+  56DE C0                  ret nz
0951+  56DF DD 34 09            inc (ix+hord)
0952+  56E2 C9                  ret
0953+  56E3             
0954+  56E3             verdcheck:
0955+  56E3 CD E2 57            call locate
0956+  56E6             
0957+  56E6 FE 24               cp doorchr
0958+  56E8 CA F2 56            jp z,_baddoor
0959+  56EB FE 20               cp floorchr
0960+  56ED C0                  ret nz
0961+  56EE DD 34 08            inc (ix+verd)
0962+  56F1 C9                  ret
0963+  56F2             
0964+  56F2             _baddoor:
0965+  56F2 DD 77 08            ld (ix+verd),a          ; no multiple doors
0966+  56F5 C9                  ret
0967+  56F6                     
0968+  56F6             
0969+  56F6             ;----- top line
0970+  56F6             
0971+  56F6 C7CFFFFD2F  hp:     db 'H'+127,'P'+127,255    ,253    ,47
0972+  56FB 28 FD CE CE gold:   db      40,253    ,'O'+127,'O'+127
0973+  56FF             att:    db 'A'+127,'T'+127,'T'+127,253    ,41     ,246
0973+  56FF C0D3D3FD29F6
0974+  5705             def:    db 'D'+127,'E'+127,'F'+127,253    ,42     ,246       
0974+  5705 C3C4C5FD2AF6
0975+  570B             lv:     db 'F'+127,'L'+127,'O'+127,'O'+127,'R'+127,254
0975+  570B C5CBCECED1FE
0976+  5711 C0 CC FD    amulet: db 'A'+127,'M'+127,253
0977+  5714             
0978+  5714             ;----- direction table (0 = down; 1 = right; 2 = up; 3 = left, 4 = no move)
0979+  5714             
0980+  5714             dirx:
0981+  5714 00                  db 0 ; (,$01,$00,$ff)
0982+  5715             diry:
0983+  5715 0100FF0000          db 1,0,-1,0, 0
0984+  571A             
0985+  571A             
0986+  571A             ;----- random direction
0987+  571A             
0988+  571A             randomdir:
0989+  571A CD 34 57            call random
0990+  571D E6 03               and 0x03
0991+  571F                     
0992+  571F             ;----- set direction of (any) movement (a = direction 0-3,4)
0993+  571F             
0994+  571F             setdir:
0995+  571F 4C                  ld c,h
0996+  5720 67                  ld h,a
0997+  5721             setdirx:
0998+  5721             
0999+  5721 E5                  push hl ; preserva hl
1000+  5722                     
1001+  5722 16 00               ld d,0
1002+  5724 5C                  ld e,h
1003+  5725             
1004+  5725 21 14 57            ld hl,dirx
1005+  5728 19                  add hl,de
1006+  5729 7E                  ld a,(hl)
1007+  572A DD 77 00            ld (ix+addx),a
1008+  572D 23                  inc hl
1009+  572E 7E                  ld a,(hl)
1010+  572F DD 77 01            ld (ix+addy),a
1011+  5732                     
1012+  5732 E1                  pop hl
1013+  5733 61                  ld h,c
1014+  5734                     ;
1015+  5734                     ;
1016+  5734             ;----- generate pseudo-random number, always clear carry (for add)
1017+  5734             
1018+  5734             random:
1019+  5734 DD 34 20            inc (ix+seed2)
1020+  5737 DD 7E 20            ld a,(ix+seed2)
1021+  573A DD 86 1F            add a,(ix+seed1)
1022+  573D DD 8E 20            adc a,(ix+seed2)
1023+  5740 DD 77 1F            ld (ix+seed1),a
1024+  5743 F5                  push af
1025+  5744 DD AE 20            xor (ix+seed2)
1026+  5747 DD 77 20            ld (ix+seed2),a
1027+  574A F1                  pop af
1028+  574B DD 7E 20            ld a,(ix+seed2)
1029+  574E 37                  scf
1030+  574F DD 9E 21            sbc (ix+prevr)
1031+  5752 DD 77 21            ld (ix+prevr),a
1032+  5755 A7                  and a
1033+  5756 C9                  ret
1034+  5757             
1035+  5757             
1036+  5757             
1037+  5757             ;----- step y,x in current direction within screen boundaries
1038+  5757             
1039+  5757             movedir:
1040+  5757 7C                  ld a,h ; y-movement
1041+  5758 DD 86 01            add a,(ix+addy)
1042+  575B 67                  ld h,a
1043+  575C             
1044+  575C 3D                  dec a ; y-boundary 0x01
1045+  575D C2 61 57            jp nz,_noty01
1046+  5760 24                  inc h
1047+  5761             _noty01
1048+  5761 7C                  ld a,h
1049+  5762 FE 18               cp MAPH ; y-boundary MAPH
1050+  5764 C2 68 57            jp nz,_noty18
1051+  5767 25                  dec h
1052+  5768             _noty18
1053+  5768             
1054+  5768 7D                  ld a,l ; x-movement
1055+  5769 DD 86 00            add a,(ix+addx)
1056+  576C 6F                  ld l,a
1057+  576D             
1058+  576D C2 71 57            jp nz,_notx00 ; x-boundary 0x00
1059+  5770 2C                  inc l
1060+  5771             _notx00
1061+  5771 7D                  ld a,l
1062+  5772 FE 17               cp MAPW-1 ; x-boundary MAPW-1
1063+  5774 C2 78 57            jp nz,_notx13
1064+  5777 2D                  dec l
1065+  5778             _notx13
1066+  5778 C3 E2 57            jp locate ; always branch
1067+  577B             
1068+  577B             
1069+  577B             
1070+  577B             ;----- some math helper functions 
1071+  577B             ; 
1072+  577B             RandomVal:                  ; return a random value in 0-(E-1)
1073+  577B D5          	push	de
1074+  577C CD 34 57    	call	random
1075+  577F D1              pop     de
1076+  5780 57              ld      d,a
1077+  5781 AF              xor     a
1078+  5782                 ;
1079+  5782                 ;
1080+  5782             
1081+  5782             ;Input: D = Dividend, E = Divisor, A = 0
1082+  5782             ;Output: D = Quotient, A = Remainder
1083+  5782             
1084+  5782             div8:
1085+  5782                 rept    8
1086+  5782~            	sla	d		; unroll 8 times
1087+  5782~            	rla			; ...
1088+  5782~            	cp	e		; ...
1089+  5782~            	jr	c,$+4		; ...
1090+  5782~            	sub	e		; ...
1091+  5782~            	inc	d		; ...
1092+  5782                 endm
1092+  5782 CB 22       >	sla	d		; unroll 8 times
1092+  5784 17          >	rla			; ...
1092+  5785 BB          >	cp	e		; ...
1092+  5786 38 02       >	jr	c,$+4		; ...
1092+  5788 93          >	sub	e		; ...
1092+  5789 14          >	inc	d		; ...
1092+  578A CB 22       >	sla	d		; unroll 8 times
1092+  578C 17          >	rla			; ...
1092+  578D BB          >	cp	e		; ...
1092+  578E 38 02       >	jr	c,$+4		; ...
1092+  5790 93          >	sub	e		; ...
1092+  5791 14          >	inc	d		; ...
1092+  5792 CB 22       >	sla	d		; unroll 8 times
1092+  5794 17          >	rla			; ...
1092+  5795 BB          >	cp	e		; ...
1092+  5796 38 02       >	jr	c,$+4		; ...
1092+  5798 93          >	sub	e		; ...
1092+  5799 14          >	inc	d		; ...
1092+  579A CB 22       >	sla	d		; unroll 8 times
1092+  579C 17          >	rla			; ...
1092+  579D BB          >	cp	e		; ...
1092+  579E 38 02       >	jr	c,$+4		; ...
1092+  57A0 93          >	sub	e		; ...
1092+  57A1 14          >	inc	d		; ...
1092+  57A2 CB 22       >	sla	d		; unroll 8 times
1092+  57A4 17          >	rla			; ...
1092+  57A5 BB          >	cp	e		; ...
1092+  57A6 38 02       >	jr	c,$+4		; ...
1092+  57A8 93          >	sub	e		; ...
1092+  57A9 14          >	inc	d		; ...
1092+  57AA CB 22       >	sla	d		; unroll 8 times
1092+  57AC 17          >	rla			; ...
1092+  57AD BB          >	cp	e		; ...
1092+  57AE 38 02       >	jr	c,$+4		; ...
1092+  57B0 93          >	sub	e		; ...
1092+  57B1 14          >	inc	d		; ...
1092+  57B2 CB 22       >	sla	d		; unroll 8 times
1092+  57B4 17          >	rla			; ...
1092+  57B5 BB          >	cp	e		; ...
1092+  57B6 38 02       >	jr	c,$+4		; ...
1092+  57B8 93          >	sub	e		; ...
1092+  57B9 14          >	inc	d		; ...
1092+  57BA CB 22       >	sla	d		; unroll 8 times
1092+  57BC 17          >	rla			; ...
1092+  57BD BB          >	cp	e		; ...
1092+  57BE 38 02       >	jr	c,$+4		; ...
1092+  57C0 93          >	sub	e		; ...
1092+  57C1 14          >	inc	d		; ...
1093+  57C2 C9              ret
1094+  57C3             
1095+  57C3             ;----- random coordinates, find floor
1096+  57C3             
1097+  57C3             ;_randomxy:
1098+  57C3             ;
1099+  57C3             ;        call random ; x-coordinate, $02-(MAPW-3)
1100+  57C3             ;        and 15
1101+  57C3             ;        add a,0x02
1102+  57C3             ;        ld l,a
1103+  57C3             ;
1104+  57C3             ;        call random ; y-coordinate, $05-(MAPH-4)
1105+  57C3             ;        and 15
1106+  57C3             ;        add 0x05
1107+  57C3             ;        ld h,a
1108+  57C3             ;
1109+  57C3             ;        call locate
1110+  57C3             ;        cp floorchr
1111+  57C3             ;        jp nz,randomxy
1112+  57C3             ;
1113+  57C3             ;        ret
1114+  57C3             
1115+  57C3             randomxy:
1116+  57C3             
1117+  57C3 1E 14               ld  e,MAPW-4
1118+  57C5 CD 7B 57            call    RandomVal
1119+  57C8 C6 02               add a,0x02  ; x-coordinate, $02-(MAPW-3)
1120+  57CA 6F                  ld l,a
1121+  57CB             
1122+  57CB 1E 12               ld  e,MAPH-6
1123+  57CD CD 7B 57            call    RandomVal      
1124+  57D0 C6 04               add a,0x04
1125+  57D2 67                  ld  h,a     ; y-coordinate, $05-(MAPH-4)
1126+  57D3             
1127+  57D3 CD E2 57            call locate
1128+  57D6 FE 20               cp floorchr
1129+  57D8 C2 C3 57            jp nz,randomxy
1130+  57DB             
1131+  57DB C9                  ret
1132+  57DC             
1133+  57DC             
1134+  57DC             ;----- locate man
1135+  57DC             
1136+  57DC             locateman:
1137+  57DC DD 6E 06            ld l,(ix+manx)
1138+  57DF DD 66 07            ld h,(ix+many)
1139+  57E2                     ;
1140+  57E2             ;----- locate screen line
1141+  57E2             
1142+  57E2             ; l = x-coordinate
1143+  57E2             ; h = y-coordinate
1144+  57E2             
1145+  57E2             
1146+  57E2             locate
1147+  57E2 EB                  ex de,hl
1148+  57E3             
1149+  57E3 D5                  push    de
1150+  57E4             
1151+  57E4 62                  ld      h,d
1152+  57E5 1E 18               ld      e,MAPW
1153+  57E7             
1154+  57E7 CD 08 58            call    mul8
1155+  57EA D1                  pop     de
1156+  57EB             
1157+  57EB 01 03 C9            ld bc,hidden
1158+  57EE 09                  add hl,bc
1159+  57EF             
1160+  57EF                     ld (ix+scr),hl          ; scr = hidden + y-coord * MAPW
1160+  57EF DD751BDD741C
1161+  57F5             
1162+  57F5 E5                  push hl
1163+  57F6 01 00 04            ld bc,visible-hidden
1164+  57F9 09                  add hl,bc
1165+  57FA                     ld (ix+color),hl        ; color = visible + y-coord * MAPW
1165+  57FA DD751DDD741E
1166+  5800 E1                  pop hl
1167+  5801             
1168+  5801 06 00               ld b,0
1169+  5803 4B                  ld c,e
1170+  5804 09                  add hl,bc
1171+  5805             
1172+  5805 7E                  ld a,(hl)
1173+  5806             
1174+  5806 EB                  ex de,hl                ; de = hidden + y-coord * MAPW + x-coord
1175+  5807 C9                  ret
1176+  5808             
1177+  5808             ;Input: H = Multiplier, E = Multiplicand, L = 0, D = 0
1178+  5808             ;Output: HL = Product
1179+  5808             ;Note: BC is unaffected
1180+  5808             
1181+  5808             mul8:
1182+  5808 2E 00               ld      l,0
1183+  580A 55                  ld      d,l
1184+  580B             
1185+  580B CB 24               sla	h		; optimised 1st iteration
1186+  580D 30 01               jr	nc,$+3
1187+  580F 6B                  ld	l,e
1188+  5810                     rept 7
1189+  5810~                        add	hl,hl		; unroll 7 times
1190+  5810~                        jr	nc,$+3		; ...
1191+  5810~                        add	hl,de		; ...
1192+  5810                     endm
1192+  5810 29          >            add	hl,hl		; unroll 7 times
1192+  5811 30 01       >            jr	nc,$+3		; ...
1192+  5813 19          >            add	hl,de		; ...
1192+  5814 29          >            add	hl,hl		; unroll 7 times
1192+  5815 30 01       >            jr	nc,$+3		; ...
1192+  5817 19          >            add	hl,de		; ...
1192+  5818 29          >            add	hl,hl		; unroll 7 times
1192+  5819 30 01       >            jr	nc,$+3		; ...
1192+  581B 19          >            add	hl,de		; ...
1192+  581C 29          >            add	hl,hl		; unroll 7 times
1192+  581D 30 01       >            jr	nc,$+3		; ...
1192+  581F 19          >            add	hl,de		; ...
1192+  5820 29          >            add	hl,hl		; unroll 7 times
1192+  5821 30 01       >            jr	nc,$+3		; ...
1192+  5823 19          >            add	hl,de		; ...
1192+  5824 29          >            add	hl,hl		; unroll 7 times
1192+  5825 30 01       >            jr	nc,$+3		; ...
1192+  5827 19          >            add	hl,de		; ...
1192+  5828 29          >            add	hl,hl		; unroll 7 times
1192+  5829 30 01       >            jr	nc,$+3		; ...
1192+  582B 19          >            add	hl,de		; ...
1193+  582C C9                  ret
1194+  582D             
1195+  582D             
1196+  582D             ;----- actions (2 byte jumptable)
1197+  582D             ;
1198+  582D             stairup:
1199+  582D 3E 03                ld      a,3                     ; stairup SFX
1200+  582F 0E 00                ld      c,0                    ;   Priority
1201+  5831 CD CE BA             call    ayFX_INIT
1202+  5834             
1203+  5834 CD DF 58             call    walk
1204+  5837 3E 18                ld a,24       ; posizione del manchr
1205+  5839 CD 40 5A             call drawchar
1206+  583C CD D1 7A             call fastmanview  
1207+  583F DD 34 16             inc (ix+flip)                          
1208+  5842 CD A0 76             call render
1209+  5845             
1210+  5845 3E 99                ld a,0x99          ; climb up a level
1211+  5847 CD C3 55             call movetolevel
1212+  584A DD 7E 13             ld a,(ix+LEVEL)
1213+  584D A7                   and a
1214+  584E CA 5A 58             jp z,checkamulet   ; player leaving dungeon
1215+  5851             
1216+  5851 DD 6E 04             ld l,(ix+stairdownx)
1217+  5854 DD 66 05             ld h,(ix+stairdowny)
1218+  5857 C3 DF 58             jp walk
1219+  585A             
1220+  585A             checkamulet:
1221+  585A DD 7E 14             ld a,(ix+AMULET)               ; throw back to dungeon if no amulet
1222+  585D A7                   and a
1223+  585E CA B6 58             jp z,badend                ; (without showing level 0)
1224+  5861             
1225+  5861 DD 7E 12             ld a,(ix+GOLD100)              ; award 1000 gold
1226+  5864 C6 10                add a,0x10
1227+  5866 27                   daa
1228+  5867 DD 77 12             ld (ix+GOLD100),a
1229+  586A             
1230+  586A CD C7 76             call   sidebar
1231+  586D             
1232+  586D CD 1B 5F             call   endsequence             ; SUCCESS!!!!!!
1233+  5870             
1234+  5870 21 84 BA             ld     hl,MUSIC6			; hl <- initial address of module 
1235+  5873 CD CF A0            call	PT3_INIT			; Inits PT3 player
1236+  5876             
1237+  5876 CD 41 00             call    disscr
1238+  5879 76                   halt
1239+  587A CD 57 5D             call   cls
1240+  587D CD 7E 76             call _nosprt
1241+  5880                      
1242+  5880 CD 50 40             call SETGAMEPAGE0
1243+  5883 CD 3F 00             call intro_START
1244+  5886 CD 56 40             call RESTOREBIOS
1245+  5889             
1246+  5889 CD 0C 53            call    CheckIf60Hz
1247+  588C 3D                  dec a
1248+  588D 32 48 E4            ld (vsf),a                ; 0=>60Hz, !0=>50Hz
1249+  5890             
1250+  5890 21 49 E4            ld      hl,cnt
1251+  5893 36 01               ld      (hl),1               ; reset the tic counter
1252+  5895             		
1253+  5895             		
1254+  5895 3E FD               ld      a,-3
1255+  5897 32 D5 E5            ld      (_psg_vol_fix),a
1256+  589A CD 6F 44    		call SCCINIT
1257+  589D CD 95 40    		call 	_SCC_PSG_Volume_balance
1258+  58A0             
1259+  58A0 CD C3 BA            call    ayFX_SETUP
1260+  58A3             
1261+  58A3 AF                  xor a
1262+  58A4 32 4A E4            ld     [PT3_SETUP],a       ; LOOP the song
1263+  58A7             
1264+  58A7 21 84 BA    		ld	hl,MUSIC6			; hl <- initial address of module 
1265+  58AA CD CF A0    		call	PT3_INIT			; Inits PT3 player
1266+  58AD             
1267+  58AD FB                   ei
1268+  58AE                      
1269+  58AE 06 05                ld     b,5
1270+  58B0 76          1:       halt
1271+  58B1 10 FD                djnz   1b
1272+  58B3             
1273+  58B3 C3 7C 53             jp entry
1274+  58B6             badend:
1275+  58B6 CD 75 74             call badendscript
1276+  58B9             
1277+  58B9 C3 D4 58             jp _stairdown
1278+  58BC             
1279+  58BC             stairdown:
1280+  58BC 3E 02                ld      a,2                     ; stairdown SFX
1281+  58BE 0E 00                ld      c,0                     ;   Priority
1282+  58C0 CD CE BA             call    ayFX_INIT
1283+  58C3             
1284+  58C3 CD DF 58             call    walk
1285+  58C6 3E 18                ld a,24       ; posizione del manchr
1286+  58C8 CD 40 5A             call drawchar
1287+  58CB CD D1 7A             call fastmanview                  
1288+  58CE DD 34 16             inc (ix+flip)          
1289+  58D1 CD A0 76             call render
1290+  58D4             _stairdown:                             ; only to generate first level
1291+  58D4 3E 01                ld a,0x01                      ; climb down a level
1292+  58D6 CD C3 55             call movetolevel
1293+  58D9 DD 6E 02             ld l,(ix+stairupx)
1294+  58DC DD 66 03             ld h,(ix+stairupy)
1295+  58DF             walk:
1296+  58DF DD 75 06             ld (ix+manx),l                 ; new coordinates to man
1297+  58E2 DD 74 07             ld (ix+many),h
1298+  58E5             blocked:
1299+  58E5 C9                   ret                            ; do nothing if way blocked
1300+  58E6             
1301+  58E6             hitchest:                               ; in h,l the coords of the chest
1302+  58E6 E5                   push   hl
1303+  58E7 AF                   xor     a                       ; openchest SFX
1304+  58E8 0E 00                ld      c,0                     ;   Priority
1305+  58EA CD CE BA             call    ayFX_INIT
1306+  58ED CD 7E 7A             call    openchest
1307+  58F0 E1                   pop    hl
1308+  58F1             
1309+  58F1 CD 34 57             call random
1310+  58F4             
1311+  58F4 4F                   ld  c,a
1312+  58F5 E6 03                and 0x03                       ; 0=gold,1=potion, 2=weapon, 3=shield
1313+  58F7 CA 3C 5A             jp  z,hitmonst                 ; release gold
1314+  58FA FE 01                cp  1
1315+  58FC CA 18 59             jp  z,healing
1316+  58FF FE 02                cp  2
1317+  5901 CA 0E 59             jp  z,weapon
1318+  5904             
1319+  5904 79          shield:  ld a,c
1320+  5905 0F                   rrca
1321+  5906 0F                   rrca
1322+  5907 E6 03                and 0x03
1323+  5909 C6 14                add a,20
1324+  590B C3 40 5A             jp drawchar
1325+  590E             
1326+  590E 79          weapon:  ld a,c
1327+  590F 0F                   rrca
1328+  5910 0F                   rrca
1329+  5911 E6 03                and 0x03
1330+  5913 C6 10                add a,16
1331+  5915 C3 40 5A             jp drawchar
1332+  5918             
1333+  5918 79          healing: ld a,c
1334+  5919 0F                   rrca
1335+  591A 0F                   rrca
1336+  591B E6 03                and 0x03
1337+  591D C6 0C                add a,12
1338+  591F C3 40 5A             jp drawchar
1339+  5922             
1340+  5922             ;-----------
1341+  5922             _set99:
1342+  5922 3E 99                ld     a,0x99
1343+  5924 C9                   ret
1344+  5925             ;-----------
1345+  5925             
1346+  5925             pickweapon0
1347+  5925 DD 4E 28             ld c,(ix+_weap0)
1348+  5928 18 0D                jr 1f
1349+  592A             pickweapon1
1350+  592A DD 4E 29             ld c,(ix+_weap1)
1351+  592D 18 08                jr 1f
1352+  592F             pickweapon2
1353+  592F DD 4E 2A             ld c,(ix+_weap2)
1354+  5932 18 03                jr 1f
1355+  5934             pickweapon3
1356+  5934 DD 4E 2B             ld c,(ix+_weap3)
1357+  5937             1:
1358+  5937 DD 7E 0D             ld a,(ix+ATT)                  ; take a new weapon
1359+  593A 81                   add a,c
1360+  593B 27                   daa
1361+  593C DC 22 59             call c,_set99                  ; no more if more than 99
1362+  593F DD 77 0D             ld (ix+ATT),a
1363+  5942             
1364+  5942 F5                   push    af
1365+  5943 3E 05                ld      a,5                     ; powerup SFX
1366+  5945 0E 00                ld      c,0                    ;   Priority
1367+  5947 CD CE BA             call    ayFX_INIT
1368+  594A F1                   pop     af
1369+  594B             
1370+  594B C3 EA 59             jp _pickany ; always branch
1371+  594E             
1372+  594E             pickshield0
1373+  594E DD 4E 2C             ld        c,(ix+_shld0)
1374+  5951 18 0D                jr 1f
1375+  5953             pickshield1
1376+  5953 DD 4E 2D             ld        c,(ix+_shld1)
1377+  5956 18 08                jr 1f
1378+  5958             pickshield2
1379+  5958 DD 4E 2E             ld        c,(ix+_shld2)
1380+  595B 18 03                jr 1f
1381+  595D             pickshield3
1382+  595D DD 4E 2F             ld        c,(ix+_shld3)
1383+  5960             1:
1384+  5960 DD 7E 0C             ld a,(ix+DEF)                  ; take a new shield
1385+  5963 81                   add a,c
1386+  5964 27                   daa
1387+  5965 DC 22 59             call c,_set99                  ; no more if more than 99
1388+  5968 DD 77 0C             ld (ix+DEF),a
1389+  596B             
1390+  596B F5                   push    af
1391+  596C 3E 05                ld      a,5                     ; powerup SFX
1392+  596E 0E 00                ld      c,0                    ;   Priority
1393+  5970 CD CE BA             call    ayFX_INIT
1394+  5973 F1                   pop     af
1395+  5974             
1396+  5974 C3 EA 59             jp _pickany ; always branch
1397+  5977             
1398+  5977             getamulet:
1399+  5977 DD E5               push    ix
1400+  5979 E5                  push    hl
1401+  597A CD 9D 71            call    foundamulet
1402+  597D CD 9D 77            call    setdot
1403+  5980                     
1404+  5980 21 5E B1    		ld	hl,MUSIC3			; hl <- initial address of module 
1405+  5983 CD CF A0    		call	PT3_INIT			; Inits PT3 player
1406+  5986 E1                  pop    hl
1407+  5987 DD E1               pop     ix
1408+  5989             
1409+  5989 DD 34 14             inc (ix+AMULET)                ; picked up the amulet
1410+  598C DD 4E 27             ld         c,(ix+_heal3)         
1411+  598F 18 2E               jr  1f                          ; no sfx
1412+  5991                      
1413+  5991                      ;
1414+  5991             pickpotion0:
1415+  5991 3E 06                ld      a,6                     ; potionsm SFX
1416+  5993 0E 00                ld      c,0                     ;   Priority
1417+  5995 CD CE BA             call    ayFX_INIT
1418+  5998             
1419+  5998 DD 4E 24             ld         c,(ix+_heal0)
1420+  599B 18 22                jr 1f
1421+  599D             pickpotion1:
1422+  599D 3E 06                ld      a,6                     ; potionsm SFX
1423+  599F 0E 00                ld      c,0                     ;   Priority
1424+  59A1 CD CE BA             call    ayFX_INIT
1425+  59A4             
1426+  59A4 DD 4E 25             ld         c,(ix+_heal1)
1427+  59A7 18 16                jr 1f
1428+  59A9             pickpotion2:
1429+  59A9 3E 07                ld      a,7                     ; potionbg SFX
1430+  59AB 0E 00                ld      c,0                     ;   Priority
1431+  59AD CD CE BA             call    ayFX_INIT
1432+  59B0             
1433+  59B0 DD 4E 26             ld         c,(ix+_heal2)
1434+  59B3 18 0A                jr 1f
1435+  59B5             pickpotion3:
1436+  59B5 3E 07                ld      a,7                     ; potionbg SFX
1437+  59B7 0E 00                ld      c,0                     ;   Priority
1438+  59B9 CD CE BA             call    ayFX_INIT
1439+  59BC             
1440+  59BC DD 4E 27             ld         c,(ix+_heal3)
1441+  59BF             
1442+  59BF             1:
1443+  59BF DD 7E 0B             ld a,(ix+HITPOINTS)            ; drink potion
1444+  59C2 81                   add a,c
1445+  59C3 27                   daa
1446+  59C4 DC 22 59             call c,_set99                  ; no more if more than 99
1447+  59C7 DD 77 0B             ld (ix+HITPOINTS),a
1448+  59CA             
1449+  59CA C3 EA 59             jp _pickany ; always branch
1450+  59CD             
1451+  59CD             pickgold:
1452+  59CD E6 17                and    MAXGOLD                    ; max gold $17, $07 or $03
1453+  59CF F6 01                or     0x01 ; at least 1 gold
1454+  59D1 DD 86 11             add    a,(ix+GOLD)
1455+  59D4 27                   daa
1456+  59D5 DD 77 11             ld     (ix+GOLD),a
1457+  59D8 DD 7E 12             ld     a,(ix+GOLD100)
1458+  59DB CE 00                adc    a,0x00
1459+  59DD 27                   daa
1460+  59DE DD 77 12             ld     (ix+GOLD100),a
1461+  59E1             
1462+  59E1 E5                   push    hl
1463+  59E2 3E 01                ld      a,1                     ; coins SFX
1464+  59E4 0E 00                ld      c,0                     ;   Priority
1465+  59E6 CD CE BA             call    ayFX_INIT
1466+  59E9 E1                   pop hl
1467+  59EA             
1468+  59EA             _pickany
1469+  59EA             
1470+  59EA CD DF 58             call walk
1471+  59ED             
1472+  59ED AF                   xor a              ; clear tile
1473+  59EE C3 40 5A             jp drawchar        ; rts there
1474+  59F1             
1475+  59F1             opendoor:
1476+  59F1 3E 04                ld      a,4                     ; opendoor SFX
1477+  59F3 0E 00                ld      c,0                    ;   Priority
1478+  59F5 CD CE BA             call    ayFX_INIT
1479+  59F8             
1480+  59F8 AF                   xor a              ; open door
1481+  59F9 C3 40 5A             jp drawchar        ; rts there
1482+  59FC             
1483+  59FC             hitghost:
1484+  59FC E6 7F                and    0x7f
1485+  59FE DD 86 0D             add    a,(ix+ATT)  ; add attack bonus
1486+  5A01 38 39                jr     c,hitmonst  ; if >255 always hit
1487+  5A03 DD BE 33             cp (ix+_ghostac)   ; test man's attack against Dragon's AC
1488+  5A06 F8                   ret m              ; attack failed ?
1489+  5A07             
1490+  5A07 F5                   push    af
1491+  5A08 3E 08                ld      a,8                     ; enehit1 SFX
1492+  5A0A 0E 00                ld      c,0                    ;   Priority
1493+  5A0C CD CE BA             call    ayFX_INIT
1494+  5A0F F1                   pop     af
1495+  5A10             
1496+  5A10 18 2A                jr hitmonst
1497+  5A12             
1498+  5A12             hitdragon:
1499+  5A12 E6 7F                and    0x7f
1500+  5A14 DD 86 0D             add    a,(ix+ATT)  ; add attack bonus
1501+  5A17 38 23                jr     c,hitmonst  ; if >255 always hit
1502+  5A19 DD BE 32             cp (ix+_dragonac)  ; test man's attack against Dragon's AC
1503+  5A1C F8                   ret m              ; attack failed ?
1504+  5A1D             
1505+  5A1D F5                   push    af
1506+  5A1E 3E 08                ld      a,8                     ; enehit1 SFX
1507+  5A20 0E 00                ld      c,0                    ;   Priority
1508+  5A22 CD CE BA             call    ayFX_INIT
1509+  5A25 F1                   pop     af
1510+  5A26             
1511+  5A26 18 14                jr hitmonst
1512+  5A28                      ;
1513+  5A28             hitbatgob:
1514+  5A28 E6 7F                and    0x7f
1515+  5A2A DD 86 0D             add    a,(ix+ATT)  ; add attack bonus
1516+  5A2D 38 0D                jr     c,hitmonst  ; if >255 always hit
1517+  5A2F DD BE 31             cp (ix+_batgobac)  ; test man's attack against bat & goblin AC
1518+  5A32 F8                   ret m              ; attack failed
1519+  5A33             
1520+  5A33 F5                   push    af
1521+  5A34 3E 09                ld      a,9                     ; enehit2 SFX
1522+  5A36 0E 00                ld      c,0                    ;   Priority
1523+  5A38 CD CE BA             call    ayFX_INIT
1524+  5A3B F1                   pop     af
1525+  5A3C             
1526+  5A3C             hitmonst:
1527+  5A3C E6 01                and 0x01           ; gold or small potion
1528+  5A3E C6 0B                add a,11
1529+  5A40             
1530+  5A40                      ;
1531+  5A40                      ;
1532+  5A40             
1533+  5A40             ; ----- draw char a at y,x
1534+  5A40              
1535+  5A40             drawchar:
1536+  5A40 F5                   push af
1537+  5A41 CD E2 57             call locate
1538+  5A44 DD 77 0A             ld (ix+underman),a
1539+  5A47 F1                   pop af
1540+  5A48             
1541+  5A48 E5                   push hl
1542+  5A49 21 A0 5A             ld hl,objchar
1543+  5A4C 16 00                ld d,0
1544+  5A4E 5F                   ld e,a
1545+  5A4F 19                   add hl,de
1546+  5A50 7E                   ld a,(hl)
1547+  5A51 E1                   pop hl
1548+  5A52                      ;
1549+  5A52                      ;
1550+  5A52             ; ----- draw character and colorize if in visible (visited) area
1551+  5A52             
1552+  5A52             drawshaded:
1553+  5A52 E5                   push hl
1554+  5A53 16 00                ld d,0
1555+  5A55 5D                   ld e,l
1556+  5A56                      ld hl,(ix+scr)
1556+  5A56 DD6E1BDD661C
1557+  5A5C 19                   add hl,de
1558+  5A5D 77                   ld (hl),a
1559+  5A5E                      ld hl,(ix+color)
1559+  5A5E DD6E1DDD661E
1560+  5A64 19                   add hl,de
1561+  5A65 EB                   ex de,hl
1562+  5A66 E1                   pop hl
1563+  5A67             
1564+  5A67 4F                   ld c,a
1565+  5A68 1A                   ld a,(de)
1566+  5A69 A7                   and a
1567+  5A6A C8                   ret z ; plot only if in visible area
1568+  5A6B             
1569+  5A6B 79                   ld a,c
1570+  5A6C 12                   ld (de),a
1571+  5A6D C9                   ret
1572+  5A6E             ;
1573+  5A6E             ;----- action jump table
1574+  5A6E             
1575+  5A6E             actionlist:
1576+  5A6E DF 58                dw walk        ; floor
1577+  5A70 E5 58                dw blocked     ; wall
1578+  5A72 77 59                dw getamulet   ; get amulet
1579+  5A74 F1 59                dw opendoor    ; door
1580+  5A76 BC 58                dw stairdown   ; staircase down
1581+  5A78 2D 58                dw stairup     ; staircase up
1582+  5A7A 28 5A                dw hitbatgob   ; hit monster (bat)
1583+  5A7C 28 5A                dw hitbatgob   ; hit monster (goblin)
1584+  5A7E 12 5A                dw hitdragon   ; hit monster (dragon)
1585+  5A80 FC 59                dw hitghost    ; hit monster (ghost)
1586+  5A82 E6 58                dw hitchest    ; hit chest (no AC)
1587+  5A84 CD 59                dw pickgold    ; pick gold
1588+  5A86             
1589+  5A86 91 59                dw pickpotion0 ; pick potion
1590+  5A88 9D 59                dw pickpotion1 ; pick potion
1591+  5A8A A9 59                dw pickpotion2 ; pick potion
1592+  5A8C B5 59                dw pickpotion3 ; pick potion
1593+  5A8E             
1594+  5A8E 25 59                dw pickweapon0
1595+  5A90 2A 59                dw pickweapon1
1596+  5A92 2F 59                dw pickweapon2
1597+  5A94 34 59                dw pickweapon3
1598+  5A96             
1599+  5A96 4E 59                dw pickshield0
1600+  5A98 53 59                dw pickshield1
1601+  5A9A 58 59                dw pickshield2
1602+  5A9C 5D 59                dw pickshield3
1603+  5A9E 00 00                dw 0        ; placeholder
1604+  5AA0             
1605+  5AA0             
1606+  5AA0             
1607+  5AA0             ;----- objects
1608+  5AA0             
1609+  5AA0             objchar:
1610+  5AA0 20                  db floorchr   ; 0 floor
1611+  5AA1 03                  db wallchr    ; 1 wall
1612+  5AA2 2B                  db amuletchr  ; 2 amulet
1613+  5AA3 24                  db doorchr    ; 3 door
1614+  5AA4 23                  db downchr    ; 4 staircase down
1615+  5AA5 22                  db upchr      ; 5 staircase up
1616+  5AA6 60                  db batchr     ; 6 bat
1617+  5AA7 62                  db goblinchr  ; 7 goblin
1618+  5AA8 6A                  db dragonchr  ; 8 dragon
1619+  5AA9 72                  db ghostchr   ; 9 ghost
1620+  5AAA 26                  db chestchr   ; 10 chest
1621+  5AAB 28                  db goldchr    ; 11 gold
1622+  5AAC             
1623+  5AAC 27                  db potion0chr ; 12 potion
1624+  5AAD 2D                  db potion1chr ; 13 potion
1625+  5AAE 2E                  db potion2chr ; 14 potion
1626+  5AAF 27                  db potion3chr ; 15 potion
1627+  5AB0             
1628+  5AB0 29                  db sword0chr  ; 16 small sword
1629+  5AB1 31                  db sword1chr  ; 17 small sword
1630+  5AB2 30                  db sword2chr  ; 18 small sword
1631+  5AB3 29                  db sword3chr  ; 19 small sword
1632+  5AB4             
1633+  5AB4 2A                  db shield0chr ; 20 small shield
1634+  5AB5 32                  db shield1chr ; 21 small shield
1635+  5AB6 33                  db shield2chr ; 22 small shield
1636+  5AB7 2A                  db shield3chr ; 23 small shield
1637+  5AB8             
1638+  5AB8 40                  db manchr     ; 24 man
1639+  5AB9             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1640+  5AB9             
1641+  5AB9             
1642+  5AB9             
1643+  5AB9             _3dview:
1644+  5AB9             
1645+  5AB9             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1646+  5AB9             ;   render 3d maze
1647+  5AB9             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1648+  5AB9             
1649+  5AB9 DD 21 1B C9         ld ix,hidden + MAPW
1650+  5ABD FD 21 1B CD         ld iy,visible + MAPW
1651+  5AC1 11 03 C1            ld de,buffer
1652+  5AC4             
1653+  5AC4 01 40 02            ld bc,MAPH*MAPW
1654+  5AC7             
1655+  5AC7             1:
1656+  5AC7 FD 7E 00            ld a,(iy+0)
1657+  5ACA FE 20               cp floorchr
1658+  5ACC CA 6B 5B            jp z,_rule5
1659+  5ACF FE 03               cp wallchr
1660+  5AD1 CA 7B 5B            jp z,_rule1234
1661+  5AD4 FE 24               cp doorchr
1662+  5AD6 CA 4C 5B            jp z,_doorrule
1663+  5AD9             
1664+  5AD9             
1665+  5AD9             exit
1666+  5AD9 12                  ld (de),a
1667+  5ADA DD 23               inc ix
1668+  5ADC FD 23               inc iy
1669+  5ADE 13                  inc de
1670+  5ADF 0B                  dec bc
1671+  5AE0 78                  ld a,b
1672+  5AE1 B1                  or c
1673+  5AE2 C2 C7 5A            jp nz,1b
1674+  5AE5             
1675+  5AE5             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1676+  5AE5             
1677+  5AE5 DD 21 03 C0         ld ix,PAGE0
1678+  5AE9             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1679+  5AE9             ;   2 frame animations
1680+  5AE9             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1681+  5AE9             
1682+  5AE9 11 03 C1             ld  de,buffer
1683+  5AEC 06 18                ld  b,MAPH
1684+  5AEE 0E 18       2:       ld  c,MAPW
1685+  5AF0             1:
1686+  5AF0 1A                   ld  a,(de)
1687+  5AF1 FE 40                cp  manchr
1688+  5AF3 28 24                jr  z,dispman
1689+  5AF5             
1690+  5AF5 FE 6A                cp dragonchr
1691+  5AF7 CA 2C 5B             jp z,dispmon
1692+  5AFA             
1693+  5AFA FE 62                cp goblinchr
1694+  5AFC CA 2C 5B             jp z,dispmon
1695+  5AFF             
1696+  5AFF FE 72                cp ghostchr
1697+  5B01 CA 2C 5B             jp z,dispmon
1698+  5B04             
1699+  5B04 FE 60                cp batchr
1700+  5B06 C2 11 5B             jp nz,noanim
1701+  5B09             
1702+  5B09             3:
1703+  5B09 67                   ld  h,a
1704+  5B0A DD 7E 16             ld  a,(ix+flip)
1705+  5B0D E6 01                and 1
1706+  5B0F B4                   or  h
1707+  5B10 12                   ld (de),a
1708+  5B11             noanim
1709+  5B11             
1710+  5B11 13                   inc de
1711+  5B12 0D                   dec c
1712+  5B13 C2 F0 5A             jp nz,1b
1713+  5B16 10 D6                djnz  2b
1714+  5B18             
1715+  5B18             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1716+  5B18 C9                   ret
1717+  5B19             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1718+  5B19             ;   man animations
1719+  5B19             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1720+  5B19             dispman:
1721+  5B19             
1722+  5B19 3E 27               ld  a,tabaniman & 255
1723+  5B1B DD 86 0E            add a,(ix+mandir)
1724+  5B1E 6F                  ld  l,a
1725+  5B1F 3E 5B               ld  a,tabaniman / 256
1726+  5B21 CE 00               adc a,0
1727+  5B23 67                  ld  h,a
1728+  5B24 7E                  ld  a,(hl)
1729+  5B25 18 E2               jr  3b
1730+  5B27             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1731+  5B27             tabaniman
1732+  5B27 4440444240          db 68,64,68,66,64
1733+  5B2C             
1734+  5B2C             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1735+  5B2C             ;   monster animations
1736+  5B2C             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1737+  5B2C             dispmon:
1738+  5B2C 3E 18               ld	a,MAPW
1739+  5B2E 91                  sub a,c
1740+  5B2F DD BE 06            cp (ix+manx)
1741+  5B32             
1742+  5B32 28 0A               jr  z,tesv
1743+  5B34             
1744+  5B34 3E 02               ld a,2                          ; set right/left
1745+  5B36 38 01               jr  c,999f
1746+  5B38 AF                  xor a
1747+  5B39             
1748+  5B39 EB          999:    ex  de,hl
1749+  5B3A 86                  add a,(hl)
1750+  5B3B EB                  ex  de,hl
1751+  5B3C 18 CB               jr  3b
1752+  5B3E             
1753+  5B3E 3E 18       tesv    ld	a,MAPH
1754+  5B40 90                  sub a,b
1755+  5B41 DD BE 07            cp (ix+many)
1756+  5B44 3E 04               ld  a,4                         ; set up/down
1757+  5B46 38 F1               jr  c,999b
1758+  5B48 3E 06               ld  a,6
1759+  5B4A 18 ED               jr  999b
1760+  5B4C                     
1761+  5B4C                     
1762+  5B4C             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1763+  5B4C             _doorrule
1764+  5B4C DD 7E E8            ld  a,(ix-MAPW)
1765+  5B4F FE 03               cp  wallchr
1766+  5B51 3E 24               ld  a,doorchr
1767+  5B53 C2 D9 5A            jp  nz,exit
1768+  5B56 DD 7E 18            ld  a,(ix+MAPW)
1769+  5B59 FE 03               cp  wallchr
1770+  5B5B 3E 24               ld  a,doorchr        
1771+  5B5D C2 D9 5A            jp  nz,exit
1772+  5B60 21 E8 FF            ld  hl,-MAPW
1773+  5B63 19                  add hl,de
1774+  5B64 36 03               ld  (hl),wallchr
1775+  5B66 3E 25               ld  a,doorchr+1
1776+  5B68 C3 D9 5A            jp  exit
1777+  5B6B             
1778+  5B6B             
1779+  5B6B             _rule5
1780+  5B6B DD 7E FF            ld  a,(ix+-1)
1781+  5B6E FE 03               cp  wallchr
1782+  5B70 FD 7E 00            ld  a,(iy+0)
1783+  5B73 C2 D9 5A            jp  nz,exit
1784+  5B76 3E 21               ld  a,33        ; shadowed floor
1785+  5B78 C3 D9 5A            jp  exit
1786+  5B7B             
1787+  5B7B             _rule1234
1788+  5B7B DD 7E 18            ld  a,(ix+MAPW)
1789+  5B7E FE 03               cp  wallchr
1790+  5B80 CA AD 5B            jp  z,_rule34
1791+  5B83                     
1792+  5B83             _rule12
1793+  5B83 DD 7E E8            ld  a,(ix-MAPW)
1794+  5B86 FE 03               cp  wallchr
1795+  5B88 CA 90 5B            jp  z,_rule2
1796+  5B8B             
1797+  5B8B             _rule1
1798+  5B8B 3E 02               ld  a,2
1799+  5B8D C3 D9 5A            jp  exit
1800+  5B90             
1801+  5B90 DD 7E D0    _rule2  ld   a,(ix-2*MAPW)
1802+  5B93 FE 03               cp  wallchr
1803+  5B95 20 0B               jr  nz,1f
1804+  5B97 21 E8 FF            ld hl,-MAPW
1805+  5B9A 19                  add hl,de
1806+  5B9B 36 03               ld (hl),wallchr
1807+  5B9D 3E 01               ld a,1
1808+  5B9F C3 D9 5A            jp exit
1809+  5BA2             
1810+  5BA2 21 E8 FF    1:      ld hl,-MAPW
1811+  5BA5 19                  add hl,de
1812+  5BA6 36 05               ld (hl),5
1813+  5BA8 3E 01               ld a,1
1814+  5BAA C3 D9 5A            jp exit
1815+  5BAD                    
1816+  5BAD             _rule34
1817+  5BAD DD 7E E8            ld a,(ix-MAPW)
1818+  5BB0 FE 03               cp wallchr
1819+  5BB2 CA BA 5B            jp z,_rule4
1820+  5BB5             
1821+  5BB5 3E 05               ld a,5          ; rule3
1822+  5BB7 C3 D9 5A            jp exit
1823+  5BBA             
1824+  5BBA             _rule4
1825+  5BBA 3E 03               ld a,wallchr
1826+  5BBC C3 D9 5A            jp exit
1827+  5BBF             
1828+  5BBF             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1829+  5BBF             
1830+  5BBF             startgametext:
1831+  5BBF             ; show text. start at pos 5,6
1832+  5BBF             ;DESCEND THE ANCIENT
1833+  5BBF                   db 68+127, 69+127, 83+127, 67+127, 69+127, 78+127, 68+127, 255,    84+127, 72+127, 69+127, 255,    65+127, 78+127, 67+127, 73+127, 69+127, 78+127, 84+127, 255,255,255,255
1833+  5BBF C3C4D2C2C4CDC3FFD3C7C4FFC0CDC2C8C4CDD3FFFFFFFF
1834+  5BD6             ;STAIRWAYS OF THE DEEP
1835+  5BD6                   db 83+127, 84+127, 65+127, 73+127, 82+127, 87+127, 65+127, 89+127, 83+127, 255, 79+127, 70+127, 255,    84+127, 72+127, 69+127, 255,    68+127, 69+127, 69+127, 80+127,255,255
1835+  5BD6 D2D3C0C8D1D6C0D8D2FFCEC5FFD3C7C4FFC3C4C4CFFFFF
1836+  5BED             ;DUNGEON!
1837+  5BED                   db 68+127, 85+127, 78+127, 71+127, 69+127, 79+127, 78+127,  248
1837+  5BED C3D4CDC6C4CECDF8
1838+  5BF5             
1839+  5BF5                 rept 23+15
1840+  5BF5~                db 255
1841+  5BF5                 endm
1841+  5BF5 FF          >    db 255
1841+  5BF6 FF          >    db 255
1841+  5BF7 FF          >    db 255
1841+  5BF8 FF          >    db 255
1841+  5BF9 FF          >    db 255
1841+  5BFA FF          >    db 255
1841+  5BFB FF          >    db 255
1841+  5BFC FF          >    db 255
1841+  5BFD FF          >    db 255
1841+  5BFE FF          >    db 255
1841+  5BFF FF          >    db 255
1841+  5C00 FF          >    db 255
1841+  5C01 FF          >    db 255
1841+  5C02 FF          >    db 255
1841+  5C03 FF          >    db 255
1841+  5C04 FF          >    db 255
1841+  5C05 FF          >    db 255
1841+  5C06 FF          >    db 255
1841+  5C07 FF          >    db 255
1841+  5C08 FF          >    db 255
1841+  5C09 FF          >    db 255
1841+  5C0A FF          >    db 255
1841+  5C0B FF          >    db 255
1841+  5C0C FF          >    db 255
1841+  5C0D FF          >    db 255
1841+  5C0E FF          >    db 255
1841+  5C0F FF          >    db 255
1841+  5C10 FF          >    db 255
1841+  5C11 FF          >    db 255
1841+  5C12 FF          >    db 255
1841+  5C13 FF          >    db 255
1841+  5C14 FF          >    db 255
1841+  5C15 FF          >    db 255
1841+  5C16 FF          >    db 255
1841+  5C17 FF          >    db 255
1841+  5C18 FF          >    db 255
1841+  5C19 FF          >    db 255
1841+  5C1A FF          >    db 255
1842+  5C1B             
1843+  5C1B             ;RETRIEVE THE AMULET TO
1844+  5C1B                   db 82+127, 69+127, 84+127, 82+127, 73+127, 69+127, 86+127, 69+127, 255, 84+127, 72+127, 69+127, 255, 65+127, 77+127, 85+127, 76+127, 69+127, 84+127, 255, 84+127, 79+127,255
1844+  5C1B D1C4D3D1C8C4D5C4FFD3C7C4FFC0CCD4CBC4D3FFD3CEFF
1845+  5C32             ;LIFT THE WIZARD'S SPELL
1846+  5C32                   db 76+127, 73+127, 70+127, 84+127, 255, 84+127, 72+127, 69+127, 255, 87+127, 73+127, 90+127, 65+127, 82+127, 68+127, 251,'S'+127, 255, 'S'+127, 'P'+127, 'E'+127, 'L'+127, 'L'+127
1846+  5C32 CBC8C5D3FFD3C7C4FFD6C8D9C0D1C3FBD2FFD2CFC4CBCB
1847+  5C49             ;AND CLAIM YOUR RIGHTFUL
1848+  5C49                   db 65+127, 78+127, 68+127, 255, 67+127, 76+127, 65+127, 73+127, 77+127, 255, 89+127, 79+127, 85+127, 82+127, 255, 82+127, 73+127, 71+127, 72+127, 84+127, 70+127, 85+127, 76+127
1848+  5C49 C0CDC3FFC2CBC0C8CCFFD8CED4D1FFD1C8C6C7D3C5D4CB
1849+  5C60             ;PLACE ON THE THRONE!
1850+  5C60                   db 80+127, 76+127, 65+127, 67+127, 69+127, 255, 79+127, 78+127, 255, 84+127, 72+127, 69+127, 255, 84+127, 72+127, 82+127, 79+127, 78+127, 69+127, 248,255,255,255
1850+  5C60 CFCBC0C2C4FFCECDFFD3C7C4FFD3C7D1CECDC4F8FFFFFF
1851+  5C77             
1852+  5C77             f4message:
1853+  5C77                   db  'P'+127,'R'+127,'E'+127,'S'+127,'S'+127,255,'F'+127,23,255,'T'+127,'O'+127,255,'I'+127,'N'+127,'P'+127,'U'+127,'T'+127,255,'A'+127,255,'C'+127,'U'+127,'S'+127,'T'+127,'O'+127,'M'+127,255,'S'+127,'E'+127,'E'+127,'D'+127
1853+  5C77 CFD1C4D2D2FFC517FFD3CEFFC8CDCFD4D3FFC0FFC2D4D2D3CECCFFD2C4C4C3
1854+  5C96             
1855+  5C96             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1856+  5C96             
1857+  5C96             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1858+  5C96             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1859+  5C96             
1860+  5C96             init_video:
1861+  5C96             
1862+  5C96 21 84 BA    		ld	hl,MUSIC6			; hl <- initial address of module 
1863+  5C99 CD CF A0    		call	PT3_INIT			; Inits PT3 player
1864+  5C9C             
1865+  5C9C CD 41 00            call disscr
1866+  5C9F             
1867+  5C9F CD 7E 76            call _nosprt
1868+  5CA2             
1869+  5CA2 CD 57 5D            call cls
1870+  5CA5             
1871+  5CA5 21 BF 7F            ld hl,ddpatterns
1872+  5CA8 11 00 00            ld de,0x0000
1873+  5CAB CD 72 5D            call    out2k
1874+  5CAE 21 0B 7D            ld hl,ddcolors
1875+  5CB1 11 00 20            ld de,0x2000
1876+  5CB4 CD 72 5D            call    out2k
1877+  5CB7             
1878+  5CB7 21 BF 7F            ld hl,ddpatterns
1879+  5CBA 11 00 08            ld de,0x0000+256*8
1880+  5CBD CD 72 5D            call    out2k
1881+  5CC0 21 0B 7D            ld hl,ddcolors
1882+  5CC3 11 00 28            ld de,0x2000+256*8
1883+  5CC6 CD 72 5D            call    out2k
1884+  5CC9             
1885+  5CC9 CD 44 00            call    enascr
1886+  5CCC             
1887+  5CCC CD 50 51            call    setdiff
1888+  5CCF             
1889+  5CCF 11 BF 5B            ld      de,startgametext
1890+  5CD2 21 A5 18            ld      hl,0x1800+5*32+5
1891+  5CD5 06 08               ld      b,8
1892+  5CD7 3E 17               ld      a,23
1893+  5CD9 CD 69 73            call    _printtext
1894+  5CDC             
1895+  5CDC             
1896+  5CDC 06 1E       	    ld	b,30
1897+  5CDE 76          1:      halt
1898+  5CDF 10 FD               djnz    1b
1899+  5CE1             
1900+  5CE1 06 E6               ld      b,230
1901+  5CE3 76          1:      halt
1902+  5CE4 CD AB 7A            call _joy
1903+  5CE7 E6 10               and    00010000B
1904+  5CE9 28 0A               jr     z,1f
1905+  5CEB             
1906+  5CEB             
1907+  5CEB 3E 08               ld      a,8
1908+  5CED CD 41 01            call    0x0141 ; getin startgame
1909+  5CF0 3C                  inc     a
1910+  5CF1 20 02               jr      nz,1f
1911+  5CF3 10 EE               djnz    1b
1912+  5CF5             1:
1913+  5CF5             
1914+  5CF5             drawlogo:
1915+  5CF5             
1916+  5CF5             ; - clean message
1917+  5CF5             
1918+  5CF5 CD 57 5D             call cls
1919+  5CF8             
1920+  5CF8             ; - logo in the sidebar
1921+  5CF8             
1922+  5CF8 21 38 18             ld hl,0x1820+24
1923+  5CFB CD 53 00             call setwrt
1924+  5CFE 21 85 77             ld hl,logo
1925+  5D01 01 98 08             ld bc,8*256+0x98
1926+  5D04 CD 82 7B             call slowotir
1927+  5D07 21 58 18             ld hl,0x1840+24
1928+  5D0A CD 53 00             call setwrt
1929+  5D0D 21 8D 77             ld hl,logo+8
1930+  5D10 01 98 08             ld bc,8*256+0x98
1931+  5D13 CD 82 7B             call slowotir
1932+  5D16 21 78 18             ld hl,0x1860+24
1933+  5D19 CD 53 00             call setwrt
1934+  5D1C 21 95 77             ld hl,logo+16
1935+  5D1F 01 98 08             ld bc,8*256+0x98
1936+  5D22 CD 82 7B             call slowotir
1937+  5D25                      
1938+  5D25             ; - deepth indicator         
1939+  5D25 11 20 00             ld de,32
1940+  5D28                      
1941+  5D28 21 BC 19             ld     hl,0x1980+28+32
1942+  5D2B CD 53 00             call setwrt
1943+  5D2E 3E 22                ld     a,34
1944+  5D30 D3 98                out    (0x98),a
1945+  5D32 19                   add    hl,de
1946+  5D33 CD 53 00             call setwrt
1947+  5D36 3E 4C                ld     a,76
1948+  5D38 D3 98                out    (0x98),a
1949+  5D3A                      
1950+  5D3A 06 03                ld     b,3
1951+  5D3C 19          1:       add    hl,de
1952+  5D3D CD 53 00             call setwrt
1953+  5D40 3E 4D                ld     a,77
1954+  5D42 D3 98                out    (0x98),a
1955+  5D44 10 F6                djnz   1b
1956+  5D46             
1957+  5D46 19                   add    hl,de
1958+  5D47 CD 53 00             call setwrt
1959+  5D4A 3E 4E                ld     a,78
1960+  5D4C D3 98                out    (0x98),a
1961+  5D4E             
1962+  5D4E 19                   add    hl,de
1963+  5D4F CD 53 00             call setwrt
1964+  5D52 3E 2B                ld     a,43
1965+  5D54 D3 98                out    (0x98),a
1966+  5D56             
1967+  5D56 C9                   ret
1968+  5D57             
1969+  5D57             ; - clean screen
1970+  5D57             cls:
1971+  5D57 21 00 18            ld hl,0x1800
1972+  5D5A CD 53 00            call setwrt
1973+  5D5D AF                  xor a
1974+  5D5E 47                  ld  b,a
1975+  5D5F                     rept    3
1976+  5D5F~            1:      out (0x98),a
1977+  5D5F~                    nop
1978+  5D5F~                    and a
1979+  5D5F~                    djnz    1b
1980+  5D5F                     endm
1980+  5D5F D3 98       >1:      out (0x98),a
1980+  5D61 00          >        nop
1980+  5D62 A7          >        and a
1980+  5D63 10 FA       >        djnz    1b
1980+  5D65 D3 98       >1:      out (0x98),a
1980+  5D67 00          >        nop
1980+  5D68 A7          >        and a
1980+  5D69 10 FA       >        djnz    1b
1980+  5D6B D3 98       >1:      out (0x98),a
1980+  5D6D 00          >        nop
1980+  5D6E A7          >        and a
1980+  5D6F 10 FA       >        djnz    1b
1981+  5D71 C9                  ret
1982+  5D72             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
1983+  5D72             ;
1984+  5D72             ;   in:
1985+  5D72             ;       de = vram addreess
1986+  5D72             ;       hl = compressed data
1987+  5D72             ;
1988+  5D72             out2k:
1989+  5D72 D5                  push    de
1990+  5D73 11 03 C1            ld de,buffer
1991+  5D76 CD FD 9F            call miz._unpack
1992+  5D79 E1                  pop     hl
1993+  5D7A             
1994+  5D7A CD 53 00            call setwrt
1995+  5D7D             _out2k: 
1996+  5D7D 21 03 C1            ld hl,buffer
1997+  5D80 01 98 00            ld bc,0x98
1998+  5D83             _out2k2:rept 8
1999+  5D83~                        otir
2000+  5D83                     endm
2000+  5D83 ED B3       >            otir
2000+  5D85 ED B3       >            otir
2000+  5D87 ED B3       >            otir
2000+  5D89 ED B3       >            otir
2000+  5D8B ED B3       >            otir
2000+  5D8D ED B3       >            otir
2000+  5D8F ED B3       >            otir
2000+  5D91 ED B3       >            otir
2001+  5D93 C9                  ret
2002+  5D94             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
2003+  5D94             ;   endsequence
2004+  5D94             ;
2005+  5D94                     include ending.asm
0001++ 5D94             spritemaskend:
0002++ 5D94 17 60 30 01         db 24-1, 96,12*4,1
0003++ 5D98 27 60 34 01         db 40-1, 96,13*4,1
0004++ 5D9C 17 70 38 01         db 24-1,112,14*4,1
0005++ 5DA0 5F 10 3C 01         db 96-1, 16,15*4,1
0006++ 5DA4                     
0007++ 5DA4 77 10 40 01         db 120-1,16,16*4,1
0008++ 5DA8 57 20 44 01         db 88-1, 32,17*4,1
0009++ 5DAC 67 20 48 01         db 104-1,32,18*4,1
0010++ 5DB0 77 20 4C 01         db 128-1-8,32,19*4,1
0011++ 5DB4                     
0012++ 5DB4 8F 20 50 01         db 144-1,32,20*4,1
0013++ 5DB8 67 58 54 01         db 104-1,88,21*4,1
0014++ 5DBC 6F505801D0          db 112-1,80,22*4,1        ,0xD0
0015++ 5DC1             
0016++ 5DC1             goodendtext1:
0017++ 5DC1             ; show text. start at pos 7,16
0018++ 5DC1             ;QUEST ACCOMPLISHED, 
0019++ 5DC1                   db 81+127, 85+127, 69+127, 83+127, 84+127, 255, 65+127, 67+127, 67+127, 79+127, 77+127, 80+127, 76+127, 73+127, 83+127, 72+127, 69+127, 68+127, 247 
0019++ 5DC1 D0D4C4D2D3FFC0C2C2CECCCFCBC8D2C7C4C3F7
0020++ 5DD4             ;YOU MADE IT!
0021++ 5DD4                   db 89+127, 79+127, 85+127, 255   , 77+127, 65+127, 68+127, 69+127, 255, 73+127, 84+127, 249,255,255,255,255,255,255,255
0021++ 5DD4 D8CED4FFCCC0C3C4FFC8D3F9FFFFFFFFFFFFFF
0022++ 5DE7             
0023++ 5DE7             ; wait some time
0024++ 5DE7             ; clear text
0025++ 5DE7             
0026++ 5DE7             goodendtext2:
0027++ 5DE7             ; show text at 4,16
0028++ 5DE7             ;HASTELY, YOU MAKE YOUR WAY
0029++ 5DE7                   db 72+127, 65+127, 83+127, 84+127, 69+127, 76+127, 89+127, 247, 255, 89+127, 79+127, 85+127, 255, 77+127, 65+127, 75+127, 69+127, 255, 89+127, 79+127, 85+127, 82+127, 255, 87+127, 65+127, 89+127
0029++ 5DE7 C7C0D2D3C4CBD8F7FFD8CED4FFCCC0CAC4FFD8CED4D1FFD6C0D8
0030++ 5E01             ;BACK OUTSIDE, CHASED BY A 
0031++ 5E01                   db 66+127, 65+127, 67+127, 75+127, 255, 79+127, 85+127, 84+127, 83+127, 73+127, 68+127, 69+127, 247, 255, 67+127, 72+127, 65+127, 83+127, 69+127, 68+127, 255, 66+127, 89+127, 255, 65+127,255
0031++ 5E01 C1C0C2CAFFCED4D3D2C8C3C4F7FFC2C7C0D2C4C3FFC1D8FFC0FF
0032++ 5E1B             ;FIERCE HORDE OF YOUR     
0033++ 5E1B                   db 70+127, 73+127, 69+127, 82+127, 67+127, 69+127, 255, 72+127, 79+127, 82+127, 68+127, 69+127, 255, 79+127, 70+127, 255, 89+127, 79+127, 85+127, 82+127,255,255,255,255,255,255
0033++ 5E1B C5C8C4D1C2C4FFC7CED1C3C4FFCEC5FFD8CED4D1FFFFFFFFFFFF
0034++ 5E35             ;ENEMIES.                 
0035++ 5E35                   db 69+127, 78+127, 69+127, 77+127, 73+127, 69+127, 83+127, 248
0035++ 5E35 C4CDC4CCC8C4D2F8
0036++ 5E3D                 rept 19
0037++ 5E3D~                    db 255
0038++ 5E3D                 endm
0038++ 5E3D FF          >        db 255
0038++ 5E3E FF          >        db 255
0038++ 5E3F FF          >        db 255
0038++ 5E40 FF          >        db 255
0038++ 5E41 FF          >        db 255
0038++ 5E42 FF          >        db 255
0038++ 5E43 FF          >        db 255
0038++ 5E44 FF          >        db 255
0038++ 5E45 FF          >        db 255
0038++ 5E46 FF          >        db 255
0038++ 5E47 FF          >        db 255
0038++ 5E48 FF          >        db 255
0038++ 5E49 FF          >        db 255
0038++ 5E4A FF          >        db 255
0038++ 5E4B FF          >        db 255
0038++ 5E4C FF          >        db 255
0038++ 5E4D FF          >        db 255
0038++ 5E4E FF          >        db 255
0038++ 5E4F FF          >        db 255
0039++ 5E50             
0040++ 5E50             goodendtext3:
0041++ 5E50             ; show text at 5,5
0042++ 5E50             ;YOU PASS THE GATE AND 
0043++ 5E50                   db 89+127, 79+127, 85+127, 255, 80+127, 65+127, 83+127, 83+127, 255, 84+127, 72+127, 69+127, 255, 71+127, 65+127, 84+127, 69+127, 255, 65+127, 78+127, 68+127,255
0043++ 5E50 D8CED4FFCFC0D2D2FFD3C7C4FFC6C0D3C4FFC0CDC3FF
0044++ 5E66             ;LEAVE THE DEEP DUNGEON
0045++ 5E66                   db 76+127, 69+127, 65+127, 86+127, 69+127, 255, 84+127, 72+127, 69+127, 255, 68+127, 69+127, 69+127, 80+127, 255, 68+127, 85+127, 78+127, 71+127, 69+127, 79+127, 78+127 
0045++ 5E66 CBC4C0D5C4FFD3C7C4FFC3C4C4CFFFC3D4CDC6C4CECD
0046++ 5E7C             ;FOREVER.              
0047++ 5E7C                   db 70+127, 79+127, 82+127, 69+127, 86+127, 69+127, 82+127, 248
0047++ 5E7C C5CED1C4D5C4D1F8
0048++ 5E84             ; skip a line
0049++ 5E84                 rept 14+22
0050++ 5E84~                    db 255
0051++ 5E84                 endm
0051++ 5E84 FF          >        db 255
0051++ 5E85 FF          >        db 255
0051++ 5E86 FF          >        db 255
0051++ 5E87 FF          >        db 255
0051++ 5E88 FF          >        db 255
0051++ 5E89 FF          >        db 255
0051++ 5E8A FF          >        db 255
0051++ 5E8B FF          >        db 255
0051++ 5E8C FF          >        db 255
0051++ 5E8D FF          >        db 255
0051++ 5E8E FF          >        db 255
0051++ 5E8F FF          >        db 255
0051++ 5E90 FF          >        db 255
0051++ 5E91 FF          >        db 255
0051++ 5E92 FF          >        db 255
0051++ 5E93 FF          >        db 255
0051++ 5E94 FF          >        db 255
0051++ 5E95 FF          >        db 255
0051++ 5E96 FF          >        db 255
0051++ 5E97 FF          >        db 255
0051++ 5E98 FF          >        db 255
0051++ 5E99 FF          >        db 255
0051++ 5E9A FF          >        db 255
0051++ 5E9B FF          >        db 255
0051++ 5E9C FF          >        db 255
0051++ 5E9D FF          >        db 255
0051++ 5E9E FF          >        db 255
0051++ 5E9F FF          >        db 255
0051++ 5EA0 FF          >        db 255
0051++ 5EA1 FF          >        db 255
0051++ 5EA2 FF          >        db 255
0051++ 5EA3 FF          >        db 255
0051++ 5EA4 FF          >        db 255
0051++ 5EA5 FF          >        db 255
0051++ 5EA6 FF          >        db 255
0051++ 5EA7 FF          >        db 255
0052++ 5EA8             ;TOWARDS THE NIGHT, YOU
0053++ 5EA8                   db 84+127, 79+127, 87+127, 65+127, 82+127, 68+127, 83+127, 255, 84+127, 72+127, 69+127, 255, 78+127, 200, 71+127, 72+127, 84+127, 247, 255, 89+127, 79+127, 85+127
0053++ 5EA8 D3CED6C0D1C3D2FFD3C7C4FFCDC8C6C7D3F7FFD8CED4
0054++ 5EBE             ;RUN TO FREEDOM, FIRMLY 
0055++ 5EBE                   db 82+127, 85+127, 78+127, 255, 84+127, 79+127, 255, 70+127, 82+127, 69+127, 69+127, 68+127, 79+127, 77+127, 247, 255, 70+127, 73+127, 82+127, 77+127, 76+127, 89+127 
0055++ 5EBE D1D4CDFFD3CEFFC5D1C4C4C3CECCF7FFC5C8D1CCCBD8
0056++ 5ED4             ;CLENCHING THE AMULET 
0057++ 5ED4                   db 67+127, 76+127, 69+127, 78+127, 67+127, 72+127, 73+127, 78+127, 71+127, 255, 84+127, 72+127, 69+127, 255, 65+127, 77+127, 85+127, 76+127, 69+127, 84+127,255,255
0057++ 5ED4 C2CBC4CDC2C7C8CDC6FFD3C7C4FFC0CCD4CBC4D3FFFF
0058++ 5EEA             ;IN YOUR FIST.        
0059++ 5EEA                   db 73+127, 78+127, 255, 89+127, 79+127, 85+127, 82+127, 255, 70+127, 73+127, 83+127, 84+127, 248
0059++ 5EEA C8CDFFD8CED4D1FFC5C8D2D3F8
0060++ 5EF7                 rept 9
0061++ 5EF7~                    db 255
0062++ 5EF7                 endm
0062++ 5EF7 FF          >        db 255
0062++ 5EF8 FF          >        db 255
0062++ 5EF9 FF          >        db 255
0062++ 5EFA FF          >        db 255
0062++ 5EFB FF          >        db 255
0062++ 5EFC FF          >        db 255
0062++ 5EFD FF          >        db 255
0062++ 5EFE FF          >        db 255
0062++ 5EFF FF          >        db 255
0063++ 5F00             
0064++ 5F00             out6k:
0065++ 5F00 F3          		di
0066++ 5F01 D5                  push    de
0067++ 5F02 11 00 C0            ld 		de,0xc000
0068++ 5F05 CD FD 9F            call 	miz._unpack
0069++ 5F08 E1                  pop     hl
0070++ 5F09 CD 53 00            call 	setwrt
0071++ 5F0C             
0072++ 5F0C 21 00 C0            ld hl,0xc000
0073++ 5F0F 01 98 00            ld bc,0x98
0074++ 5F12 3E 18       		ld	a,8*3
0075++ 5F14 ED B3       1:      otir
0076++ 5F16 3D                  dec	a
0077++ 5F17 20 FB       		jr	nz,1b
0078++ 5F19 FB          		ei
0079++ 5F1A C9                  ret	
0080++ 5F1B             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0081++ 5F1B             endsequence:
0082++ 5F1B             goodend:
0083++ 5F1B             
0084++ 5F1B             ; no need to load tilesets
0085++ 5F1B             ;[silence]
0086++ 5F1B             
0087++ 5F1B F3                  di
0088++ 5F1C 21 84 BA    		ld	hl,MUSIC6			; hl <- initial address of module 
0089++ 5F1F CD CF A0    		call	PT3_INIT			; Inits PT3 player
0090++ 5F22             
0091++ 5F22 CD 41 00            call    disscr
0092++ 5F25                     
0093++ 5F25 CD 57 5D            call cls
0094++ 5F28             
0095++ 5F28                    
0096++ 5F28             ; show sprite 6 at 104,64 and sprite 7 at 104,80 and sprite 8 at 104,96
0097++ 5F28             ; shpw sprite 9 at 144,64 and sprite 10 at 144,80 and sprite 11 at 144,96
0098++ 5F28             
0099++ 5F28 21 00 1B            ld hl,0x1b00
0100++ 5F2B CD 53 00            call setwrt
0101++ 5F2E             
0102++ 5F2E 21 5C 74            ld   hl,spritemask3
0103++ 5F31 01 98 19            ld   bc,(6*4+1)*256+0x98
0104++ 5F34 ED B3               otir
0105++ 5F36             
0106++ 5F36             
0107++ 5F36             ; show Exit start pos 11,6 (x,y) width 9 tiles and height 10
0108++ 5F36             
0109++ 5F36 11 4F 75            ld      de,exitpnt
0110++ 5F39 21 CB 18            ld      hl,0x1800+6*32+11
0111++ 5F3C 01 98 09            ld      bc,9*256+0x98
0112++ 5F3F             1:
0113++ 5F3F C5                  push    bc
0114++ 5F40             
0115++ 5F40 CD 53 00            call setwrt
0116++ 5F43             
0117++ 5F43 01 20 00            ld      bc,32
0118++ 5F46 09                  add     hl,bc
0119++ 5F47 E5                  push    hl
0120++ 5F48             
0121++ 5F48 EB                  ex      de,hl
0122++ 5F49 01 98 09            ld      bc,9*256+0x98
0123++ 5F4C ED B3               otir
0124++ 5F4E EB                  ex      de,hl
0125++ 5F4F             
0126++ 5F4F E1                  pop     hl
0127++ 5F50 C1                  pop     bc
0128++ 5F51 10 EC               djnz    1b
0129++ 5F53             
0130++ 5F53             
0131++ 5F53             ; Draw text 1
0132++ 5F53             ; show text. start at pos 6,16
0133++ 5F53             
0134++ 5F53 21 07 1A            ld      hl,0x1800+16*32+7
0135++ 5F56 11 C1 5D            ld      de,goodendtext1
0136++ 5F59 06 02               ld      b,2
0137++ 5F5B 3E 13               ld      a,19
0138++ 5F5D CD 55 73            call    printtext
0139++ 5F60             
0140++ 5F60 CD 44 00            call    enascr
0141++ 5F63             
0142++ 5F63 06 FA               ld  b,250
0143++ 5F65 76          1:      halt
0144++ 5F66 10 FD               djnz    1b        
0145++ 5F68                    
0146++ 5F68                     
0147++ 5F68              
0148++ 5F68             ; Draw text 2
0149++ 5F68             ; show text. start at pos 4,16
0150++ 5F68             
0151++ 5F68 21 04 1A            ld      hl,0x1800+16*32+4
0152++ 5F6B 11 E7 5D            ld      de,goodendtext2
0153++ 5F6E 06 04               ld      b,4
0154++ 5F70 3E 1A               ld      a,26
0155++ 5F72 CD 55 73            call    printtext
0156++ 5F75             
0157++ 5F75 06 FF               ld  b,255
0158++ 5F77 76          1:      halt
0159++ 5F78 10 FD               djnz    1b        
0160++ 5F7A 06 32               ld  b,50
0161++ 5F7C 76          1:      halt
0162++ 5F7D 10 FD               djnz    1b            
0163++ 5F7F CD 57 5D            call    cls
0164++ 5F82                     
0165++ 5F82             
0166++ 5F82 21 00 1B            ld hl,0x1b00
0167++ 5F85 CD 53 00            call setwrt
0168++ 5F88 3E D0               ld  a,0xD0
0169++ 5F8A D3 98               out (0x98),a
0170++ 5F8C                    
0171++ 5F8C             ; Draw text 3
0172++ 5F8C             ; show text. start at pos 5,5
0173++ 5F8C             
0174++ 5F8C 21 A5 18            ld      hl,0x1800+5*32+5
0175++ 5F8F 11 50 5E            ld      de,goodendtext3
0176++ 5F92 06 08               ld      b,8
0177++ 5F94 3E 16               ld      a,22
0178++ 5F96 CD 55 73            call    printtext
0179++ 5F99             
0180++ 5F99 06 FF               ld  b,255
0181++ 5F9B 76          1:      halt
0182++ 5F9C 10 FD               djnz    1b        
0183++ 5F9E 06 96               ld  b,150
0184++ 5FA0 76          1:      halt
0185++ 5FA1 10 FD               djnz    1b         
0186++ 5FA3                     
0187++ 5FA3             
0188++ 5FA3                     
0189++ 5FA3 3E 02               ld a,2
0190++ 5FA5 CD 5F 00            call 05Fh       ; screen 2
0191++ 5FA8             
0192++ 5FA8 CD 41 00            call    disscr
0193++ 5FAB              
0194++ 5FAB 21 00 18            ld hl,0x1800
0195++ 5FAE CD 53 00            call setwrt
0196++ 5FB1 06 00               ld  b,0
0197++ 5FB3 3E FF               ld  a,255
0198++ 5FB5 D3 98       1:      out (0x98),a
0199++ 5FB7 10 FC               djnz    1b
0200++ 5FB9 D3 98       1:      out (0x98),a
0201++ 5FBB 10 FC               djnz    1b
0202++ 5FBD D3 98       1:      out (0x98),a
0203++ 5FBF 10 FC               djnz    1b
0204++ 5FC1             
0205++ 5FC1                      ; ld hl,endpat123
0206++ 5FC1                      ; ld de,0x0000
0207++ 5FC1                      ; call    out6k
0208++ 5FC1             
0209++ 5FC1                      ; ld hl,endcol123
0210++ 5FC1                      ; ld de,0x2000
0211++ 5FC1                      ; call    out6k
0212++ 5FC1             		 
0213++ 5FC1             
0214++ 5FC1 21 34 96            ld hl,endpat123
0215++ 5FC4 11 00 00            ld de,0x0000
0216++ 5FC7 CD 00 5F            call    out6k
0217++ 5FCA             		
0218++ 5FCA 21 83 9C            ld hl,endcol123
0219++ 5FCD 11 00 20            ld de,0x2000
0220++ 5FD0 CD 00 5F            call    out6k
0221++ 5FD3             		
0222++ 5FD3                     ; ld hl,endpat2
0223++ 5FD3                     ; ld de,0x0000+256*8
0224++ 5FD3                     ; call    out2k
0225++ 5FD3             
0226++ 5FD3                     ; ld hl,endcol2
0227++ 5FD3                     ; ld de,0x2000+256*8
0228++ 5FD3                     ; call    out2k
0229++ 5FD3             
0230++ 5FD3                     ; ld hl,endpat3
0231++ 5FD3                     ; ld de,0x0000+256*8*2
0232++ 5FD3                     ; call    out2k
0233++ 5FD3             
0234++ 5FD3                     ; ld hl,endcol3
0235++ 5FD3                     ; ld de,0x2000+256*8*2
0236++ 5FD3                     ; call    out2k
0237++ 5FD3             
0238++ 5FD3             
0239++ 5FD3             
0240++ 5FD3 21 00 18            ld hl,0x1800
0241++ 5FD6 06 18               ld  b,24
0242++ 5FD8 AF                  xor a
0243++ 5FD9 F5          2:      push    af
0244++ 5FDA CD 53 00            call    setwrt
0245++ 5FDD F1                  pop     af
0246++ 5FDE C5                  push    bc
0247++ 5FDF                     
0248++ 5FDF 06 10               ld      b,16
0249++ 5FE1 D3 98       1:      out     (0x98),a
0250++ 5FE3 3C                  inc     a
0251++ 5FE4 E6 7F               and     127
0252++ 5FE6 10 F9               djnz    1b
0253++ 5FE8                     
0254++ 5FE8 0E 20               ld      c,32
0255++ 5FEA 09                  add     hl,bc
0256++ 5FEB C1                  pop     bc
0257++ 5FEC 10 EB               djnz    2b
0258++ 5FEE             
0259++ 5FEE                
0260++ 5FEE             
0261++ 5FEE             ; show sprite 12 at 96,24
0262++ 5FEE             ; show sprite 13 at 96,40
0263++ 5FEE             ; show sprite 14 at 112,24
0264++ 5FEE             ; show sprite 15 at 16,96
0265++ 5FEE             ; show sprite 16 at 16,120
0266++ 5FEE             ; show sprite 17 at 32,88
0267++ 5FEE             ; show sprite 18 at 32,104
0268++ 5FEE             ; show sprite 19 at 32,128-8
0269++ 5FEE             ; show sprite 20 at 32,144
0270++ 5FEE             ; show sprite 21 at 88,104
0271++ 5FEE             ; show sprite 22 at 80,112
0272++ 5FEE             
0273++ 5FEE             
0274++ 5FEE 21 00 1B            ld hl,0x1b00
0275++ 5FF1 CD 53 00            call setwrt
0276++ 5FF4             
0277++ 5FF4 21 94 5D            ld   hl,spritemaskend
0278++ 5FF7 01 98 2D            ld   bc,(11*4+1)*256+0x98
0279++ 5FFA ED B3               otir
0280++ 5FFC             
0281++ 5FFC CD 44 00            call    enascr
0282++ 5FFF             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0283++ 5FFF                     
0284++ 5FFF             
0285++ 5FFF DD E5               push    ix
0286++ 6001 E5                  push    hl
0287++ 6002 21 04 B6    		ld	hl,MUSIC5			; hl <- initial address of module 
0288++ 6005 CD CF A0    		call	PT3_INIT			; Inits PT3 player
0289++ 6008 E1                  pop     hl
0290++ 6009 DD E1               pop     ix
0291++ 600B             
0292++ 600B             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0293++ 600B CD 38 60            call goodendcls
0294++ 600E             
0295++ 600E 06 96               ld  b,3*50
0296++ 6010 76          1:      halt
0297++ 6011 10 FD               djnz    1b
0298++ 6013             
0299++ 6013 CD 65 60            call endtext
0300++ 6016             
0301++ 6016             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0302++ 6016             ; wait a key while music is looping 
0303++ 6016             ;
0304++ 6016 01 58 02            ld   bc,10*60
0305++ 6019             1:
0306++ 6019 0B                  dec     bc
0307++ 601A 78                  ld      a,b
0308++ 601B B1                  or      c
0309++ 601C CC 51 60            call    z,texthint
0310++ 601F             
0311++ 601F CD AB 7A            call    _joy
0312++ 6022 E6 10               and     00010000B
0313++ 6024 C8                  ret     z
0314++ 6025             
0315++ 6025 76                  halt
0316++ 6026 3E 08               ld      a,8
0317++ 6028 C5                  push    bc
0318++ 6029 CD 41 01            call    0x0141 ; getin ending
0319++ 602C C1                  pop     bc
0320++ 602D 3C                  inc     a
0321++ 602E 28 E9               jr      z,1b
0322++ 6030             
0323++ 6030 21 84 BA    		ld	hl,MUSIC6			; hl <- initial address of module 
0324++ 6033 CD CF A0    		call	PT3_INIT			; Inits PT3 player
0325++ 6036 76          		halt
0326++ 6037 C9                  ret
0327++ 6038             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0328++ 6038             ;   clear the screen
0329++ 6038             ;
0330++ 6038             goodendcls:
0331++ 6038 21 10 18            ld      hl,0x1800+16
0332++ 603B 06 18               ld      b,24
0333++ 603D C5          2:      push    bc
0334++ 603E CD 53 00            call    setwrt
0335++ 6041 3E FF               ld      a,255
0336++ 6043 06 10               ld      b,16
0337++ 6045 D3 98       1:      out     (0x98),a
0338++ 6047 10 FC               djnz    1b
0339++ 6049 01 20 00            ld      bc,32
0340++ 604C 09                  add     hl,bc
0341++ 604D C1                  pop     bc
0342++ 604E 10 ED               djnz    2b
0343++ 6050 C9                  ret
0344++ 6051             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0345++ 6051             ; display hints on the secret game
0346++ 6051             ;
0347++ 6051             texthint:
0348++ 6051 CD 38 60            call    goodendcls
0349++ 6054             
0350++ 6054 21 30 18            ld      hl,0x1800+1*32+16
0351++ 6057 11 49 69            ld      de,goodendtext18
0352++ 605A 06 0B               ld      b,11
0353++ 605C 3E 10               ld      a,16
0354++ 605E CD 69 73            call    _printtext
0355++ 6061             
0356++ 6061 01 00 00            ld      bc,0
0357++ 6064 C9                  ret
0358++ 6065             
0359++ 6065                     include textdata.asm
0001+++6065             endtext:
0002+++6065             
0003+++6065 DD 21 9F 60     ld  ix,textstruct
0004+++6069             
0005+++6069             loop:    
0006+++6069 CD 38 60        call goodendcls
0007+++606C                 
0008+++606C DD 6E 00        ld  l,(ix+0)
0009+++606F 26 00           ld  h,0
0010+++6071 29              add hl,hl
0011+++6072 29              add hl,hl
0012+++6073 29              add hl,hl
0013+++6074 29              add hl,hl
0014+++6075 29              add hl,hl                
0015+++6076 11 10 18        ld  de,0x1800+16
0016+++6079 19              add hl,de
0017+++607A DD 5E 01        ld  e,(ix+1)
0018+++607D DD 56 02        ld  d,(ix+2)
0019+++6080 DD 46 03        ld  b,(ix+3)
0020+++6083 DD 7E 04        ld  a,(ix+4)
0021+++6086 CD 69 73        call    _printtext
0022+++6089             
0023+++6089 DD 7E 05        ld a,(ix+5)
0024+++608C 3C              inc a
0025+++608D C8              ret z
0026+++608E             
0027+++608E 76          1: 	halt
0028+++608F CD DD 52    	call seq
0029+++6092 DD 7E 05    	ld a,(ix+5)
0030+++6095 BD          	cp l
0031+++6096 30 F6       	jr nc,1b ;     
0032+++6098                 
0033+++6098 01 06 00        ld  bc,6
0034+++609B DD 09           add ix,bc
0035+++609D 18 CA           jr  loop
0036+++609F             
0037+++609F             textstruct:
0038+++609F 03              db  3 
0039+++60A0 05 61           dw  goodendtext4
0040+++60A2 09              db  9
0041+++60A3 10              db  16
0042+++60A4 02              db  2
0043+++60A5             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0044+++60A5 03              db  3 
0045+++60A6 95 61           dw  goodendtext5
0046+++60A8 06              db  6
0047+++60A9 10              db  16
0048+++60AA 03              db  3
0049+++60AB             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0050+++60AB 03              db  3 
0051+++60AC F5 61           dw  goodendtext5b
0052+++60AE 06              db  6
0053+++60AF 10              db  16
0054+++60B0 04              db  4
0055+++60B1             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0056+++60B1 03              db  3 
0057+++60B2 55 62           dw  goodendtext6
0058+++60B4 05              db  5
0059+++60B5 10              db  16
0060+++60B6 05              db  5
0061+++60B7             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0062+++60B7 01              db  1 
0063+++60B8 A5 62           dw  goodendtext7
0064+++60BA 0B              db  11
0065+++60BB 10              db  16
0066+++60BC 06              db  6
0067+++60BD             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0068+++60BD 02              db  2 
0069+++60BE 55 63           dw  goodendtext7b
0070+++60C0 0B              db  11
0071+++60C1 10              db  16
0072+++60C2 07              db  7
0073+++60C3             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0074+++60C3 08              db  8 
0075+++60C4 05 64           dw  goodendtext8
0076+++60C6 02              db  2
0077+++60C7 10              db  16
0078+++60C8 08              db  8
0079+++60C9             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0080+++60C9 03              db  3 
0081+++60CA 28 64           dw  goodendtext8b
0082+++60CC 0B              db  11
0083+++60CD 10              db  16
0084+++60CE 0A              db  10
0085+++60CF             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0086+++60CF 03              db  3 
0087+++60D0 D8 64           dw  goodendtext9
0088+++60D2 0B              db  11
0089+++60D3 10              db  16
0090+++60D4 0C              db  12
0091+++60D5             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0092+++60D5 03              db  3 
0093+++60D6 88 65           dw  goodendtext10
0094+++60D8 0B              db  11
0095+++60D9 10              db  16
0096+++60DA 0E              db  14
0097+++60DB             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0098+++60DB 03              db  3 
0099+++60DC 38 66           dw  goodendtext11
0100+++60DE 0B              db  11
0101+++60DF 10              db  16
0102+++60E0 10              db  16
0103+++60E1             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0104+++60E1 03              db  3 
0105+++60E2 E8 66           dw  goodendtext12
0106+++60E4 05              db  5
0107+++60E5 10              db  16
0108+++60E6 12              db  18
0109+++60E7             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0110+++60E7 03              db  3 
0111+++60E8 38 67           dw  goodendtext13
0112+++60EA 08              db  8
0113+++60EB 10              db  16
0114+++60EC 14              db  20
0115+++60ED             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0116+++60ED 03              db  3 
0117+++60EE B8 67           dw  goodendtext14
0118+++60F0 0A              db  10
0119+++60F1 10              db  16
0120+++60F2 16              db  22
0121+++60F3             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0122+++60F3 05              db  5 
0123+++60F4 59 68           dw  goodendtext15
0124+++60F6 0A              db  10
0125+++60F7 10              db  16
0126+++60F8 18              db  24
0127+++60F9             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0128+++60F9 05              db  5 
0129+++60FA C9 68           dw  goodendtext16
0130+++60FC 07              db  7
0131+++60FD 10              db  16
0132+++60FE 1B              db  27
0133+++60FF             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0134+++60FF 05              db  5 
0135+++6100 39 69           dw  goodendtext17
0136+++6102 01              db  1
0137+++6103 10              db  16
0138+++6104 FF              db  255
0139+++6105             ;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0140+++6105             
0141+++6105             
0142+++6105             goodendtext4:
0143+++6105             ;show text at 16,0
0144+++6105             ;CONGRATULATIONS!
0145+++6105                   db 67+127, 79+127, 78+127, 71+127, 82+127, 65+127, 84+127, 85+127, 76+127, 65+127, 84+127, 73+127, 79+127, 78+127, 83+127, 185
0145+++6105 C2CECDC6D1C0D3D4CBC0D3C8CECDD2B9
0146+++6115                   rept    16
0147+++6115~                  db 255
0148+++6115                   endm
0148+++6115 FF          >      db 255
0148+++6116 FF          >      db 255
0148+++6117 FF          >      db 255
0148+++6118 FF          >      db 255
0148+++6119 FF          >      db 255
0148+++611A FF          >      db 255
0148+++611B FF          >      db 255
0148+++611C FF          >      db 255
0148+++611D FF          >      db 255
0148+++611E FF          >      db 255
0148+++611F FF          >      db 255
0148+++6120 FF          >      db 255
0148+++6121 FF          >      db 255
0148+++6122 FF          >      db 255
0148+++6123 FF          >      db 255
0148+++6124 FF          >      db 255
0149+++6125             ;YOU HAVE FACED
0150+++6125                   db 89+127, 79+127, 85+127, 255, 72+127, 65+127, 86+127, 69+127, 255, 70+127, 65+127, 67+127, 69+127, 68+127 ,255 ,255
0150+++6125 D8CED4FFC7C0D5C4FFC5C0C2C4C3FFFF
0151+++6135             ;THE DEEP DUNGEON
0152+++6135                   db 84+127, 72+127, 69+127, 255, 68+127, 69+127, 69+127, 80+127, 255, 68+127, 85+127, 78+127, 71+127, 69+127, 79+127, 78+127
0152+++6135 D3C7C4FFC3C4C4CFFFC3D4CDC6C4CECD
0153+++6145             ;AND OVERCAME ITS
0154+++6145                   db 65+127, 78+127, 68+127, 255, 79+127, 86+127, 69+127, 82+127, 67+127, 65+127, 77+127, 69+127, 255, 73+127, 84+127, 83+127
0154+++6145 C0CDC3FFCED5C4D1C2C0CCC4FFC8D3D2
0155+++6155             ;HORRIBLE DANGERS
0156+++6155                   db 72+127, 79+127, 82+127, 82+127, 73+127, 66+127, 76+127, 69+127, 255, 68+127, 65+127, 78+127, 71+127, 69+127, 82+127, 83+127
0156+++6155 C7CED1D1C8C1CBC4FFC3C0CDC6C4D1D2
0157+++6165                   rept    16
0158+++6165~                  db 255
0159+++6165                   endm
0159+++6165 FF          >      db 255
0159+++6166 FF          >      db 255
0159+++6167 FF          >      db 255
0159+++6168 FF          >      db 255
0159+++6169 FF          >      db 255
0159+++616A FF          >      db 255
0159+++616B FF          >      db 255
0159+++616C FF          >      db 255
0159+++616D FF          >      db 255
0159+++616E FF          >      db 255
0159+++616F FF          >      db 255
0159+++6170 FF          >      db 255
0159+++6171 FF          >      db 255
0159+++6172 FF          >      db 255
0159+++6173 FF          >      db 255
0159+++6174 FF          >      db 255
0160+++6175             ;YOU ARE A TRUE
0161+++6175                   db 89+127, 79+127, 85+127, 255, 65+127, 82+127, 69+127, 255, 65+127, 255, 84+127, 82+127, 85+127, 69+127 ,255,255
0161+++6175 D8CED4FFC0D1C4FFC0FFD3D1D4C4FFFF
0162+++6185             ;HERO!
0163+++6185 C7C4D1CEB9        db 72+127, 69+127, 82+127, 79+127, 185
0164+++618A                   rept    11
0165+++618A~                  db 255
0166+++618A                   endm
0166+++618A FF          >      db 255
0166+++618B FF          >      db 255
0166+++618C FF          >      db 255
0166+++618D FF          >      db 255
0166+++618E FF          >      db 255
0166+++618F FF          >      db 255
0166+++6190 FF          >      db 255
0166+++6191 FF          >      db 255
0166+++6192 FF          >      db 255
0166+++6193 FF          >      db 255
0166+++6194 FF          >      db 255
0167+++6195             
0168+++6195             
0169+++6195              ;just before seq#1 clear text
0170+++6195             ;seq#1
0171+++6195             goodendtext5:
0172+++6195             ;show text at 16,3
0173+++6195             ;FROM AFAR, YOU
0174+++6195                   db 70+127, 82+127, 79+127, 77+127, 255, 65+127, 70+127, 65+127, 82+127, 183, 255, 89+127, 79+127, 85+127,255,255
0174+++6195 C5D1CECCFFC0C5C0D1B7FFD8CED4FFFF
0175+++61A5             ;WATCH THE GATE
0176+++61A5                   db 87+127, 65+127, 84+127, 67+127, 72+127, 255, 84+127, 72+127, 69+127, 255, 71+127, 65+127, 84+127, 69+127,255,255
0176+++61A5 D6C0D3C2C7FFD3C7C4FFC6C0D3C4FFFF
0177+++61B5             ;OF THAT INFERNAL
0178+++61B5                   db 79+127, 70+127, 255, 84+127, 72+127, 65+127, 84+127, 255, 73+127, 78+127, 70+127, 69+127, 82+127, 78+127, 65+127, 76+127
0178+++61B5 CEC5FFD3C7C0D3FFC8CDC5C4D1CDC0CB
0179+++61C5             ;HARBOUR WHERE
0180+++61C5                   db 72+127, 65+127, 82+127, 66+127, 79+127, 85+127, 82+127, 255, 87+127, 72+127, 69+127, 82+127, 69+127,255,255,255
0180+++61C5 C7C0D1C1CED4D1FFD6C7C4D1C4FFFFFF
0181+++61D5             ;ALL OF THIS TOOK
0182+++61D5                   db 65+127, 76+127, 76+127, 255, 79+127, 70+127, 255, 84+127, 72+127, 73+127, 83+127, 255, 84+127, 79+127, 79+127, 75+127
0182+++61D5 C0CBCBFFCEC5FFD3C7C8D2FFD3CECECA
0183+++61E5             ;PLACE.
0184+++61E5                   db 80+127, 76+127, 65+127, 67+127, 69+127, 185
0184+++61E5 CFCBC0C2C4B9
0185+++61EB                   rept    10
0186+++61EB~                  db 255
0187+++61EB                   endm
0187+++61EB FF          >      db 255
0187+++61EC FF          >      db 255
0187+++61ED FF          >      db 255
0187+++61EE FF          >      db 255
0187+++61EF FF          >      db 255
0187+++61F0 FF          >      db 255
0187+++61F1 FF          >      db 255
0187+++61F2 FF          >      db 255
0187+++61F3 FF          >      db 255
0187+++61F4 FF          >      db 255
0188+++61F5             
0189+++61F5             goodendtext5b:
0190+++61F5             ;show text at 16,3
0191+++61F5             
0192+++61F5             ;WITH THE POWER
0193+++61F5                   db 87+127, 73+127, 84+127, 72+127, 255, 84+127, 72+127, 69+127, 255, 80+127, 79+127, 87+127, 69+127, 82+127,255,255
0193+++61F5 D6C8D3C7FFD3C7C4FFCFCED6C4D1FFFF
0194+++6205             ;OF THE MAGICIAN
0195+++6205                   db 79+127, 70+127, 255, 84+127, 72+127, 69+127, 255, 77+127, 65+127, 71+127, 73+127, 67+127, 73+127, 65+127, 78+127,255
0195+++6205 CEC5FFD3C7C4FFCCC0C6C8C2C8C0CDFF
0196+++6215             ;BROKEN, THE EVIL
0197+++6215                   db 66+127, 82+127, 79+127, 75+127, 69+127, 78+127, 183, 255, 84+127, 72+127, 69+127, 255, 69+127, 86+127, 73+127, 76+127
0197+++6215 C1D1CECAC4CDB7FFD3C7C4FFC4D5C8CB
0198+++6225             ;CURSE UPON YOUR
0199+++6225                   db 67+127, 85+127, 82+127, 83+127, 69+127, 255, 85+127, 80+127, 79+127, 78+127, 255, 89+127, 79+127, 85+127, 82+127,255
0199+++6225 C2D4D1D2C4FFD4CFCECDFFD8CED4D1FF
0200+++6235             ;BLOODLINE HAS
0201+++6235                  db 66+127, 76+127, 79+127, 79+127, 68+127, 76+127, 73+127, 78+127, 69+127, 255, 72+127, 65+127, 83+127 ,255,255,255
0201+++6235 C1CBCECEC3CBC8CDC4FFC7C0D2FFFFFF
0202+++6245             ;BEEN RAISED.
0203+++6245                   db 66+127, 69+127, 69+127, 78+127, 255, 82+127, 65+127, 73+127, 83+127, 69+127, 68+127, 185,255,255,255,255
0203+++6245 C1C4C4CDFFD1C0C8D2C4C3B9FFFFFFFF
0204+++6255             
0205+++6255             
0206+++6255             
0207+++6255             ;just before seq#2 clear text
0208+++6255             ;seq#2
0209+++6255             goodendtext6:
0210+++6255             ;show text at 16,3
0211+++6255             ;FINALLY,
0212+++6255                   db 70+127, 73+127, 78+127, 65+127, 76+127, 76+127, 89+127, 183
0212+++6255 C5C8CDC0CBCBD8B7
0213+++625D                   rept    24
0214+++625D~                  db 255
0215+++625D                   endm
0215+++625D FF          >      db 255
0215+++625E FF          >      db 255
0215+++625F FF          >      db 255
0215+++6260 FF          >      db 255
0215+++6261 FF          >      db 255
0215+++6262 FF          >      db 255
0215+++6263 FF          >      db 255
0215+++6264 FF          >      db 255
0215+++6265 FF          >      db 255
0215+++6266 FF          >      db 255
0215+++6267 FF          >      db 255
0215+++6268 FF          >      db 255
0215+++6269 FF          >      db 255
0215+++626A FF          >      db 255
0215+++626B FF          >      db 255
0215+++626C FF          >      db 255
0215+++626D FF          >      db 255
0215+++626E FF          >      db 255
0215+++626F FF          >      db 255
0215+++6270 FF          >      db 255
0215+++6271 FF          >      db 255
0215+++6272 FF          >      db 255
0215+++6273 FF          >      db 255
0215+++6274 FF          >      db 255
0216+++6275             
0217+++6275             ;PEACE WILL
0218+++6275                   db 80+127, 69+127, 65+127, 67+127, 69+127,255,87+127, 73+127, 76+127, 76+127
0218+++6275 CFC4C0C2C4FFD6C8CBCB
0219+++627F                   rept    6
0220+++627F~                  db 255
0221+++627F                   endm
0221+++627F FF          >      db 255
0221+++6280 FF          >      db 255
0221+++6281 FF          >      db 255
0221+++6282 FF          >      db 255
0221+++6283 FF          >      db 255
0221+++6284 FF          >      db 255
0222+++6285             ;RETURN TO YOUR
0223+++6285                   db 82+127, 69+127, 84+127, 85+127, 82+127, 78+127, 255, 84+127, 79+127,255,89+127, 79+127, 85+127, 82+127,255,255
0223+++6285 D1C4D3D4D1CDFFD3CEFFD8CED4D1FFFF
0224+++6295             ;COUNTRY!
0225+++6295                   db 67+127, 79+127, 85+127, 78+127, 84+127, 82+127, 89+127, 185,255,255,255,255,255,255,255,255
0225+++6295 C2CED4CDD3D1D8B9FFFFFFFFFFFFFFFF
0226+++62A5             
0227+++62A5             
0228+++62A5             ;just before seq#3 clear text
0229+++62A5             ;seq#3
0230+++62A5             goodendtext7:
0231+++62A5             ;show text at 16,0
0232+++62A5             ;CODE:
0233+++62A5                   db 67+127+32, 79+127+32, 68+127+32, 69+127+32, 189,255,255,255,255,255,255,255,255,255,255,255
0233+++62A5 E2EEE3E4BDFFFFFFFFFFFFFFFFFFFFFF
0234+++62B5             ;         ARTURO
0235+++62B5                   db 255, 255, 255, 255, 255, 255, 255, 255, 255, 65+127, 82+127, 84+127, 85+127, 82+127, 79+127,255
0235+++62B5 FFFFFFFFFFFFFFFFFFC0D1D3D4D1CEFF
0236+++62C5             ;       RAGOZINI
0237+++62C5                   db 255, 255, 255, 255, 255, 255, 255, 82+127, 65+127, 71+127, 79+127, 90+127, 73+127, 78+127, 73+127,255
0237+++62C5 FFFFFFFFFFFFFFD1C0C6CED9C8CDC8FF
0238+++62D5             ; skip a line
0239+++62D5                   rept    16
0240+++62D5~                  db 255
0241+++62D5                   endm
0241+++62D5 FF          >      db 255
0241+++62D6 FF          >      db 255
0241+++62D7 FF          >      db 255
0241+++62D8 FF          >      db 255
0241+++62D9 FF          >      db 255
0241+++62DA FF          >      db 255
0241+++62DB FF          >      db 255
0241+++62DC FF          >      db 255
0241+++62DD FF          >      db 255
0241+++62DE FF          >      db 255
0241+++62DF FF          >      db 255
0241+++62E0 FF          >      db 255
0241+++62E1 FF          >      db 255
0241+++62E2 FF          >      db 255
0241+++62E3 FF          >      db 255
0241+++62E4 FF          >      db 255
0242+++62E5             ;SOUND:
0243+++62E5                   db 83+127+32, 79+127+32, 85+127+32, 78+127+32, 68+127+32, 189
0243+++62E5 F2EEF4EDE3BD
0244+++62EB                   rept    10
0245+++62EB~                  db 255
0246+++62EB                   endm
0246+++62EB FF          >      db 255
0246+++62EC FF          >      db 255
0246+++62ED FF          >      db 255
0246+++62EE FF          >      db 255
0246+++62EF FF          >      db 255
0246+++62F0 FF          >      db 255
0246+++62F1 FF          >      db 255
0246+++62F2 FF          >      db 255
0246+++62F3 FF          >      db 255
0246+++62F4 FF          >      db 255
0247+++62F5             ;           JOHN
0248+++62F5                   db 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 74+127, 79+127, 72+127, 78+127,255
0248+++62F5 FFFFFFFFFFFFFFFFFFFFFFC9CEC7CDFF
0249+++6305             ;        HASSINK
0250+++6305                   db 255, 255, 255, 255, 255, 255, 255, 255, 72+127, 65+127, 83+127, 83+127, 73+127, 78+127, 75+127,255
0250+++6305 FFFFFFFFFFFFFFFFC7C0D2D2C8CDCAFF
0251+++6315             
0252+++6315                   rept    16
0253+++6315~                  db 255
0254+++6315                   endm
0254+++6315 FF          >      db 255
0254+++6316 FF          >      db 255
0254+++6317 FF          >      db 255
0254+++6318 FF          >      db 255
0254+++6319 FF          >      db 255
0254+++631A FF          >      db 255
0254+++631B FF          >      db 255
0254+++631C FF          >      db 255
0254+++631D FF          >      db 255
0254+++631E FF          >      db 255
0254+++631F FF          >      db 255
0254+++6320 FF          >      db 255
0254+++6321 FF          >      db 255
0254+++6322 FF          >      db 255
0254+++6323 FF          >      db 255
0254+++6324 FF          >      db 255
0255+++6325             
0256+++6325             ;GRAPHICS:
0257+++6325                   db 71+127+32, 82+127+32, 65+127+32, 80+127+32, 72+127+32, 73+127+32, 67+127+32, 83+127+32, 189
0257+++6325 E6F1E0EFE7E8E2F2BD
0258+++632E                   rept    16-9
0259+++632E~                  db 255
0260+++632E                   endm
0260+++632E FF          >      db 255
0260+++632F FF          >      db 255
0260+++6330 FF          >      db 255
0260+++6331 FF          >      db 255
0260+++6332 FF          >      db 255
0260+++6333 FF          >      db 255
0260+++6334 FF          >      db 255
0261+++6335             
0262+++6335             ;        RICHARD
0263+++6335                   db 255, 255, 255, 255, 255, 255, 255, 255, 82+127, 73+127, 67+127, 72+127, 65+127, 82+127, 68+127,255
0263+++6335 FFFFFFFFFFFFFFFFD1C8C2C7C0D1C3FF
0264+++6345             ;     CORNELISSE
0265+++6345                   db 255, 255, 255, 255, 255, 67+127, 79+127, 82+127, 78+127, 69+127, 76+127, 73+127, 83+127, 83+127, 69+127,255
0265+++6345 FFFFFFFFFFC2CED1CDC4CBC8D2D2C4FF
0266+++6355             ;
0267+++6355             
0268+++6355             ;just before seq#4 clear text
0269+++6355             ;seq#4
0270+++6355             goodendtext7b:
0271+++6355             ;show text at 16,0
0272+++6355             ;COVER ART:
0273+++6355                   db 'C'+127+32, 'O'+127+32, 'V'+127+32, 'E'+127+32, 'R'+127+32, 255, 'A'+127+32, 'R'+127+32, 'T'+127+32, 189,255
0273+++6355 E2EEF5E4F1FFE0F1F3BDFF
0274+++6360                   rept    5
0275+++6360~                  db 255
0276+++6360                   endm
0276+++6360 FF          >      db 255
0276+++6361 FF          >      db 255
0276+++6362 FF          >      db 255
0276+++6363 FF          >      db 255
0276+++6364 FF          >      db 255
0277+++6365             ;    JURJEN YPMA
0278+++6365                   db 255, 255, 255, 255, 255,'J'+127, 'U'+127, 'R'+127, 'J'+127, 'E'+127, 'N'+127, 255, 'Y'+127, 'P'+127, 'M'+127, 'A'+127
0278+++6365 FFFFFFFFFFC9D4D1C9C4CDFFD8CFCCC0
0279+++6375             
0280+++6375                   rept    16
0281+++6375~                  db 255
0282+++6375                   endm
0282+++6375 FF          >      db 255
0282+++6376 FF          >      db 255
0282+++6377 FF          >      db 255
0282+++6378 FF          >      db 255
0282+++6379 FF          >      db 255
0282+++637A FF          >      db 255
0282+++637B FF          >      db 255
0282+++637C FF          >      db 255
0282+++637D FF          >      db 255
0282+++637E FF          >      db 255
0282+++637F FF          >      db 255
0282+++6380 FF          >      db 255
0282+++6381 FF          >      db 255
0282+++6382 FF          >      db 255
0282+++6383 FF          >      db 255
0282+++6384 FF          >      db 255
0283+++6385             ; PACKAGING ART:
0284+++6385                   db 'P'+127+32, 'A'+127+32, 'C'+127+32, 'K'+127+32, 'A'+127+32, 'G'+127+32, 'I'+127+32, 'N'+127+32, 'G'+127+32, 255, 'A'+127+32, 'R'+127+32,'T'+127+32, 189,255,255
0284+++6385 EFE0E2EAE0E6E8EDE6FFE0F1F3BDFFFF
0285+++6395             ; S T A R
0286+++6395                   db 255,255,255,255,255,255,255,255,255,'S'+127, 255, 'T'+127, 255, 'A'+127,255, 'R'+127
0286+++6395 FFFFFFFFFFFFFFFFFFD2FFD3FFC0FFD1
0287+++63A5                   rept    16
0288+++63A5~                  db 255
0289+++63A5                   endm
0289+++63A5 FF          >      db 255
0289+++63A6 FF          >      db 255
0289+++63A7 FF          >      db 255
0289+++63A8 FF          >      db 255
0289+++63A9 FF          >      db 255
0289+++63AA FF          >      db 255
0289+++63AB FF          >      db 255
0289+++63AC FF          >      db 255
0289+++63AD FF          >      db 255
0289+++63AE FF          >      db 255
0289+++63AF FF          >      db 255
0289+++63B0 FF          >      db 255
0289+++63B1 FF          >      db 255
0289+++63B2 FF          >      db 255
0289+++63B3 FF          >      db 255
0289+++63B4 FF          >      db 255
0290+++63B5             
0291+++63B5             ;BETA TESTERS
0292+++63B5                   db 'B'+127+32, 'E'+127+32, 'T'+127+32, 'A'+127+32, 255, 'T'+127+32, 'E'+127+32, 'S'+127+32, 'T'+127+32, 'E'+127+32, 'R'+127+32, 'S'+127+32, 189
0292+++63B5 E1E4F3E0FFF3E4F2F3E4F1F2BD
0293+++63C2                   rept    9
0294+++63C2~                  db 255
0295+++63C2                   endm
0295+++63C2 FF          >      db 255
0295+++63C3 FF          >      db 255
0295+++63C4 FF          >      db 255
0295+++63C5 FF          >      db 255
0295+++63C6 FF          >      db 255
0295+++63C7 FF          >      db 255
0295+++63C8 FF          >      db 255
0295+++63C9 FF          >      db 255
0295+++63CA FF          >      db 255
0296+++63CB             ;NYNKE
0297+++63CB                   db 'N'+127, 'Y'+127, 'N'+127, 'K'+127, 'E'+127, 255, 'Y'+127, 'P'+127, 'M'+127, 'A'+127
0297+++63CB CDD8CDCAC4FFD8CFCCC0
0298+++63D5             ;        MITCHELL
0299+++63D5                   db 'M'+127, 'I'+127, 'T'+127, 'C'+127, 'H'+127, 'E'+127, 'L'+127, 'L'+127,255
0299+++63D5 CCC8D3C2C7C4CBCBFF
0300+++63DE             ;         LENDERS
0301+++63DE                   db 'L'+127, 'E'+127, 'N'+127, 'D'+127, 'E'+127, 'R'+127, 'S'+127
0301+++63DE CBC4CDC3C4D1D2
0302+++63E5             ;RIEKS
0303+++63E5                   db 'R'+127, 'I'+127, 'E'+127, 'K'+127, 'S'+127, 255, 'W'+127, 255, 'T'+127, 'O'+127, 'R'+127, 'R'+127, 'I'+127, 'N'+127, 'G'+127, 'A'+127
0303+++63E5 D1C8C4CAD2FFD6FFD3CED1D1C8CDC6C0
0304+++63F5             ;          ROBERT
0305+++63F5                   db 'R'+127, 'O'+127, 'B'+127, 'E'+127, 'R'+127, 'T'+127, 255, 'V'+127, 'R'+127, 'O'+127, 'E'+127, 'M'+127, 'I'+127, 'S'+127, 'S'+127, 'E'+127
0305+++63F5 D1CEC1C4D1D3FFD5D1CEC4CCC8D2D2C4
0306+++6405             
0307+++6405             
0308+++6405             
0309+++6405             
0310+++6405             
0311+++6405             ;just before seq#4 clear text
0312+++6405             ;seq#4
0313+++6405             goodendtext8:
0314+++6405             ;show text at 16,0
0315+++6405             ;THANKS
0316+++6405                   db 255,255,255,255,84+127+32, 72+127+32, 65+127+32, 78+127+32, 75+127+32, 83+127+32
0316+++6405 FFFFFFFFF3E7E0EDEAF2
0317+++640F                   rept    9
0318+++640F~                  db 255
0319+++640F                   endm
0319+++640F FF          >      db 255
0319+++6410 FF          >      db 255
0319+++6411 FF          >      db 255
0319+++6412 FF          >      db 255
0319+++6413 FF          >      db 255
0319+++6414 FF          >      db 255
0319+++6415 FF          >      db 255
0319+++6416 FF          >      db 255
0319+++6417 FF          >      db 255
0320+++6418             ;GO OUT TO
0321+++6418                   db 71+127+32, 79+127+32, 255, 79+127+32, 85+127+32, 84+127+32, 255, 84+127+32, 79+127+32
0321+++6418 E6EEFFEEF4F3FFF3EE
0322+++6421                   rept    7
0323+++6421~                  db 255
0324+++6421                   endm
0324+++6421 FF          >      db 255
0324+++6422 FF          >      db 255
0324+++6423 FF          >      db 255
0324+++6424 FF          >      db 255
0324+++6425 FF          >      db 255
0324+++6426 FF          >      db 255
0324+++6427 FF          >      db 255
0325+++6428             
0326+++6428             goodendtext8b:
0327+++6428             ;ALEKSI EEBEN
0328+++6428                   db 255,190,65+127, 76+127, 69+127, 75+127, 83+127, 73+127, 255, 69+127, 69+127, 66+127, 69+127, 78+127,190,255
0328+++6428 FFBEC0CBC4CAD2C8FFC4C4C1C4CDBEFF
0329+++6438                  rept    4+16
0330+++6438~                  db 255
0331+++6438                   endm
0331+++6438 FF          >      db 255
0331+++6439 FF          >      db 255
0331+++643A FF          >      db 255
0331+++643B FF          >      db 255
0331+++643C FF          >      db 255
0331+++643D FF          >      db 255
0331+++643E FF          >      db 255
0331+++643F FF          >      db 255
0331+++6440 FF          >      db 255
0331+++6441 FF          >      db 255
0331+++6442 FF          >      db 255
0331+++6443 FF          >      db 255
0331+++6444 FF          >      db 255
0331+++6445 FF          >      db 255
0331+++6446 FF          >      db 255
0331+++6447 FF          >      db 255
0331+++6448 FF          >      db 255
0331+++6449 FF          >      db 255
0331+++644A FF          >      db 255
0331+++644B FF          >      db 255
0332+++644C             ; FOR HIS
0333+++644C                   db 70+127+32, 79+127+32, 82+127+32, 255, 72+127+32, 73+127+32, 83+127+32
0333+++644C E5EEF1FFE7E8F2
0334+++6453                  rept    8
0335+++6453~                  db 255
0336+++6453                   endm
0336+++6453 FF          >      db 255
0336+++6454 FF          >      db 255
0336+++6455 FF          >      db 255
0336+++6456 FF          >      db 255
0336+++6457 FF          >      db 255
0336+++6458 FF          >      db 255
0336+++6459 FF          >      db 255
0336+++645A FF          >      db 255
0337+++645B             ;1K WHACK
0338+++645B                   db 73+127+32, 75+127+32, 255, 87+127+32, 72+127+32, 65+127+32, 67+127+32, 75+127+32
0338+++645B E8EAFFF6E7E0E2EA
0339+++6463                  rept    5+3
0340+++6463~                  db 255
0341+++6463                   endm
0341+++6463 FF          >      db 255
0341+++6464 FF          >      db 255
0341+++6465 FF          >      db 255
0341+++6466 FF          >      db 255
0341+++6467 FF          >      db 255
0341+++6468 FF          >      db 255
0341+++6469 FF          >      db 255
0341+++646A FF          >      db 255
0342+++646B             ;FOR VIC-20
0343+++646B                   db 70+127+32, 79+127+32, 82+127+32, 255, 86+127+32, 73+127+32, 67+127+32, 190, 173, 79+127+32
0343+++646B E5EEF1FFF5E8E2BEADEE
0344+++6475                  rept    16+16+16+16+3
0345+++6475~                  db 255
0346+++6475                   endm
0346+++6475 FF          >      db 255
0346+++6476 FF          >      db 255
0346+++6477 FF          >      db 255
0346+++6478 FF          >      db 255
0346+++6479 FF          >      db 255
0346+++647A FF          >      db 255
0346+++647B FF          >      db 255
0346+++647C FF          >      db 255
0346+++647D FF          >      db 255
0346+++647E FF          >      db 255
0346+++647F FF          >      db 255
0346+++6480 FF          >      db 255
0346+++6481 FF          >      db 255
0346+++6482 FF          >      db 255
0346+++6483 FF          >      db 255
0346+++6484 FF          >      db 255
0346+++6485 FF          >      db 255
0346+++6486 FF          >      db 255
0346+++6487 FF          >      db 255
0346+++6488 FF          >      db 255
0346+++6489 FF          >      db 255
0346+++648A FF          >      db 255
0346+++648B FF          >      db 255
0346+++648C FF          >      db 255
0346+++648D FF          >      db 255
0346+++648E FF          >      db 255
0346+++648F FF          >      db 255
0346+++6490 FF          >      db 255
0346+++6491 FF          >      db 255
0346+++6492 FF          >      db 255
0346+++6493 FF          >      db 255
0346+++6494 FF          >      db 255
0346+++6495 FF          >      db 255
0346+++6496 FF          >      db 255
0346+++6497 FF          >      db 255
0346+++6498 FF          >      db 255
0346+++6499 FF          >      db 255
0346+++649A FF          >      db 255
0346+++649B FF          >      db 255
0346+++649C FF          >      db 255
0346+++649D FF          >      db 255
0346+++649E FF          >      db 255
0346+++649F FF          >      db 255
0346+++64A0 FF          >      db 255
0346+++64A1 FF          >      db 255
0346+++64A2 FF          >      db 255
0346+++64A3 FF          >      db 255
0346+++64A4 FF          >      db 255
0346+++64A5 FF          >      db 255
0346+++64A6 FF          >      db 255
0346+++64A7 FF          >      db 255
0346+++64A8 FF          >      db 255
0346+++64A9 FF          >      db 255
0346+++64AA FF          >      db 255
0346+++64AB FF          >      db 255
0346+++64AC FF          >      db 255
0346+++64AD FF          >      db 255
0346+++64AE FF          >      db 255
0346+++64AF FF          >      db 255
0346+++64B0 FF          >      db 255
0346+++64B1 FF          >      db 255
0346+++64B2 FF          >      db 255
0346+++64B3 FF          >      db 255
0346+++64B4 FF          >      db 255
0346+++64B5 FF          >      db 255
0346+++64B6 FF          >      db 255
0346+++64B7 FF          >      db 255
0347+++64B8             ;ALEKSIEEBEN.
0348+++64B8                   db 65+127+32, 76+127+32, 69+127+32, 75+127+32, 83+127+32, 73+127+32, 69+127+32, 69+127+32, 66+127+32, 69+127+32, 78+127+32, 223
0348+++64B8 E0EBE4EAF2E8E4E4E1E4EDDF
0349+++64C4                   rept    8
0350+++64C4~                  db 255
0351+++64C4                   endm
0351+++64C4 FF          >      db 255
0351+++64C5 FF          >      db 255
0351+++64C6 FF          >      db 255
0351+++64C7 FF          >      db 255
0351+++64C8 FF          >      db 255
0351+++64C9 FF          >      db 255
0351+++64CA FF          >      db 255
0351+++64CB FF          >      db 255
0352+++64CC             ;    BLOGSPOT.COM
0353+++64CC                   db 66+127+32, 76+127+32, 79+127+32, 71+127+32, 83+127+32, 80+127+32, 79+127+32, 84+127+32, 223, 67+127+32, 79+127+32, 77+127+32
0353+++64CC E1EBEEE6F2EFEEF3DFE2EEEC
0354+++64D8             
0355+++64D8             
0356+++64D8             
0357+++64D8             ;just before seq#5 clear text
0358+++64D8             ;seq#5
0359+++64D8             goodendtext9:
0360+++64D8             ;show text at 16,0
0361+++64D8             ;SAPPHIRE
0362+++64D8                   db 255,255,255,190,83+127, 65+127, 80+127, 80+127, 72+127, 73+127, 82+127, 69+127,190
0362+++64D8 FFFFFFBED2C0CFCFC7C8D1C4BE
0363+++64E5                  rept    2+16+3
0364+++64E5~                  db 255
0365+++64E5                   endm
0365+++64E5 FF          >      db 255
0365+++64E6 FF          >      db 255
0365+++64E7 FF          >      db 255
0365+++64E8 FF          >      db 255
0365+++64E9 FF          >      db 255
0365+++64EA FF          >      db 255
0365+++64EB FF          >      db 255
0365+++64EC FF          >      db 255
0365+++64ED FF          >      db 255
0365+++64EE FF          >      db 255
0365+++64EF FF          >      db 255
0365+++64F0 FF          >      db 255
0365+++64F1 FF          >      db 255
0365+++64F2 FF          >      db 255
0365+++64F3 FF          >      db 255
0365+++64F4 FF          >      db 255
0365+++64F5 FF          >      db 255
0365+++64F6 FF          >      db 255
0365+++64F7 FF          >      db 255
0365+++64F8 FF          >      db 255
0365+++64F9 FF          >      db 255
0366+++64FA             ;FOR HIS PT3
0367+++64FA                   db 70+127+32, 79+127+32, 82+127+32, 255, 72+127+32, 73+127+32, 83+127+32, 255, 80+127+32, 84+127+32, 172
0367+++64FA E5EEF1FFE7E8F2FFEFF3AC
0368+++6505                  rept    3+4
0369+++6505~                  db 255
0370+++6505                   endm
0370+++6505 FF          >      db 255
0370+++6506 FF          >      db 255
0370+++6507 FF          >      db 255
0370+++6508 FF          >      db 255
0370+++6509 FF          >      db 255
0370+++650A FF          >      db 255
0370+++650B FF          >      db 255
0371+++650C             ;AND SFX
0372+++650C                   db 65+127+32, 78+127+32, 68+127+32 ,255, 83+127+32, 70+127+32, 88+127+32
0372+++650C E0EDE3FFF2E5F7
0373+++6513                  rept    5+4
0374+++6513~                  db 255
0375+++6513                   endm
0375+++6513 FF          >      db 255
0375+++6514 FF          >      db 255
0375+++6515 FF          >      db 255
0375+++6516 FF          >      db 255
0375+++6517 FF          >      db 255
0375+++6518 FF          >      db 255
0375+++6519 FF          >      db 255
0375+++651A FF          >      db 255
0375+++651B FF          >      db 255
0376+++651C             
0377+++651C             ;REPLAYER
0378+++651C                   db 82+127+32, 69+127+32, 80+127+32, 76+127+32, 65+127+32, 89+127+32, 69+127+32, 82+127+32
0378+++651C F1E4EFEBE0F8E4F1
0379+++6524                  rept    16+16+16+16+4
0380+++6524~                  db 255
0381+++6524                   endm
0381+++6524 FF          >      db 255
0381+++6525 FF          >      db 255
0381+++6526 FF          >      db 255
0381+++6527 FF          >      db 255
0381+++6528 FF          >      db 255
0381+++6529 FF          >      db 255
0381+++652A FF          >      db 255
0381+++652B FF          >      db 255
0381+++652C FF          >      db 255
0381+++652D FF          >      db 255
0381+++652E FF          >      db 255
0381+++652F FF          >      db 255
0381+++6530 FF          >      db 255
0381+++6531 FF          >      db 255
0381+++6532 FF          >      db 255
0381+++6533 FF          >      db 255
0381+++6534 FF          >      db 255
0381+++6535 FF          >      db 255
0381+++6536 FF          >      db 255
0381+++6537 FF          >      db 255
0381+++6538 FF          >      db 255
0381+++6539 FF          >      db 255
0381+++653A FF          >      db 255
0381+++653B FF          >      db 255
0381+++653C FF          >      db 255
0381+++653D FF          >      db 255
0381+++653E FF          >      db 255
0381+++653F FF          >      db 255
0381+++6540 FF          >      db 255
0381+++6541 FF          >      db 255
0381+++6542 FF          >      db 255
0381+++6543 FF          >      db 255
0381+++6544 FF          >      db 255
0381+++6545 FF          >      db 255
0381+++6546 FF          >      db 255
0381+++6547 FF          >      db 255
0381+++6548 FF          >      db 255
0381+++6549 FF          >      db 255
0381+++654A FF          >      db 255
0381+++654B FF          >      db 255
0381+++654C FF          >      db 255
0381+++654D FF          >      db 255
0381+++654E FF          >      db 255
0381+++654F FF          >      db 255
0381+++6550 FF          >      db 255
0381+++6551 FF          >      db 255
0381+++6552 FF          >      db 255
0381+++6553 FF          >      db 255
0381+++6554 FF          >      db 255
0381+++6555 FF          >      db 255
0381+++6556 FF          >      db 255
0381+++6557 FF          >      db 255
0381+++6558 FF          >      db 255
0381+++6559 FF          >      db 255
0381+++655A FF          >      db 255
0381+++655B FF          >      db 255
0381+++655C FF          >      db 255
0381+++655D FF          >      db 255
0381+++655E FF          >      db 255
0381+++655F FF          >      db 255
0381+++6560 FF          >      db 255
0381+++6561 FF          >      db 255
0381+++6562 FF          >      db 255
0381+++6563 FF          >      db 255
0381+++6564 FF          >      db 255
0381+++6565 FF          >      db 255
0381+++6566 FF          >      db 255
0381+++6567 FF          >      db 255
0382+++6568             
0383+++6568             ;Z80ST-SOFTWARE.
0384+++6568                   db 90+127+32, 179, 'O'+127+32, 83+127+32, 84+127+32, 190, 83+127+32, 79+127+32, 70+127+32, 84+127+32, 87+127+32, 65+127+32, 82+127+32, 69+127+32,223,255
0384+++6568 F9B3EEF2F3BEF2EEE5F3F6E0F1E4DFFF
0385+++6578             ;    BLOGSPOT.COM
0386+++6578                   db 255, 255, 255, 255, 66+127+32, 76+127+32, 79+127+32, 71+127+32, 83+127+32, 80+127+32, 79+127+32, 84+127+32, 223, 67+127+32, 79+127+32,77+127+32
0386+++6578 FFFFFFFFE1EBEEE6F2EFEEF3DFE2EEEC
0387+++6588             
0388+++6588             
0389+++6588             ;just before seq#6 clear text
0390+++6588             ;seq#6
0391+++6588             goodendtext10:
0392+++6588             ;show text at 16,0
0393+++6588             ;SHIRU
0394+++6588                   db 255,255,255,255,190,83+127, 72+127, 73+127, 82+127, 85+127,190
0394+++6588 FFFFFFFFBED2C7C8D1D4BE
0395+++6593                  rept    5+16+4
0396+++6593~                  db 255
0397+++6593                   endm
0397+++6593 FF          >      db 255
0397+++6594 FF          >      db 255
0397+++6595 FF          >      db 255
0397+++6596 FF          >      db 255
0397+++6597 FF          >      db 255
0397+++6598 FF          >      db 255
0397+++6599 FF          >      db 255
0397+++659A FF          >      db 255
0397+++659B FF          >      db 255
0397+++659C FF          >      db 255
0397+++659D FF          >      db 255
0397+++659E FF          >      db 255
0397+++659F FF          >      db 255
0397+++65A0 FF          >      db 255
0397+++65A1 FF          >      db 255
0397+++65A2 FF          >      db 255
0397+++65A3 FF          >      db 255
0397+++65A4 FF          >      db 255
0397+++65A5 FF          >      db 255
0397+++65A6 FF          >      db 255
0397+++65A7 FF          >      db 255
0397+++65A8 FF          >      db 255
0397+++65A9 FF          >      db 255
0397+++65AA FF          >      db 255
0397+++65AB FF          >      db 255
0398+++65AC             ;FOR HIS
0399+++65AC                  db 70+127+32, 79+127+32, 82+127+32, 255, 72+127+32, 73+127+32, 83+127+32
0399+++65AC E5EEF1FFE7E8F2
0400+++65B3                  rept    5+4
0401+++65B3~                  db 255
0402+++65B3                   endm
0402+++65B3 FF          >      db 255
0402+++65B4 FF          >      db 255
0402+++65B5 FF          >      db 255
0402+++65B6 FF          >      db 255
0402+++65B7 FF          >      db 255
0402+++65B8 FF          >      db 255
0402+++65B9 FF          >      db 255
0402+++65BA FF          >      db 255
0402+++65BB FF          >      db 255
0403+++65BC             ; AYFXEDIT
0404+++65BC                   db 65+127+32, 89+127+32, 70+127+32, 88+127+32, 69+127+32, 68+127+32, 73+127+32, 84+127+32
0404+++65BC E0F8E5F7E4E3E8F3
0405+++65C4                  rept    4+16+16+16+16+16
0406+++65C4~                  db 255
0407+++65C4                   endm
0407+++65C4 FF          >      db 255
0407+++65C5 FF          >      db 255
0407+++65C6 FF          >      db 255
0407+++65C7 FF          >      db 255
0407+++65C8 FF          >      db 255
0407+++65C9 FF          >      db 255
0407+++65CA FF          >      db 255
0407+++65CB FF          >      db 255
0407+++65CC FF          >      db 255
0407+++65CD FF          >      db 255
0407+++65CE FF          >      db 255
0407+++65CF FF          >      db 255
0407+++65D0 FF          >      db 255
0407+++65D1 FF          >      db 255
0407+++65D2 FF          >      db 255
0407+++65D3 FF          >      db 255
0407+++65D4 FF          >      db 255
0407+++65D5 FF          >      db 255
0407+++65D6 FF          >      db 255
0407+++65D7 FF          >      db 255
0407+++65D8 FF          >      db 255
0407+++65D9 FF          >      db 255
0407+++65DA FF          >      db 255
0407+++65DB FF          >      db 255
0407+++65DC FF          >      db 255
0407+++65DD FF          >      db 255
0407+++65DE FF          >      db 255
0407+++65DF FF          >      db 255
0407+++65E0 FF          >      db 255
0407+++65E1 FF          >      db 255
0407+++65E2 FF          >      db 255
0407+++65E3 FF          >      db 255
0407+++65E4 FF          >      db 255
0407+++65E5 FF          >      db 255
0407+++65E6 FF          >      db 255
0407+++65E7 FF          >      db 255
0407+++65E8 FF          >      db 255
0407+++65E9 FF          >      db 255
0407+++65EA FF          >      db 255
0407+++65EB FF          >      db 255
0407+++65EC FF          >      db 255
0407+++65ED FF          >      db 255
0407+++65EE FF          >      db 255
0407+++65EF FF          >      db 255
0407+++65F0 FF          >      db 255
0407+++65F1 FF          >      db 255
0407+++65F2 FF          >      db 255
0407+++65F3 FF          >      db 255
0407+++65F4 FF          >      db 255
0407+++65F5 FF          >      db 255
0407+++65F6 FF          >      db 255
0407+++65F7 FF          >      db 255
0407+++65F8 FF          >      db 255
0407+++65F9 FF          >      db 255
0407+++65FA FF          >      db 255
0407+++65FB FF          >      db 255
0407+++65FC FF          >      db 255
0407+++65FD FF          >      db 255
0407+++65FE FF          >      db 255
0407+++65FF FF          >      db 255
0407+++6600 FF          >      db 255
0407+++6601 FF          >      db 255
0407+++6602 FF          >      db 255
0407+++6603 FF          >      db 255
0407+++6604 FF          >      db 255
0407+++6605 FF          >      db 255
0407+++6606 FF          >      db 255
0407+++6607 FF          >      db 255
0407+++6608 FF          >      db 255
0407+++6609 FF          >      db 255
0407+++660A FF          >      db 255
0407+++660B FF          >      db 255
0407+++660C FF          >      db 255
0407+++660D FF          >      db 255
0407+++660E FF          >      db 255
0407+++660F FF          >      db 255
0407+++6610 FF          >      db 255
0407+++6611 FF          >      db 255
0407+++6612 FF          >      db 255
0407+++6613 FF          >      db 255
0407+++6614 FF          >      db 255
0407+++6615 FF          >      db 255
0407+++6616 FF          >      db 255
0407+++6617 FF          >      db 255
0408+++6618             ;SHIRU.
0409+++6618                   db 83+127+32, 72+127+32, 73+127+32, 82+127+32, 85+127+32, 223
0409+++6618 F2E7E8F1F4DF
0410+++661E                   rept    12
0411+++661E~                  db 255
0412+++661E                   endm
0412+++661E FF          >      db 255
0412+++661F FF          >      db 255
0412+++6620 FF          >      db 255
0412+++6621 FF          >      db 255
0412+++6622 FF          >      db 255
0412+++6623 FF          >      db 255
0412+++6624 FF          >      db 255
0412+++6625 FF          >      db 255
0412+++6626 FF          >      db 255
0412+++6627 FF          >      db 255
0412+++6628 FF          >      db 255
0412+++6629 FF          >      db 255
0413+++662A             ;  UNTERGRUND.NET
0414+++662A                   db 85+127+32, 78+127+32, 84+127+32, 69+127+32, 82+127+32, 71+127+32, 82+127+32, 85+127+32, 78+127+32, 68+127+32, 223, 78+127+32, 69+127+32, 84+127+32
0414+++662A F4EDF3E4F1E6F1F4EDE3DFEDE4F3
0415+++6638             
0416+++6638             
0417+++6638             ;just before seq#7 clear text
0418+++6638             ;seq#7
0419+++6638             goodendtext11
0420+++6638             ;show text at 16,3
0421+++6638             ;SERGEY BULBA
0422+++6638                   db 255,190,83+127, 69+127, 82+127, 71+127, 69+127, 89+127, 255, 66+127, 85+127, 76+127, 66+127, 65+127 ,190
0422+++6638 FFBED2C4D1C6C4D8FFC1D4CBC1C0BE
0423+++6647             ; skip a line
0424+++6647                   rept    1+16+3
0425+++6647~                  db 255
0426+++6647                   endm
0426+++6647 FF          >      db 255
0426+++6648 FF          >      db 255
0426+++6649 FF          >      db 255
0426+++664A FF          >      db 255
0426+++664B FF          >      db 255
0426+++664C FF          >      db 255
0426+++664D FF          >      db 255
0426+++664E FF          >      db 255
0426+++664F FF          >      db 255
0426+++6650 FF          >      db 255
0426+++6651 FF          >      db 255
0426+++6652 FF          >      db 255
0426+++6653 FF          >      db 255
0426+++6654 FF          >      db 255
0426+++6655 FF          >      db 255
0426+++6656 FF          >      db 255
0426+++6657 FF          >      db 255
0426+++6658 FF          >      db 255
0426+++6659 FF          >      db 255
0426+++665A FF          >      db 255
0427+++665B             
0428+++665B             ;FOR VORTEX
0429+++665B                   db 70+127+32, 79+127+32, 82+127+32, 255, 86+127+32, 79+127+32, 82+127+32, 84+127+32, 69+127+32, 88+127+32
0429+++665B E5EEF1FFF5EEF1F3E4F7
0430+++6665                   rept    3+3
0431+++6665~                  db 255
0432+++6665                   endm
0432+++6665 FF          >      db 255
0432+++6666 FF          >      db 255
0432+++6667 FF          >      db 255
0432+++6668 FF          >      db 255
0432+++6669 FF          >      db 255
0432+++666A FF          >      db 255
0433+++666B             
0434+++666B             ;TRACKER II
0435+++666B                   db 84+127+32, 82+127+32, 65+127+32, 67+127+32, 75+127+32, 69+127+32, 82+127+32, 255, 73+127+32, 73+127+32
0435+++666B F3F1E0E2EAE4F1FFE8E8
0436+++6675                   rept    3+16+16+16+16+16
0437+++6675~                  db 255
0438+++6675                   endm
0438+++6675 FF          >      db 255
0438+++6676 FF          >      db 255
0438+++6677 FF          >      db 255
0438+++6678 FF          >      db 255
0438+++6679 FF          >      db 255
0438+++667A FF          >      db 255
0438+++667B FF          >      db 255
0438+++667C FF          >      db 255
0438+++667D FF          >      db 255
0438+++667E FF          >      db 255
0438+++667F FF          >      db 255
0438+++6680 FF          >      db 255
0438+++6681 FF          >      db 255
0438+++6682 FF          >      db 255
0438+++6683 FF          >      db 255
0438+++6684 FF          >      db 255
0438+++6685 FF          >      db 255
0438+++6686 FF          >      db 255
0438+++6687 FF          >      db 255
0438+++6688 FF          >      db 255
0438+++6689 FF          >      db 255
0438+++668A FF          >      db 255
0438+++668B FF          >      db 255
0438+++668C FF          >      db 255
0438+++668D FF          >      db 255
0438+++668E FF          >      db 255
0438+++668F FF          >      db 255
0438+++6690 FF          >      db 255
0438+++6691 FF          >      db 255
0438+++6692 FF          >      db 255
0438+++6693 FF          >      db 255
0438+++6694 FF          >      db 255
0438+++6695 FF          >      db 255
0438+++6696 FF          >      db 255
0438+++6697 FF          >      db 255
0438+++6698 FF          >      db 255
0438+++6699 FF          >      db 255
0438+++669A FF          >      db 255
0438+++669B FF          >      db 255
0438+++669C FF          >      db 255
0438+++669D FF          >      db 255
0438+++669E FF          >      db 255
0438+++669F FF          >      db 255
0438+++66A0 FF          >      db 255
0438+++66A1 FF          >      db 255
0438+++66A2 FF          >      db 255
0438+++66A3 FF          >      db 255
0438+++66A4 FF          >      db 255
0438+++66A5 FF          >      db 255
0438+++66A6 FF          >      db 255
0438+++66A7 FF          >      db 255
0438+++66A8 FF          >      db 255
0438+++66A9 FF          >      db 255
0438+++66AA FF          >      db 255
0438+++66AB FF          >      db 255
0438+++66AC FF          >      db 255
0438+++66AD FF          >      db 255
0438+++66AE FF          >      db 255
0438+++66AF FF          >      db 255
0438+++66B0 FF          >      db 255
0438+++66B1 FF          >      db 255
0438+++66B2 FF          >      db 255
0438+++66B3 FF          >      db 255
0438+++66B4 FF          >      db 255
0438+++66B5 FF          >      db 255
0438+++66B6 FF          >      db 255
0438+++66B7 FF          >      db 255
0438+++66B8 FF          >      db 255
0438+++66B9 FF          >      db 255
0438+++66BA FF          >      db 255
0438+++66BB FF          >      db 255
0438+++66BC FF          >      db 255
0438+++66BD FF          >      db 255
0438+++66BE FF          >      db 255
0438+++66BF FF          >      db 255
0438+++66C0 FF          >      db 255
0438+++66C1 FF          >      db 255
0438+++66C2 FF          >      db 255
0438+++66C3 FF          >      db 255
0438+++66C4 FF          >      db 255
0438+++66C5 FF          >      db 255
0438+++66C6 FF          >      db 255
0438+++66C7 FF          >      db 255
0439+++66C8             
0440+++66C8             ; skip a line
0441+++66C8             
0442+++66C8             ;BULBA.
0443+++66C8                   db 66+127+32, 85+127+32, 76+127+32, 66+127+32, 65+127+32, 223
0443+++66C8 E1F4EBE1E0DF
0444+++66CE                   rept    10+2
0445+++66CE~                  db 255
0446+++66CE                   endm
0446+++66CE FF          >      db 255
0446+++66CF FF          >      db 255
0446+++66D0 FF          >      db 255
0446+++66D1 FF          >      db 255
0446+++66D2 FF          >      db 255
0446+++66D3 FF          >      db 255
0446+++66D4 FF          >      db 255
0446+++66D5 FF          >      db 255
0446+++66D6 FF          >      db 255
0446+++66D7 FF          >      db 255
0446+++66D8 FF          >      db 255
0446+++66D9 FF          >      db 255
0447+++66DA             
0448+++66DA             ;  UNTERGRUND.NET
0449+++66DA                   db 85+127+32, 78+127+32, 84+127+32, 69+127+32, 82+127+32, 71+127+32, 82+127+32, 85+127+32, 78+127+32, 68+127+32, 223, 78+127+32, 69+127+32,84+127+32
0449+++66DA F4EDF3E4F1E6F1F4EDE3DFEDE4F3
0450+++66E8             
0451+++66E8             ;just before seq#8 clear text
0452+++66E8             ;seq#8
0453+++66E8             goodendtext12
0454+++66E8             ;show text at 16,0
0455+++66E8                   rept    5
0456+++66E8~                  db 255
0457+++66E8                   endm
0457+++66E8 FF          >      db 255
0457+++66E9 FF          >      db 255
0457+++66EA FF          >      db 255
0457+++66EB FF          >      db 255
0457+++66EC FF          >      db 255
0458+++66ED D7 CB AE D2     db  'X'+127, 'L'+127, 174, 'S'+127
0459+++66F1             
0460+++66F1                   rept    7
0461+++66F1~                  db 255
0462+++66F1                   endm
0462+++66F1 FF          >      db 255
0462+++66F2 FF          >      db 255
0462+++66F3 FF          >      db 255
0462+++66F4 FF          >      db 255
0462+++66F5 FF          >      db 255
0462+++66F6 FF          >      db 255
0462+++66F7 FF          >      db 255
0463+++66F8                 db 190, 'E'+127, 'N'+127, 'T'+127, 'E'+127, 'R'+127, 'T'+127, 'A'+127, 'I'+127, 'N'+127, 'M'+127, 'E'+127, 'N'+127, 'T'+127, 190,255
0463+++66F8 BEC4CDD3C4D1D3C0C8CDCCC4CDD3BEFF
0464+++6708                   rept    16+3
0465+++6708~                  db 255
0466+++6708                   endm
0466+++6708 FF          >      db 255
0466+++6709 FF          >      db 255
0466+++670A FF          >      db 255
0466+++670B FF          >      db 255
0466+++670C FF          >      db 255
0466+++670D FF          >      db 255
0466+++670E FF          >      db 255
0466+++670F FF          >      db 255
0466+++6710 FF          >      db 255
0466+++6711 FF          >      db 255
0466+++6712 FF          >      db 255
0466+++6713 FF          >      db 255
0466+++6714 FF          >      db 255
0466+++6715 FF          >      db 255
0466+++6716 FF          >      db 255
0466+++6717 FF          >      db 255
0466+++6718 FF          >      db 255
0466+++6719 FF          >      db 255
0466+++671A FF          >      db 255
0467+++671B             
0468+++671B                 db 'F'+127+32,'O'+127+32,'R'+127+32,255,'S'+127+32,'J'+127+32,'A'+127+32,'S'+127+32,'M'+127+32
0468+++671B E5EEF1FFF2E9E0F2EC
0469+++6724                   rept    4+2
0470+++6724~                  db 255
0471+++6724                   endm
0471+++6724 FF          >      db 255
0471+++6725 FF          >      db 255
0471+++6726 FF          >      db 255
0471+++6727 FF          >      db 255
0471+++6728 FF          >      db 255
0471+++6729 FF          >      db 255
0472+++672A                 db 'A'+127+32,'N'+127+32,'D'+127+32,255,'P'+127+32,'L'+127+32,'E'+127+32,'T'+127+32,'T'+127+32,'E'+127+32,'R'+127+32,255,255,255
0472+++672A E0EDE3FFEFEBE4F3F3E4F1FFFFFF
0473+++6738             
0474+++6738             
0475+++6738             
0476+++6738             
0477+++6738             
0478+++6738             ;just before seq#9 clear text
0479+++6738             ;seq#9
0480+++6738             goodendtext13:
0481+++6738             ;show text at 16,0
0482+++6738             ;DVIK-HAP-MANUEL
0483+++6738                   db 68+127, 86+127, 73+127, 75+127, 190, 72+127, 65+127, 80+127, 190, 77+127, 65+127, 78+127, 85+127, 69+127, 76+127
0483+++6738 C3D5C8CABEC7C0CFBECCC0CDD4C4CB
0484+++6747                   rept    1+16
0485+++6747~                  db 255
0486+++6747                   endm
0486+++6747 FF          >      db 255
0486+++6748 FF          >      db 255
0486+++6749 FF          >      db 255
0486+++674A FF          >      db 255
0486+++674B FF          >      db 255
0486+++674C FF          >      db 255
0486+++674D FF          >      db 255
0486+++674E FF          >      db 255
0486+++674F FF          >      db 255
0486+++6750 FF          >      db 255
0486+++6751 FF          >      db 255
0486+++6752 FF          >      db 255
0486+++6753 FF          >      db 255
0486+++6754 FF          >      db 255
0486+++6755 FF          >      db 255
0486+++6756 FF          >      db 255
0486+++6757 FF          >      db 255
0487+++6758             
0488+++6758             ; skip a line
0489+++6758             
0490+++6758             ;FOR THEIR GREAT
0491+++6758                   db 70+127+32, 79+127+32, 82+127+32, 255, 84+127+32, 72+127+32, 69+127+32, 73+127+32, 82+127+32, 255, 71+127+32, 82+127+32, 69+127+32, 65+127+32,84+127+32,255
0491+++6758 E5EEF1FFF3E7E4E8F1FFE6F1E4E0F3FF
0492+++6768             ;SUPPORT ON
0493+++6768                   db 255,255,255,83+127+32, 85+127+32, 80+127+32, 80+127+32, 79+127+32, 82+127+32, 84+127+32, 255, 79+127+32, 78+127+32
0493+++6768 FFFFFFF2F4EFEFEEF1F3FFEEED
0494+++6775             ; skip a line
0495+++6775                   rept    3+16+5
0496+++6775~                  db 255
0497+++6775                   endm
0497+++6775 FF          >      db 255
0497+++6776 FF          >      db 255
0497+++6777 FF          >      db 255
0497+++6778 FF          >      db 255
0497+++6779 FF          >      db 255
0497+++677A FF          >      db 255
0497+++677B FF          >      db 255
0497+++677C FF          >      db 255
0497+++677D FF          >      db 255
0497+++677E FF          >      db 255
0497+++677F FF          >      db 255
0497+++6780 FF          >      db 255
0497+++6781 FF          >      db 255
0497+++6782 FF          >      db 255
0497+++6783 FF          >      db 255
0497+++6784 FF          >      db 255
0497+++6785 FF          >      db 255
0497+++6786 FF          >      db 255
0497+++6787 FF          >      db 255
0497+++6788 FF          >      db 255
0497+++6789 FF          >      db 255
0497+++678A FF          >      db 255
0497+++678B FF          >      db 255
0497+++678C FF          >      db 255
0498+++678D             
0499+++678D             ;MEISEI
0500+++678D                  db 77+127+32, 69+127+32, 73+127+32, 83+127+32, 69+127+32, 73+127+32
0500+++678D ECE4E8F2E4E8
0501+++6793                   rept    5+4
0502+++6793~                  db 255
0503+++6793                   endm
0503+++6793 FF          >      db 255
0503+++6794 FF          >      db 255
0503+++6795 FF          >      db 255
0503+++6796 FF          >      db 255
0503+++6797 FF          >      db 255
0503+++6798 FF          >      db 255
0503+++6799 FF          >      db 255
0503+++679A FF          >      db 255
0503+++679B FF          >      db 255
0504+++679C             
0505+++679C             ;    BLUEMSX
0506+++679C                  db 66+127+32, 76+127+32, 85+127+32, 69+127+32, 77+127+32, 83+127+32, 88+127+32
0506+++679C E1EBF4E4ECF2F7
0507+++67A3                   rept    5+4
0508+++67A3~                  db 255
0509+++67A3                   endm
0509+++67A3 FF          >      db 255
0509+++67A4 FF          >      db 255
0509+++67A5 FF          >      db 255
0509+++67A6 FF          >      db 255
0509+++67A7 FF          >      db 255
0509+++67A8 FF          >      db 255
0509+++67A9 FF          >      db 255
0509+++67AA FF          >      db 255
0509+++67AB FF          >      db 255
0510+++67AC                  ;         OPENMSX
0511+++67AC                  db 79+127+32, 80+127+32, 69+127+32, 78+127+32, 77+127+32, 83+127+32, 88+127+32,255,255,255,255,255
0511+++67AC EEEFE4EDECF2F7FFFFFFFFFF
0512+++67B8             
0513+++67B8             ;just before seq#10 clear text
0514+++67B8             ;seq#10
0515+++67B8             goodendtext14
0516+++67B8             ;show text at 16,0
0517+++67B8             ; MATRA AND
0518+++67B8                   db 255,255,255,'M'+127,'A'+127,'T'+127,'R'+127,'A'+127,' '+127,'A'+127,'N'+127,'D'+127,255,255,255,255
0518+++67B8 FFFFFFCCC0D3D1C09FC0CDC3FFFFFFFF
0519+++67C8             ;- BITWISE -
0520+++67C8                   db 255,255,190,255,'B'+127,'I'+127,'T'+127,'W'+127,'I'+127,'S'+127,'E'+127,255,190,255,255,255
0520+++67C8 FFFFBEFFC1C8D3D6C8D2C4FFBEFFFFFF
0521+++67D8                   rept    16
0522+++67D8~                  db 255
0523+++67D8                   endm
0523+++67D8 FF          >      db 255
0523+++67D9 FF          >      db 255
0523+++67DA FF          >      db 255
0523+++67DB FF          >      db 255
0523+++67DC FF          >      db 255
0523+++67DD FF          >      db 255
0523+++67DE FF          >      db 255
0523+++67DF FF          >      db 255
0523+++67E0 FF          >      db 255
0523+++67E1 FF          >      db 255
0523+++67E2 FF          >      db 255
0523+++67E3 FF          >      db 255
0523+++67E4 FF          >      db 255
0523+++67E5 FF          >      db 255
0523+++67E6 FF          >      db 255
0523+++67E7 FF          >      db 255
0524+++67E8             ;FOR DEBUGGING,
0525+++67E8                   db 255, 'F'+127+32,'O'+127+32,'R'+127+32,255,'D'+127+32,'E'+127+32,'B'+127+32,'U'+127+32,'G'+127+32,'G'+127+32,'I'+127+32,'N'+127+32,'G'+127+32,222,255
0525+++67E8 FFE5EEF1FFE3E4E1F4E6E6E8EDE6DEFF
0526+++67F8             ;PRODUCTION AND
0527+++67F8                   db 255, 'P'+127+32,'R'+127+32,'O'+127+32,'D'+127+32,'U'+127+32,'C'+127+32,'T'+127+32,'I'+127+32,'O'+127+32,'N'+127+32,255,'A'+127+32,'N'+127+32,'D'+127+32,255
0527+++67F8 FFEFF1EEE3F4E2F3E8EEEDFFE0EDE3FF
0528+++6808             ;DISTRIBUTION
0529+++6808                   db 255,'D'+127+32,'I'+127+32,'S'+127+32,'T'+127+32,'R'+127+32,'I'+127+32,'B'+127+32,'U'+127+32,'T'+127+32,'I'+127+32,'O'+127+32,'N'+127+32,255,255,255
0529+++6808 FFE3E8F2F3F1E8E1F4F3E8EEEDFFFFFF
0530+++6818             ;OF THIS GAME
0531+++6818                   db 255, 'O'+127+32,'F'+127+32,255,'T'+127+32,'H'+127+32,'I'+127+32,'S'+127+32,255,'G'+127+32,'A'+127+32,'M'+127+32,'E'+127+32,255,255,255
0531+++6818 FFEEE5FFF3E7E8F2FFE6E0ECE4FFFFFF
0532+++6828             ;ON SHOCKWARE.
0533+++6828                   db 255, 'O'+127+32,'N'+127+32,255,'S'+127+32,'H'+127+32,'O'+127+32,'C'+127+32,'K'+127+32,'W'+127+32,'A'+127+32,'R'+127+32,'E'+127+32,223,255,255
0533+++6828 FFEEEDFFF2E7EEE2EAF6E0F1E4DFFFFF
0534+++6838                   rept    16
0535+++6838~                  db 255
0536+++6838                   endm
0536+++6838 FF          >      db 255
0536+++6839 FF          >      db 255
0536+++683A FF          >      db 255
0536+++683B FF          >      db 255
0536+++683C FF          >      db 255
0536+++683D FF          >      db 255
0536+++683E FF          >      db 255
0536+++683F FF          >      db 255
0536+++6840 FF          >      db 255
0536+++6841 FF          >      db 255
0536+++6842 FF          >      db 255
0536+++6843 FF          >      db 255
0536+++6844 FF          >      db 255
0536+++6845 FF          >      db 255
0536+++6846 FF          >      db 255
0536+++6847 FF          >      db 255
0537+++6848             ;MATRANET.NET
0538+++6848                   db 255,255,255,'M'+127+32,'A'+127+32,'T'+127+32,'R'+127+32,'A'+127+32,'N'+127+32,'E'+127+32,'T'+127+32,223,'N'+127+32,'E'+127+32,'T'+127+32,255,255
0538+++6848 FFFFFFECE0F3F1E0EDE4F3DFEDE4F3FFFF
0539+++6859             
0540+++6859             
0541+++6859             
0542+++6859             
0543+++6859             ;just before seq#11 clear text
0544+++6859             ;seq#11
0545+++6859             goodendtext15
0546+++6859             ;show text at 16,3
0547+++6859             ;AND OF COURSE
0548+++6859                   db 255,65+127, 78+127, 68+127, 255, 79+127, 70+127, 255, 67+127, 79+127, 85+127, 82+127, 83+127, 69+127
0548+++6859 FFC0CDC3FFCEC5FFC2CED4D1D2C4
0549+++6867             ;     YOU
0550+++6867                   rept    2+16+6
0551+++6867~                  db 255
0552+++6867                   endm
0552+++6867 FF          >      db 255
0552+++6868 FF          >      db 255
0552+++6869 FF          >      db 255
0552+++686A FF          >      db 255
0552+++686B FF          >      db 255
0552+++686C FF          >      db 255
0552+++686D FF          >      db 255
0552+++686E FF          >      db 255
0552+++686F FF          >      db 255
0552+++6870 FF          >      db 255
0552+++6871 FF          >      db 255
0552+++6872 FF          >      db 255
0552+++6873 FF          >      db 255
0552+++6874 FF          >      db 255
0552+++6875 FF          >      db 255
0552+++6876 FF          >      db 255
0552+++6877 FF          >      db 255
0552+++6878 FF          >      db 255
0552+++6879 FF          >      db 255
0552+++687A FF          >      db 255
0552+++687B FF          >      db 255
0552+++687C FF          >      db 255
0552+++687D FF          >      db 255
0552+++687E FF          >      db 255
0553+++687F D8 CE D4          db 89+127, 79+127, 85+127
0554+++6882                   rept   7+16+16+1
0555+++6882~                  db 255
0556+++6882                   endm
0556+++6882 FF          >      db 255
0556+++6883 FF          >      db 255
0556+++6884 FF          >      db 255
0556+++6885 FF          >      db 255
0556+++6886 FF          >      db 255
0556+++6887 FF          >      db 255
0556+++6888 FF          >      db 255
0556+++6889 FF          >      db 255
0556+++688A FF          >      db 255
0556+++688B FF          >      db 255
0556+++688C FF          >      db 255
0556+++688D FF          >      db 255
0556+++688E FF          >      db 255
0556+++688F FF          >      db 255
0556+++6890 FF          >      db 255
0556+++6891 FF          >      db 255
0556+++6892 FF          >      db 255
0556+++6893 FF          >      db 255
0556+++6894 FF          >      db 255
0556+++6895 FF          >      db 255
0556+++6896 FF          >      db 255
0556+++6897 FF          >      db 255
0556+++6898 FF          >      db 255
0556+++6899 FF          >      db 255
0556+++689A FF          >      db 255
0556+++689B FF          >      db 255
0556+++689C FF          >      db 255
0556+++689D FF          >      db 255
0556+++689E FF          >      db 255
0556+++689F FF          >      db 255
0556+++68A0 FF          >      db 255
0556+++68A1 FF          >      db 255
0556+++68A2 FF          >      db 255
0556+++68A3 FF          >      db 255
0556+++68A4 FF          >      db 255
0556+++68A5 FF          >      db 255
0556+++68A6 FF          >      db 255
0556+++68A7 FF          >      db 255
0556+++68A8 FF          >      db 255
0556+++68A9 FF          >      db 255
0557+++68AA             
0558+++68AA             ; skip a line
0559+++68AA             
0560+++68AA             ;THANK YOU FOR
0561+++68AA                   db 84+127+32, 72+127+32, 65+127+32, 78+127+32, 75+127+32, 255, 89+127+32, 79+127+32, 85+127+32, 255, 70+127+32, 79+127+32, 82+127+32,255,255
0561+++68AA F3E7E0EDEAFFF8EEF4FFE5EEF1FFFF
0562+++68B9             ;PLAYING
0563+++68B9                   db 255,255,255,255,80+127+32, 76+127+32, 65+127+32, 89+127+32, 73+127+32, 78+127+32, 71+127+32
0563+++68B9 FFFFFFFFEFEBE0F8E8EDE6
0564+++68C4                   rept    5
0565+++68C4~                  db 255
0566+++68C4                   endm
0566+++68C4 FF          >      db 255
0566+++68C5 FF          >      db 255
0566+++68C6 FF          >      db 255
0566+++68C7 FF          >      db 255
0566+++68C8 FF          >      db 255
0567+++68C9             
0568+++68C9             ;just before seq#12 clear text
0569+++68C9             ;seq#12
0570+++68C9             goodendtext16
0571+++68C9             ;show text at 16,0
0572+++68C9             ;  DEEP DUNGEON
0573+++68C9                   db 255,'D'+127,'E'+127,'E'+127,'P'+127, 255,   255,'D'+127,'U'+127,'N'+127,'G'+127,'E'+127,'O'+127,'N'+127,255,255
0573+++68C9 FFC3C4C4CFFFFFC3D4CDC6C4CECDFFFF
0574+++68D9             ;ADVENTURE
0575+++68D9                   db  255, 255, 255,'A'+127,'D'+127,'V'+127,'E'+127,'N'+127,'T'+127,'U'+127,'R'+127,'E'+127, 255, 255, 255, 255
0575+++68D9 FFFFFFC0C3D5C4CDD3D4D1C4FFFFFFFF
0576+++68E9                   rept    64
0577+++68E9~                  db 255
0578+++68E9                   endm
0578+++68E9 FF          >      db 255
0578+++68EA FF          >      db 255
0578+++68EB FF          >      db 255
0578+++68EC FF          >      db 255
0578+++68ED FF          >      db 255
0578+++68EE FF          >      db 255
0578+++68EF FF          >      db 255
0578+++68F0 FF          >      db 255
0578+++68F1 FF          >      db 255
0578+++68F2 FF          >      db 255
0578+++68F3 FF          >      db 255
0578+++68F4 FF          >      db 255
0578+++68F5 FF          >      db 255
0578+++68F6 FF          >      db 255
0578+++68F7 FF          >      db 255
0578+++68F8 FF          >      db 255
0578+++68F9 FF          >      db 255
0578+++68FA FF          >      db 255
0578+++68FB FF          >      db 255
0578+++68FC FF          >      db 255
0578+++68FD FF          >      db 255
0578+++68FE FF          >      db 255
0578+++68FF FF          >      db 255
0578+++6900 FF          >      db 255
0578+++6901 FF          >      db 255
0578+++6902 FF          >      db 255
0578+++6903 FF          >      db 255
0578+++6904 FF          >      db 255
0578+++6905 FF          >      db 255
0578+++6906 FF          >      db 255
0578+++6907 FF          >      db 255
0578+++6908 FF          >      db 255
0578+++6909 FF          >      db 255
0578+++690A FF          >      db 255
0578+++690B FF          >      db 255
0578+++690C FF          >      db 255
0578+++690D FF          >      db 255
0578+++690E FF          >      db 255
0578+++690F FF          >      db 255
0578+++6910 FF          >      db 255
0578+++6911 FF          >      db 255
0578+++6912 FF          >      db 255
0578+++6913 FF          >      db 255
0578+++6914 FF          >      db 255
0578+++6915 FF          >      db 255
0578+++6916 FF          >      db 255
0578+++6917 FF          >      db 255
0578+++6918 FF          >      db 255
0578+++6919 FF          >      db 255
0578+++691A FF          >      db 255
0578+++691B FF          >      db 255
0578+++691C FF          >      db 255
0578+++691D FF          >      db 255
0578+++691E FF          >      db 255
0578+++691F FF          >      db 255
0578+++6920 FF          >      db 255
0578+++6921 FF          >      db 255
0578+++6922 FF          >      db 255
0578+++6923 FF          >      db 255
0578+++6924 FF          >      db 255
0578+++6925 FF          >      db 255
0578+++6926 FF          >      db 255
0578+++6927 FF          >      db 255
0578+++6928 FF          >      db 255
0579+++6929             ;C 2009 TRILOBYTE
0580+++6929                 db 188,    255,    174,'O'+127,'O'+127,    181,    255,'T'+127,'R'+127,'I'+127,'L'+127,'O'+127,'B'+127,'Y'+127,'T'+127,'E'+127
0580+++6929 BCFFAECECEB5FFD3D1C8CBCEC1D8D3C4
0581+++6939             
0582+++6939             
0583+++6939             goodendtext17
0584+++6939             ; THE END
0585+++6939                   db 255,255,255,255,'T'+127,'H'+127,'E'+127,255,'E'+127,'N'+127,'D'+127,255,255,255,255,255
0585+++6939 FFFFFFFFD3C7C4FFC4CDC3FFFFFFFFFF
0586+++6949             
0587+++6949             
0588+++6949             goodendtext18
0589+++6949             ;AND REMEMBER:
0590+++6949              db 'A'+127+32,'N'+127+32,'D'+127+32,255,'R'+127+32,'E'+127+32,'M'+127+32,'E'+127+32,'M'+127+32,'B'+127+32,'E'+127+32,'R'+127+32, 189,255,255,255
0590+++6949 E0EDE3FFF1E4ECE4ECE1E4F1BDFFFFFF
0591+++6959                   rept    16
0592+++6959~                  db 255
0593+++6959                   endm
0593+++6959 FF          >      db 255
0593+++695A FF          >      db 255
0593+++695B FF          >      db 255
0593+++695C FF          >      db 255
0593+++695D FF          >      db 255
0593+++695E FF          >      db 255
0593+++695F FF          >      db 255
0593+++6960 FF          >      db 255
0593+++6961 FF          >      db 255
0593+++6962 FF          >      db 255
0593+++6963 FF          >      db 255
0593+++6964 FF          >      db 255
0593+++6965 FF          >      db 255
0593+++6966 FF          >      db 255
0593+++6967 FF          >      db 255
0593+++6968 FF          >      db 255
0594+++6969             ;WOULD YOU EVER
0595+++6969               db 'W'+127+32,'O'+127+32,'U'+127+32,'L'+127+32,'D'+127+32,255,'Y'+127+32,'O'+127+32,'U'+127+32,255,'E'+127+32,'V'+127+32,'E'+127+32,'R'+127+32,255,255
0595+++6969 F6EEF4EBE3FFF8EEF4FFE4F5E4F1FFFF
0596+++6979             ;DESIRE TO SEE
0597+++6979               db 'D'+127+32,'E'+127+32,'S'+127+32,'I'+127+32,'R'+127+32,'E'+127+32,255,'T'+127+32,'O'+127+32,255,'S'+127+32,'E'+127+32,'E'+127+32,255,255,255
0597+++6979 E3E4F2E8F1E4FFF3EEFFF2E4E4FFFFFF
0598+++6989             ;THE FUTURE, THE
0599+++6989               db 'T'+127+32,'H'+127+32,'E'+127+32,255,'F'+127+32,'U'+127+32,'T'+127+32,'U'+127+32,'R'+127+32,'E'+127+32,222,255,'T'+127+32,'H'+127+32,'E'+127+32,255
0599+++6989 F3E7E4FFE5F4F3F4F1E4DEFFF3E7E4FF
0600+++6999             ;KEY TO ESCAPE
0601+++6999               db 'K'+127+32,'E'+127+32,'Y'+127+32,255,'T'+127+32,'O'+127+32,255,'E'+127,'S'+127,'C'+127,'A'+127,'P'+127,'E'+127,255,255,255
0601+++6999 EAE4F8FFF3EEFFC4D2C2C0CFC4FFFFFF
0602+++69A9             ;WAS UNDER YOUR
0603+++69A9               db 'W'+127+32,'A'+127+32,'S'+127+32,255,'U'+127+32,'N'+127+32,'D'+127+32,'E'+127+32,'R'+127+32,255,'Y'+127+32,'O'+127+32,'U'+127+32,'R'+127+32,255,255
0603+++69A9 F6E0F2FFF4EDE3E4F1FFF8EEF4F1FFFF
0604+++69B9             ;HANDS FROM SINCE
0605+++69B9               db 'H'+127+32,'A'+127+32,'N'+127+32,'D'+127+32,'S'+127+32,255,'F'+127+32,'R'+127+32,'O'+127+32,'M'+127+32,255,'S'+127+32,'I'+127+32,'N'+127+32,'C'+127+32,'E'+127+32
0605+++69B9 E7E0EDE3F2FFE5F1EEECFFF2E8EDE2E4
0606+++69C9             ;YOU STARTED YOUR
0607+++69C9               db 'Y'+127+32,'O'+127+32,'U'+127+32,255,'S'+127,'T'+127,'A'+127,'R'+127,'T'+127,'E'+127,'D'+127,255,'Y'+127+32,'O'+127+32,'U'+127+32,'R'+127+32
0607+++69C9 F8EEF4FFD2D3C0D1D3C4C3FFF8EEF4F1
0608+++69D9             ;ADVENTURES IN
0609+++69D9               db 'A'+127+32,'D'+127+32,'V'+127+32,'E'+127+32,'N'+127+32,'T'+127+32,'U'+127+32,'R'+127+32,'E'+127+32,'S'+127+32,255,'I'+127+32,'N'+127+32,255,255,255
0609+++69D9 E0E3F5E4EDF3F4F1E4F2FFE8EDFFFFFF
0610+++69E9             ;THIS WORLD...
0611+++69E9               db 'T'+127+32,'H'+127+32,'I'+127+32,'S'+127+32,255,'W'+127+32,'O'+127+32,'R'+127+32,'L'+127+32,'D'+127+32,223,223,223,255,255,255
0611+++69E9 F3E7E8F2FFF6EEF1EBE3DFDFDFFFFFFF
0360++ 69F9             
0361++ 69F9             
0362++ 69F9             
0363++ 69F9              
2006+  69F9             
2007+  69F9             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
2008+  69F9             spritemask1:
2009+  69F9                     db 160-1,56,2*4,1,152-8-1,104-8,0*4,1,160-1,88,1*4,1,0xD0
2009+  69F9 9F3808018F6000019F580401D0
2010+  6A06             
2011+  6A06             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
2012+  6A06             
2013+  6A06             openscreen:
2014+  6A06             
2015+  6A06             ;        ld a,2
2016+  6A06             ;        call 05Fh       ; screen 2
2017+  6A06             
2018+  6A06             introloop:
2019+  6A06 01 01 E2            ld bc,0xE201
2020+  6A09 CD 47 00            call wrtvdp
2021+  6A0C             
2022+  6A0C CD 41 00            call disscr
2023+  6A0F                     
2024+  6A0F             ; load sprites
2025+  6A0F             
2026+  6A0F 21 8E 7B            ld  hl,titlesprites
2027+  6A12 11 03 C1            ld  de,buffer
2028+  6A15 CD 57 79            call    pletter._unpack
2029+  6A18                     
2030+  6A18 76                  halt
2031+  6A19 21 00 38            ld hl,0x3800
2032+  6A1C CD 53 00            call setwrt
2033+  6A1F 01 98 00            ld  bc,(0+0x98) & 0xFFFF
2034+  6A22 21 03 C1            ld  hl,buffer
2035+  6A25 3E 04               ld  a,4
2036+  6A27 ED B3       1:      otir
2037+  6A29 3D                  dec a
2038+  6A2A 20 FB               jr  nz,1b
2039+  6A2C             ;;;;;;;;;;;;;;;;;;;;;;;;;;;
2040+  6A2C             ; sprite patch for the indicator
2041+  6A2C             
2042+  6A2C 21 60 3B            ld hl,0x3B60
2043+  6A2F CD 53 00            call setwrt
2044+  6A32 3E 08               ld  a,0x08
2045+  6A34 D3 98               out (0x98),a        
2046+  6A36 3E 14               ld  a,0x14
2047+  6A38 D3 98               out (0x98),a        
2048+  6A3A AF                  xor a
2049+  6A3B D3 98               out (0x98),a        
2050+  6A3D 3E 14               ld  a,0x14
2051+  6A3F D3 98               out (0x98),a        
2052+  6A41 3E 08               ld  a,0x08
2053+  6A43 D3 98               out (0x98),a        
2054+  6A45             
2055+  6A45             ;;;;;;;;;;;;;;;;;;;;;;;;;;;
2056+  6A45             
2057+  6A45             
2058+  6A45             
2059+  6A45             ;#92 -> 118,90
2060+  6A45 21 00 1B            ld hl,0x1B00
2061+  6A48 CD 53 00            call setwrt
2062+  6A4B 3E 59               ld  a,90-1
2063+  6A4D D3 98               out (0x98),a
2064+  6A4F 3E 76               ld  a,118
2065+  6A51 D3 98               out (0x98),a
2066+  6A53 3E 5C               ld  a,92
2067+  6A55 D3 98               out (0x98),a
2068+  6A57 3E 0F               ld  a,15
2069+  6A59 D3 98               out (0x98),a
2070+  6A5B             ;#96 -> 134,92
2071+  6A5B 3E 5B               ld  a,92-1
2072+  6A5D D3 98               out (0x98),a
2073+  6A5F 3E 86               ld  a,134
2074+  6A61 D3 98               out (0x98),a
2075+  6A63 3E 60               ld  a,96
2076+  6A65 D3 98               out (0x98),a
2077+  6A67 3E 0F               ld  a,15
2078+  6A69 D3 98               out (0x98),a
2079+  6A6B             ;#100 -> 150,91
2080+  6A6B 3E 5A               ld  a,91-1
2081+  6A6D D3 98               out (0x98),a
2082+  6A6F 3E 96               ld  a,150
2083+  6A71 D3 98               out (0x98),a
2084+  6A73 3E 64               ld  a,100
2085+  6A75 D3 98               out (0x98),a
2086+  6A77 3E 0F               ld  a,15
2087+  6A79 D3 98               out (0x98),a
2088+  6A7B             ;#104 ->166,89
2089+  6A7B 3E 58               ld  a,89-1
2090+  6A7D D3 98               out (0x98),a
2091+  6A7F 3E A6               ld  a,166
2092+  6A81 D3 98               out (0x98),a
2093+  6A83 3E 68               ld  a,104
2094+  6A85 D3 98               out (0x98),a
2095+  6A87 3E 0F               ld  a,15
2096+  6A89 D3 98               out (0x98),a
2097+  6A8B             
2098+  6A8B             
2099+  6A8B             ; CLS
2100+  6A8B             
2101+  6A8B 21 00 18            ld hl,0x1800
2102+  6A8E CD 53 00            call setwrt
2103+  6A91 3E 00               ld  a,0
2104+  6A93 D3 98       1:      out (0x98),a
2105+  6A95 3C                  inc a
2106+  6A96 20 FB               jr nz,1b
2107+  6A98 D3 98       1:      out (0x98),a
2108+  6A9A 3C                  inc a
2109+  6A9B 20 FB               jr nz,1b
2110+  6A9D             
2111+  6A9D             
2112+  6A9D 21 00 1A            ld hl,0x1800 + 32*16
2113+  6AA0 CD 53 00            call setwrt
2114+  6AA3 06 00               ld  b,0
2115+  6AA5 AF                  xor a
2116+  6AA6 D3 98       1:      out (0x98),a
2117+  6AA8 10 FC               djnz    1b
2118+  6AAA             
2119+  6AAA             ; load tiles
2120+  6AAA             		
2121+  6AAA 21 97 84            ld hl,ddpat1
2122+  6AAD 11 00 00            ld de,0x0000
2123+  6AB0 CD 72 5D            call    out2k
2124+  6AB3 CD 83 5D    		call _out2k2
2125+  6AB6             
2126+  6AB6 21 3D 8C            ld hl,ddcol1
2127+  6AB9 11 00 20            ld de,0x2000
2128+  6ABC CD 72 5D            call    out2k
2129+  6ABF CD 83 5D    		call _out2k2
2130+  6AC2             		
2131+  6AC2             		
2132+  6AC2                     ; ld	hl,MUSIC0-100			; hl <- initial address of module - 100
2133+  6AC2                     ; call	PT3_INIT			; Inits PT3 player
2134+  6AC2             		
2135+  6AC2                     ; ld hl,ddpat2
2136+  6AC2                     ; ld de,0x0000+256*8
2137+  6AC2                     ; call    out2k
2138+  6AC2             
2139+  6AC2                     ; ld hl,ddcol2
2140+  6AC2                     ; ld de,0x2000+256*8
2141+  6AC2                     ; call    out2k
2142+  6AC2             
2143+  6AC2 21 BF 7F            ld hl,ddpatterns
2144+  6AC5 11 00 10            ld de,0x0000+256*8*2
2145+  6AC8 CD 72 5D            call    out2k
2146+  6ACB             
2147+  6ACB 21 0B 7D            ld hl,ddcolors
2148+  6ACE 11 00 30            ld de,0x2000+256*8*2
2149+  6AD1 CD 72 5D            call    out2k
2150+  6AD4             
2151+  6AD4             ; Print message
2152+  6AD4 76                  halt
2153+  6AD5 21 46 1A            ld hl,0x1800 + 32*18 + 6
2154+  6AD8 CD 53 00            call setwrt
2155+  6ADB 21 8C 76            ld hl,startgamemessage
2156+  6ADE 06 14               ld b,20
2157+  6AE0 ED B3               otir
2158+  6AE2             
2159+  6AE2             
2160+  6AE2 CD 44 00            call enascr
2161+  6AE5             
2162+  6AE5                     ; wait  seq == 4
2163+  6AE5             
2164+  6AE5 76          1:      halt
2165+  6AE6 CD 80 71            call keytest
2166+  6AE9             
2167+  6AE9 CD DD 52            call    seq
2168+  6AEC 3E 03               ld  a,3
2169+  6AEE BD                  cp  l
2170+  6AEF 30 F4               jr  nc,1b
2171+  6AF1             
2172+  6AF1                     ; seq == 4
2173+  6AF1             
2174+  6AF1             ; Start INTRO SCRIPT
2175+  6AF1             
2176+  6AF1 CD 41 00            call disscr
2177+  6AF4             
2178+  6AF4 CD 57 5D            call cls
2179+  6AF7             
2180+  6AF7             ; load patterns
2181+  6AF7             
2182+  6AF7 21 BF 7F            ld hl,ddpatterns
2183+  6AFA 11 00 00            ld de,0x0000
2184+  6AFD CD 72 5D            call    out2k
2185+  6B00 21 0B 7D            ld hl,ddcolors
2186+  6B03 11 00 20            ld de,0x2000
2187+  6B06 CD 72 5D            call    out2k
2188+  6B09             
2189+  6B09 21 BF 7F            ld hl,ddpatterns
2190+  6B0C 11 00 08            ld de,0x0000+256*8
2191+  6B0F CD 72 5D            call    out2k
2192+  6B12 21 0B 7D            ld hl,ddcolors
2193+  6B15 11 00 28            ld de,0x2000+256*8
2194+  6B18 CD 72 5D            call    out2k
2195+  6B1B             
2196+  6B1B             ; show sprite 0 at 56,160, sprite 1 at 104,152, sprite 2 at 88,160
2197+  6B1B             
2198+  6B1B 21 00 1B            ld hl,0x1b00
2199+  6B1E CD 53 00            call setwrt
2200+  6B21 76                  halt
2201+  6B22 21 F9 69            ld   hl,spritemask1
2202+  6B25 01 98 0D            ld   bc,(3*4+1)*256+0x98
2203+  6B28 ED B3               otir
2204+  6B2A             
2205+  6B2A             
2206+  6B2A             
2207+  6B2A             
2208+  6B2A             ; show amulet in lower section on screen start pos 7,17 (x,y) width 18 tiles and height 4
2209+  6B2A 76                  halt
2210+  6B2B 21 27 1A            ld      hl,0x1800+17*32+7
2211+  6B2E 01 98 04            ld      bc,4*256+0x98
2212+  6B31 11 05 6C            ld      de,amulettiles
2213+  6B34             1:
2214+  6B34 C5                  push    bc
2215+  6B35             
2216+  6B35 CD 53 00            call setwrt
2217+  6B38             
2218+  6B38 01 20 00            ld      bc,32
2219+  6B3B 09                  add     hl,bc
2220+  6B3C E5                  push    hl
2221+  6B3D             
2222+  6B3D EB                  ex      de,hl
2223+  6B3E 01 98 13            ld      bc,19*256+0x98
2224+  6B41 CD 82 7B            call slowotir
2225+  6B44 EB                  ex      de,hl
2226+  6B45             
2227+  6B45 E1                  pop     hl
2228+  6B46 C1                  pop     bc
2229+  6B47 10 EB               djnz    1b
2230+  6B49             
2231+  6B49             ; show text. start at pos 5,3
2232+  6B49             
2233+  6B49 11 51 6C            ld      de,introtext1
2234+  6B4C 21 65 18            ld      hl,0x1800+3*32+5
2235+  6B4F 3E 16               ld      a,22
2236+  6B51 06 06               ld      b,6
2237+  6B53 CD 69 73            call    _printtext
2238+  6B56             
2239+  6B56 CD 44 00            call enascr
2240+  6B59             
2241+  6B59                     ; wait  seq == 5
2242+  6B59                     
2243+  6B59 76          1:      halt
2244+  6B5A CD 80 71            call keytest
2245+  6B5D             
2246+  6B5D CD DD 52            call    seq
2247+  6B60 3E 05               ld  a,5
2248+  6B62 BD                  cp  l
2249+  6B63 30 F4               jr  nc,1b
2250+  6B65             
2251+  6B65 11 D5 6C            ld      de,introtext2
2252+  6B68 21 65 18            ld      hl,0x1800+3*32+5
2253+  6B6B 3E 16               ld      a,22
2254+  6B6D 06 07               ld      b,7
2255+  6B6F CD 69 73            call    _printtext
2256+  6B72             
2257+  6B72                     ; wait  seq == 7
2258+  6B72             
2259+  6B72             
2260+  6B72 76          1:      halt
2261+  6B73 CD 80 71            call keytest
2262+  6B76 CD DD 52            call    seq
2263+  6B79 3E 07               ld  a,7
2264+  6B7B BD                  cp  l
2265+  6B7C 30 F4               jr  nc,1b
2266+  6B7E             
2267+  6B7E             
2268+  6B7E 21 00 18            ld hl,0x1800 
2269+  6B81 CD 53 00            call setwrt
2270+  6B84 06 00               ld  b,0
2271+  6B86 AF                  xor a
2272+  6B87 D3 98       1:      out (0x98),a
2273+  6B89 00                  nop
2274+  6B8A A7                  and a
2275+  6B8B 10 FA               djnz    1b
2276+  6B8D D3 98       1:      out (0x98),a
2277+  6B8F 00                  nop
2278+  6B90 A7                  and a
2279+  6B91 10 FA               djnz    1b
2280+  6B93 D3 98       1:      out (0x98),a
2281+  6B95 00                  nop
2282+  6B96 A7                  and a
2283+  6B97 10 FA               djnz    1b
2284+  6B99 D3 98       1:      out (0x98),a
2285+  6B9B 00                  nop
2286+  6B9C A7                  and a
2287+  6B9D 10 FA               djnz    1b
2288+  6B9F             
2289+  6B9F 11 70 6D            ld      de,introtext3
2290+  6BA2 21 44 18            ld      hl,0x1800+2*32+4
2291+  6BA5 3E 1A               ld      a,26
2292+  6BA7 06 09               ld      b,9
2293+  6BA9 CD 69 73            call    _printtext
2294+  6BAC             
2295+  6BAC             
2296+  6BAC                    ; wait  seq == 9
2297+  6BAC                     
2298+  6BAC 76          1:      halt
2299+  6BAD CD 80 71            call keytest
2300+  6BB0             
2301+  6BB0 CD DD 52            call    seq
2302+  6BB3 3E 09               ld  a,9
2303+  6BB5 BD                  cp  l
2304+  6BB6 30 F4               jr  nc,1b
2305+  6BB8             
2306+  6BB8 11 5A 6E            ld      de,introtext4
2307+  6BBB 21 44 18            ld      hl,0x1800+2*32+4
2308+  6BBE 3E 1A               ld      a,26
2309+  6BC0 06 0A               ld      b,10
2310+  6BC2 CD 69 73            call    _printtext
2311+  6BC5             
2312+  6BC5                    ; wait  seq == 11
2313+  6BC5                     
2314+  6BC5 76          1:      halt
2315+  6BC6 CD 80 71            call keytest
2316+  6BC9             
2317+  6BC9 CD DD 52            call    seq
2318+  6BCC 3E 0B               ld  a,11
2319+  6BCE BD                  cp  l
2320+  6BCF 30 F4               jr  nc,1b
2321+  6BD1             
2322+  6BD1 11 5E 6F            ld      de,introtext5
2323+  6BD4 21 44 18            ld      hl,0x1800+2*32+4
2324+  6BD7 3E 1A               ld      a,26
2325+  6BD9 06 0A               ld      b,10
2326+  6BDB CD 69 73            call    _printtext
2327+  6BDE             
2328+  6BDE                    ; wait  seq == 13
2329+  6BDE                     
2330+  6BDE 76          1:      halt
2331+  6BDF CD 80 71            call keytest
2332+  6BE2             
2333+  6BE2 CD DD 52            call    seq
2334+  6BE5 3E 0D               ld  a,13
2335+  6BE7 BD                  cp  l
2336+  6BE8 30 F4               jr  nc,1b
2337+  6BEA             
2338+  6BEA 11 62 70            ld      de,introtext6
2339+  6BED 21 44 18            ld      hl,0x1800+2*32+4
2340+  6BF0 3E 1A               ld      a,26
2341+  6BF2 06 0B               ld      b,11
2342+  6BF4 CD 69 73            call    _printtext
2343+  6BF7             
2344+  6BF7             
2345+  6BF7                     ; wait  seq == 0x0B
2346+  6BF7             
2347+  6BF7 76          1:      halt
2348+  6BF8 CD 80 71            call keytest
2349+  6BFB CD DD 52            call    seq
2350+  6BFE AF                  xor a
2351+  6BFF BD                  cp  l
2352+  6C00 20 F5               jr  nz,1b           ; wait for loop
2353+  6C02             
2354+  6C02 C3 06 6A            jp introloop
2355+  6C05             
2356+  6C05             
2357+  6C05             
2358+  6C05             
2359+  6C05             amulettiles
2360+  6C05                   db 255,255, 52, 53, 54, 55, 56, 92, 93,255,255,255,255,255,255,255,255,255,255
2360+  6C05 FFFF34353637385C5DFFFFFFFFFFFFFFFFFFFF
2361+  6C18                   db  57, 58, 59, 60, 61, 62, 63, 94, 95,154,155,156,157,158,158,159,159,186,187
2361+  6C18 393A3B3C3D3E3F5E5F9A9B9C9D9E9E9F9FBABB
2362+  6C2B                   db  79, 80, 81, 82, 83, 84, 85,255, 255,188,189,190,191,220,220,220,221,222,223
2362+  6C2B 4F505152535455FFFFBCBDBEBFDCDCDCDDDEDF
2363+  6C3E                   db  86, 87, 88, 89, 90, 91, 255,255,255,255,255,255,255,255,255,255,255,255,255
2363+  6C3E 565758595A5BFFFFFFFFFFFFFFFFFFFFFFFFFF
2364+  6C51             
2365+  6C51             introtext1:
2366+  6C51             ; show text. start at pos 5,3
2367+  6C51             ;DOWN THE DEEP DUNGEON,
2368+  6C51                   db 68+127, 79+127, 87+127, 78+127, 255,    84+127, 72+127, 69+127, 255,    68+127, 69+127, 69+127, 80+127, 255,    68+127, 85+127, 78+127, 71+127, 69+127, 79+127, 78+127, 247
2368+  6C51 C3CED6CDFFD3C7C4FFC3C4C4CFFFC3D4CDC6C4CECDF7
2369+  6C67             ;GUARDED BY DREADFUL
2370+  6C67                   db 71+127, 85+127, 65+127, 82+127, 68+127, 69+127, 68+127, 255, 66+127, 89+127, 255,    68+127, 82+127, 69+127, 65+127, 68+127, 70+127, 85+127, 76+127, 255,255,255
2370+  6C67 C6D4C0D1C3C4C3FFC1D8FFC3D1C4C0C3C5D4CBFFFFFF
2371+  6C7D             ;CREATURES, AWAITS AN
2372+  6C7D                   db 67+127, 82+127, 69+127, 65+127, 84+127, 85+127, 82+127, 69+127, 83+127, 247,    255,    65+127, 87+127, 65+127, 73+127, 84+127, 83+127, 255, 65+127, 78+127,255,255
2372+  6C7D C2D1C4C0D3D4D1C4D2F7FFC0D6C0C8D3D2FFC0CDFFFF
2373+  6C93             ;AMULET ONCE STOLEN
2374+  6C93                   db 65+127, 77+127, 85+127, 76+127, 69+127, 84+127, 255,    79+127, 78+127, 67+127, 69+127, 255,    83+127, 84+127, 79+127, 76+127, 69+127, 78+127, 255,255,255,255
2374+  6C93 C0CCD4CBC4D3FFCECDC2C4FFD2D3CECBC4CDFFFFFFFF
2375+  6CA9             ;FROM YOUR FAMILY BY
2376+  6CA9                   db 70+127, 82+127, 79+127, 77+127, 255,    89+127, 79+127, 85+127, 82+127, 255,    70+127, 65+127, 77+127, 73+127, 76+127, 89+127, 255, 66+127, 89+127,255,255,255
2376+  6CA9 C5D1CECCFFD8CED4D1FFC5C0CCC8CBD8FFC1D8FFFFFF
2377+  6CBF             ;AN EVIL WIZARD.
2378+  6CBF                   db 65+127, 78+127, 255,    69+127, 86+127, 73+127, 76+127, 255,    87+127, 73+127, 90+127, 65+127, 82+127, 'D'+127,255, 255,255,255,255,255,255,255
2378+  6CBF C0CDFFC4D5C8CBFFD6C8D9C0D1C3FFFFFFFFFFFFFFFF
2379+  6CD5             
2380+  6CD5             
2381+  6CD5             introtext2:
2382+  6CD5             ;IT BEARS THE ROYAL
2383+  6CD5                   db 73+127, 84+127, 255,    66+127, 69+127, 65+127, 82+127, 83+127, 255,    84+127, 72+127, 69+127, 255,    82+127, 79+127, 89+127, 65+127,76+127,255,255,255,255
2383+  6CD5 C8D3FFC1C4C0D1D2FFD3C7C4FFD1CED8C0CBFFFFFFFF
2384+  6CEB             ;CREST PROVING YOUR
2385+  6CEB                   db 67+127, 82+127, 69+127, 83+127, 84+127, 255,    80+127, 82+127, 79+127, 86+127, 73+127, 78+127, 71+127, 255,    89+127, 79+127, 85+127,82+127,255,255,255,255
2385+  6CEB C2D1C4D2D3FFCFD1CED5C8CDC6FFD8CED4D1FFFFFFFF
2386+  6D01             ;HERIDITARY RIGHT TO
2387+  6D01                   db 72+127, 69+127, 82+127, 73+127, 68+127, 73+127, 84+127, 65+127, 82+127, 89+127, 255,    82+127, 73+127, 71+127, 72+127, 84+127, 255,84+127, 79+127,255,255,255
2387+  6D01 C7C4D1C8C3C8D3C0D1D8FFD1C8C6C7D3FFD3CEFFFFFF
2388+  6D17             ;THE COUNTRY'S THRONE.
2389+  6D17                   db 84+127, 72+127, 69+127, 255,    67+127, 79+127, 85+127, 78+127, 84+127, 82+127, 89+127,251, 83+127, 255,    84+127, 72+127, 82+127, 79+127, 78+127, 69+127, 255,255
2389+  6D17 D3C7C4FFC2CED4CDD3D1D8FBD2FFD3C7D1CECDC4FFFF
2390+  6D2D             
2391+  6D2D                   rept 22
2392+  6D2D~                  db 255
2393+  6D2D                   endm
2393+  6D2D FF          >      db 255
2393+  6D2E FF          >      db 255
2393+  6D2F FF          >      db 255
2393+  6D30 FF          >      db 255
2393+  6D31 FF          >      db 255
2393+  6D32 FF          >      db 255
2393+  6D33 FF          >      db 255
2393+  6D34 FF          >      db 255
2393+  6D35 FF          >      db 255
2393+  6D36 FF          >      db 255
2393+  6D37 FF          >      db 255
2393+  6D38 FF          >      db 255
2393+  6D39 FF          >      db 255
2393+  6D3A FF          >      db 255
2393+  6D3B FF          >      db 255
2393+  6D3C FF          >      db 255
2393+  6D3D FF          >      db 255
2393+  6D3E FF          >      db 255
2393+  6D3F FF          >      db 255
2393+  6D40 FF          >      db 255
2393+  6D41 FF          >      db 255
2393+  6D42 FF          >      db 255
2394+  6D43             
2395+  6D43             ;WOULD YOU DARE TO
2396+  6D43                   db 87+127, 79+127, 85+127, 76+127, 68+127, 255,    89+127, 79+127, 85+127, 255,    68+127, 65+127, 82+127, 69+127, 255,    84+127, 79+127, 255 , 255, 255, 255, 255
2396+  6D43 D6CED4CBC3FFD8CED4FFC3C0D1C4FFD3CEFFFFFFFFFF
2397+  6D59             ;ENTER...?
2398+  6D59                   db 69+127, 78+127, 84+127, 69+127, 82+127, 248,    248,    248,    250
2398+  6D59 C4CDD3C4D1F8F8F8FA
2399+  6D62                   rept 14
2400+  6D62~                  db 255
2401+  6D62                   endm
2401+  6D62 FF          >      db 255
2401+  6D63 FF          >      db 255
2401+  6D64 FF          >      db 255
2401+  6D65 FF          >      db 255
2401+  6D66 FF          >      db 255
2401+  6D67 FF          >      db 255
2401+  6D68 FF          >      db 255
2401+  6D69 FF          >      db 255
2401+  6D6A FF          >      db 255
2401+  6D6B FF          >      db 255
2401+  6D6C FF          >      db 255
2401+  6D6D FF          >      db 255
2401+  6D6E FF          >      db 255
2401+  6D6F FF          >      db 255
2402+  6D70             
2403+  6D70             introtext3:
2404+  6D70             ; start at 2,3
2405+  6D70             ;     - HOW TO PLAY -
2406+  6D70                   db 255,255,255,255,255,254,255,'H'+127,'O'+127,'W'+127,255,'T'+127,'O'+127,255,'P'+127,'L'+127,'A'+127,'Y'+127,255,254
2406+  6D70 FFFFFFFFFFFEFFC7CED6FFD3CEFFCFCBC0D8FFFE
2407+  6D84                   rept 6+26
2408+  6D84~                  db 255
2409+  6D84                   endm
2409+  6D84 FF          >      db 255
2409+  6D85 FF          >      db 255
2409+  6D86 FF          >      db 255
2409+  6D87 FF          >      db 255
2409+  6D88 FF          >      db 255
2409+  6D89 FF          >      db 255
2409+  6D8A FF          >      db 255
2409+  6D8B FF          >      db 255
2409+  6D8C FF          >      db 255
2409+  6D8D FF          >      db 255
2409+  6D8E FF          >      db 255
2409+  6D8F FF          >      db 255
2409+  6D90 FF          >      db 255
2409+  6D91 FF          >      db 255
2409+  6D92 FF          >      db 255
2409+  6D93 FF          >      db 255
2409+  6D94 FF          >      db 255
2409+  6D95 FF          >      db 255
2409+  6D96 FF          >      db 255
2409+  6D97 FF          >      db 255
2409+  6D98 FF          >      db 255
2409+  6D99 FF          >      db 255
2409+  6D9A FF          >      db 255
2409+  6D9B FF          >      db 255
2409+  6D9C FF          >      db 255
2409+  6D9D FF          >      db 255
2409+  6D9E FF          >      db 255
2409+  6D9F FF          >      db 255
2409+  6DA0 FF          >      db 255
2409+  6DA1 FF          >      db 255
2409+  6DA2 FF          >      db 255
2409+  6DA3 FF          >      db 255
2410+  6DA4             ;DESCEND DONW INTO THE 
2411+  6DA4                   db 'D'+127,'E'+127,'S'+127,'C'+127,'E'+127,'N'+127,'D'+127,255,'D'+127,'O'+127,'W'+127,'N'+127,255,'I'+127,'N'+127,'T'+127,'O'+127,255,'T'+127,'H'+127,'E'+127
2411+  6DA4 C3C4D2C2C4CDC3FFC3CED6CDFFC8CDD3CEFFD3C7C4
2412+  6DB9                   rept 5
2413+  6DB9~                  db 255
2414+  6DB9                   endm
2414+  6DB9 FF          >      db 255
2414+  6DBA FF          >      db 255
2414+  6DBB FF          >      db 255
2414+  6DBC FF          >      db 255
2414+  6DBD FF          >      db 255
2415+  6DBE             ;DEPTHS OF THE DUNGEON TO
2416+  6DBE                   db 'D'+127,'E'+127,'P'+127,'T'+127,'H'+127,'S'+127,255,'O'+127,'F'+127,255,'T'+127,'H'+127,'E'+127,255,'D'+127,'U'+127,'N'+127,'G'+127,'E'+127,'O'+127,'N'+127,255,'T'+127,'O'+127
2416+  6DBE C3C4CFD3C7D2FFCEC5FFD3C7C4FFC3D4CDC6C4CECDFFD3CE
2417+  6DD6                   rept 2
2418+  6DD6~                  db 255
2419+  6DD6                   endm
2419+  6DD6 FF          >      db 255
2419+  6DD7 FF          >      db 255
2420+  6DD8             ;FIND THE AMULET %.
2421+  6DD8                   db 'F'+127, 'I'+127, 'N'+127, 'D'+127, 255, 'T'+127, 'H'+127, 'E'+127, 255, 'A'+127, 'M'+127, 'U'+127, 'L'+127, 'E'+127, 'T'+127, 255, 43,248
2421+  6DD8 C5C8CDC3FFD3C7C4FFC0CCD4CBC4D3FF2BF8
2422+  6DEA                   rept 8+26
2423+  6DEA~                  db 255
2424+  6DEA                   endm
2424+  6DEA FF          >      db 255
2424+  6DEB FF          >      db 255
2424+  6DEC FF          >      db 255
2424+  6DED FF          >      db 255
2424+  6DEE FF          >      db 255
2424+  6DEF FF          >      db 255
2424+  6DF0 FF          >      db 255
2424+  6DF1 FF          >      db 255
2424+  6DF2 FF          >      db 255
2424+  6DF3 FF          >      db 255
2424+  6DF4 FF          >      db 255
2424+  6DF5 FF          >      db 255
2424+  6DF6 FF          >      db 255
2424+  6DF7 FF          >      db 255
2424+  6DF8 FF          >      db 255
2424+  6DF9 FF          >      db 255
2424+  6DFA FF          >      db 255
2424+  6DFB FF          >      db 255
2424+  6DFC FF          >      db 255
2424+  6DFD FF          >      db 255
2424+  6DFE FF          >      db 255
2424+  6DFF FF          >      db 255
2424+  6E00 FF          >      db 255
2424+  6E01 FF          >      db 255
2424+  6E02 FF          >      db 255
2424+  6E03 FF          >      db 255
2424+  6E04 FF          >      db 255
2424+  6E05 FF          >      db 255
2424+  6E06 FF          >      db 255
2424+  6E07 FF          >      db 255
2424+  6E08 FF          >      db 255
2424+  6E09 FF          >      db 255
2424+  6E0A FF          >      db 255
2424+  6E0B FF          >      db 255
2425+  6E0C             ;NAVIGATE YOUR WAY THROUGH
2426+  6E0C                   db 'N'+127, 'A'+127, 'V'+127, 'I'+127, 'G'+127, 'A'+127, 'T'+127, 'E'+127, 255, 'Y'+127, 'O'+127, 'U'+127, 'R'+127, 255, 'W'+127, 'A'+127, 'Y'+127, 255, 'T'+127, 'H'+127, 'R'+127, 'O'+127, 'U'+127, 'G'+127, 'H'+127
2426+  6E0C CDC0D5C8C6C0D3C4FFD8CED4D1FFD6C0D8FFD3C7D1CED4C6C7
2427+  6E25                   rept 1
2428+  6E25~                  db 255
2429+  6E25                   endm
2429+  6E25 FF          >      db 255
2430+  6E26             ;THE DUNGEON USING THE
2431+  6E26                   db 'T'+127, 'H'+127, 'E'+127, 255, 'D'+127, 'U'+127, 'N'+127, 'G'+127, 'E'+127, 'O'+127, 'N'+127, 255, 'U'+127, 'S'+127, 'I'+127, 'N'+127, 'G'+127, 255, 'T'+127, 'H'+127, 'E'+127
2431+  6E26 D3C7C4FFC3D4CDC6C4CECDFFD4D2C8CDC6FFD3C7C4
2432+  6E3B                   rept 5
2433+  6E3B~                  db 255
2434+  6E3B                   endm
2434+  6E3B FF          >      db 255
2434+  6E3C FF          >      db 255
2434+  6E3D FF          >      db 255
2434+  6E3E FF          >      db 255
2434+  6E3F FF          >      db 255
2435+  6E40             ;STAIRS UP % AND DOWN %.
2436+  6E40                   db 'S'+127, 'T'+127, 'A'+127, 'I'+127, 'R'+127, 'S'+127, 255, 'U'+127, 'P'+127, 255, 34, 255, 'A'+127, 'N'+127, 'D'+127, 255, 'D'+127, 'O'+127, 'W'+127, 'N'+127, 255, 35, 248
2436+  6E40 D2D3C0C8D1D2FFD4CFFF22FFC0CDC3FFC3CED6CDFF23F8
2437+  6E57                   rept 3
2438+  6E57~                  db 255
2439+  6E57                   endm
2439+  6E57 FF          >      db 255
2439+  6E58 FF          >      db 255
2439+  6E59 FF          >      db 255
2440+  6E5A             
2441+  6E5A             introtext4:
2442+  6E5A             ; start at 2,3
2443+  6E5A             ;     - HOW TO PLAY -
2444+  6E5A                   db 255,255,255,255,255,254,255,'H'+127,'O'+127,'W'+127,255,'T'+127,'O'+127,255,'P'+127,'L'+127,'A'+127,'Y'+127,255,254
2444+  6E5A FFFFFFFFFFFEFFC7CED6FFD3CEFFCFCBC0D8FFFE
2445+  6E6E                   rept 6+26
2446+  6E6E~                  db 255
2447+  6E6E                   endm
2447+  6E6E FF          >      db 255
2447+  6E6F FF          >      db 255
2447+  6E70 FF          >      db 255
2447+  6E71 FF          >      db 255
2447+  6E72 FF          >      db 255
2447+  6E73 FF          >      db 255
2447+  6E74 FF          >      db 255
2447+  6E75 FF          >      db 255
2447+  6E76 FF          >      db 255
2447+  6E77 FF          >      db 255
2447+  6E78 FF          >      db 255
2447+  6E79 FF          >      db 255
2447+  6E7A FF          >      db 255
2447+  6E7B FF          >      db 255
2447+  6E7C FF          >      db 255
2447+  6E7D FF          >      db 255
2447+  6E7E FF          >      db 255
2447+  6E7F FF          >      db 255
2447+  6E80 FF          >      db 255
2447+  6E81 FF          >      db 255
2447+  6E82 FF          >      db 255
2447+  6E83 FF          >      db 255
2447+  6E84 FF          >      db 255
2447+  6E85 FF          >      db 255
2447+  6E86 FF          >      db 255
2447+  6E87 FF          >      db 255
2447+  6E88 FF          >      db 255
2447+  6E89 FF          >      db 255
2447+  6E8A FF          >      db 255
2447+  6E8B FF          >      db 255
2447+  6E8C FF          >      db 255
2447+  6E8D FF          >      db 255
2448+  6E8E             
2449+  6E8E             ;TRY TO COLLECT THE
2450+  6E8E                   db 'T'+127, 'R'+127, 'Y'+127, 255, 'T'+127, 'O'+127, 255, 'C'+127, 'O'+127, 'L'+127, 'L'+127, 'E'+127, 'C'+127, 'T'+127, 255, 'T'+127, 'H'+127, 'E'+127
2450+  6E8E D3D1D8FFD3CEFFC2CECBCBC4C2D3FFD3C7C4
2451+  6EA0                   rept 8
2452+  6EA0~                  db 255
2453+  6EA0                   endm
2453+  6EA0 FF          >      db 255
2453+  6EA1 FF          >      db 255
2453+  6EA2 FF          >      db 255
2453+  6EA3 FF          >      db 255
2453+  6EA4 FF          >      db 255
2453+  6EA5 FF          >      db 255
2453+  6EA6 FF          >      db 255
2453+  6EA7 FF          >      db 255
2454+  6EA8             ;TREASURE % ON EACH FLOOR.
2455+  6EA8                   db  'T'+127, 'R'+127, 'E'+127, 'A'+127, 'S'+127, 'U'+127, 'R'+127, 'E'+127, 255, 38, 255, 'O'+127, 'N'+127, 255, 'E'+127, 'A'+127, 'C'+127, 'H'+127, 255, 'F'+127, 'L'+127, 'O'+127, 'O'+127, 'R'+127, 255,255
2455+  6EA8 D3D1C4C0D2D4D1C4FF26FFCECDFFC4C0C2C7FFC5CBCECED1FFFF
2456+  6EC2             ;THE ITEMS WITHIN WILL 
2457+  6EC2                   db 'T'+127, 'H'+127, 'E'+127, 255, 'I'+127, 'T'+127, 'E'+127, 'M'+127, 'S'+127, 255, 'W'+127, 'I'+127, 'T'+127, 'H'+127, 'I'+127, 'N'+127, 255, 'W'+127, 'I'+127, 'L'+127, 'L'+127
2457+  6EC2 D3C7C4FFC8D3C4CCD2FFD6C8D3C7C8CDFFD6C8CBCB
2458+  6ED7                   rept 5
2459+  6ED7~                  db 255
2460+  6ED7                   endm
2460+  6ED7 FF          >      db 255
2460+  6ED8 FF          >      db 255
2460+  6ED9 FF          >      db 255
2460+  6EDA FF          >      db 255
2460+  6EDB FF          >      db 255
2461+  6EDC             ;HELP YOU IN YOUR QUEST.
2462+  6EDC                   db 'H'+127, 'E'+127, 'L'+127, 'P'+127, 255, 'Y'+127, 'O'+127, 'U'+127, 255, 'I'+127, 'N'+127, 255, 'Y'+127, 'O'+127, 'U'+127, 'R'+127, 255, 'Q'+127, 'U'+127, 'E'+127, 'S'+127, 'T'+127,255
2462+  6EDC C7C4CBCFFFD8CED4FFC8CDFFD8CED4D1FFD0D4C4D2D3FF
2463+  6EF3                   rept 3+26
2464+  6EF3~                  db 255
2465+  6EF3                   endm
2465+  6EF3 FF          >      db 255
2465+  6EF4 FF          >      db 255
2465+  6EF5 FF          >      db 255
2465+  6EF6 FF          >      db 255
2465+  6EF7 FF          >      db 255
2465+  6EF8 FF          >      db 255
2465+  6EF9 FF          >      db 255
2465+  6EFA FF          >      db 255
2465+  6EFB FF          >      db 255
2465+  6EFC FF          >      db 255
2465+  6EFD FF          >      db 255
2465+  6EFE FF          >      db 255
2465+  6EFF FF          >      db 255
2465+  6F00 FF          >      db 255
2465+  6F01 FF          >      db 255
2465+  6F02 FF          >      db 255
2465+  6F03 FF          >      db 255
2465+  6F04 FF          >      db 255
2465+  6F05 FF          >      db 255
2465+  6F06 FF          >      db 255
2465+  6F07 FF          >      db 255
2465+  6F08 FF          >      db 255
2465+  6F09 FF          >      db 255
2465+  6F0A FF          >      db 255
2465+  6F0B FF          >      db 255
2465+  6F0C FF          >      db 255
2465+  6F0D FF          >      db 255
2465+  6F0E FF          >      db 255
2465+  6F0F FF          >      db 255
2466+  6F10             ;BUT BEWARE! IT MIGHT BE
2467+  6F10                   db 'B'+127, 'U'+127, 'T'+127, 255, 'B'+127, 'E'+127, 'W'+127, 'A'+127, 'R'+127, 'E'+127, 249, 255, 'I'+127, 'T'+127, 255, 'M'+127, 'I'+127, 'G'+127, 'H'+127, 'T'+127, 255, 'B'+127, 'E'+127
2467+  6F10 C1D4D3FFC1C4D6C0D1C4F9FFC8D3FFCCC8C6C7D3FFC1C4
2468+  6F27                   rept 3
2469+  6F27~                  db 255
2470+  6F27                   endm
2470+  6F27 FF          >      db 255
2470+  6F28 FF          >      db 255
2470+  6F29 FF          >      db 255
2471+  6F2A             ;WISE TO SAVE SOME ITEMS
2472+  6F2A                   db 'W'+127, 'I'+127, 'S'+127, 'E'+127, 255, 'T'+127, 'O'+127, 255, 'S'+127, 'A'+127, 'V'+127, 'E'+127, 255, 'S'+127, 'O'+127, 'M'+127, 'E'+127, 255, 'I'+127, 'T'+127, 'E'+127, 'M'+127, 'S'+127
2472+  6F2A D6C8D2C4FFD3CEFFD2C0D5C4FFD2CECCC4FFC8D3C4CCD2
2473+  6F41                   rept 3
2474+  6F41~                  db 255
2475+  6F41                   endm
2475+  6F41 FF          >      db 255
2475+  6F42 FF          >      db 255
2475+  6F43 FF          >      db 255
2476+  6F44             ;FOR LATER.
2477+  6F44                   db 'F'+127, 'O'+127, 'R'+127, 255, 'L'+127, 'A'+127, 'T'+127, 'E'+127, 'R'+127, 255
2477+  6F44 C5CED1FFCBC0D3C4D1FF
2478+  6F4E                   rept 16
2479+  6F4E~                  db 255
2480+  6F4E                   endm
2480+  6F4E FF          >      db 255
2480+  6F4F FF          >      db 255
2480+  6F50 FF          >      db 255
2480+  6F51 FF          >      db 255
2480+  6F52 FF          >      db 255
2480+  6F53 FF          >      db 255
2480+  6F54 FF          >      db 255
2480+  6F55 FF          >      db 255
2480+  6F56 FF          >      db 255
2480+  6F57 FF          >      db 255
2480+  6F58 FF          >      db 255
2480+  6F59 FF          >      db 255
2480+  6F5A FF          >      db 255
2480+  6F5B FF          >      db 255
2480+  6F5C FF          >      db 255
2480+  6F5D FF          >      db 255
2481+  6F5E             
2482+  6F5E             	;low mid high
2483+  6F5E             	;'L'+127,'O'+127,'W'+127
2484+  6F5E             	;'M'+127,'I'+127,'D'+127
2485+  6F5E             	;'H'+127,'I'+127,'G'+127,'H'+127
2486+  6F5E             introtext5:
2487+  6F5E             ; start at 2,3
2488+  6F5E             ;     - HOW TO PLAY -
2489+  6F5E                   db 255,255,255,255,255,254,255,'H'+127,'O'+127,'W'+127,255,'T'+127,'O'+127,255,'P'+127,'L'+127,'A'+127,'Y'+127,255,254
2489+  6F5E FFFFFFFFFFFEFFC7CED6FFD3CEFFCFCBC0D8FFFE
2490+  6F72                   rept 6+26
2491+  6F72~                  db 255
2492+  6F72                   endm
2492+  6F72 FF          >      db 255
2492+  6F73 FF          >      db 255
2492+  6F74 FF          >      db 255
2492+  6F75 FF          >      db 255
2492+  6F76 FF          >      db 255
2492+  6F77 FF          >      db 255
2492+  6F78 FF          >      db 255
2492+  6F79 FF          >      db 255
2492+  6F7A FF          >      db 255
2492+  6F7B FF          >      db 255
2492+  6F7C FF          >      db 255
2492+  6F7D FF          >      db 255
2492+  6F7E FF          >      db 255
2492+  6F7F FF          >      db 255
2492+  6F80 FF          >      db 255
2492+  6F81 FF          >      db 255
2492+  6F82 FF          >      db 255
2492+  6F83 FF          >      db 255
2492+  6F84 FF          >      db 255
2492+  6F85 FF          >      db 255
2492+  6F86 FF          >      db 255
2492+  6F87 FF          >      db 255
2492+  6F88 FF          >      db 255
2492+  6F89 FF          >      db 255
2492+  6F8A FF          >      db 255
2492+  6F8B FF          >      db 255
2492+  6F8C FF          >      db 255
2492+  6F8D FF          >      db 255
2492+  6F8E FF          >      db 255
2492+  6F8F FF          >      db 255
2492+  6F90 FF          >      db 255
2492+  6F91 FF          >      db 255
2493+  6F92             ;HEALTH RESTORING ITEMS:
2494+  6F92                   db 'H'+127, 'E'+127, 'A'+127, 'L'+127, 'T'+127, 'H'+127, 255, 'R'+127, 'E'+127, 'S'+127, 'T'+127, 'O'+127, 'R'+127, 'I'+127, 'N'+127, 'G'+127, 255, 'I'+127, 'T'+127, 'E'+127, 'M'+127, 'S'+127, 253
2494+  6F92 C7C4C0CBD3C7FFD1C4D2D3CED1C8CDC6FFC8D3C4CCD2FD
2495+  6FA9                   rept 3
2496+  6FA9~                  db 255
2497+  6FA9                   endm
2497+  6FA9 FF          >      db 255
2497+  6FAA FF          >      db 255
2497+  6FAB FF          >      db 255
2498+  6FAC             ;  % 00HP  % 00HP % 00HP
2499+  6FAC                   db 255, 255, 39, 255, 'L'+127, 'O'+127, 'W'+127, 255, 255, 255, 45, 255, 'M'+127, 'I'+127, 'D'+127, 255, 255, 46, 255, 'H'+127, 'I'+127, 'G'+127, 'H'+127
2499+  6FAC FFFF27FFCBCED6FFFFFF2DFFCCC8C3FFFF2EFFC7C8C6C7
2500+  6FC3                   rept 3+26
2501+  6FC3~                  db 255
2502+  6FC3                   endm
2502+  6FC3 FF          >      db 255
2502+  6FC4 FF          >      db 255
2502+  6FC5 FF          >      db 255
2502+  6FC6 FF          >      db 255
2502+  6FC7 FF          >      db 255
2502+  6FC8 FF          >      db 255
2502+  6FC9 FF          >      db 255
2502+  6FCA FF          >      db 255
2502+  6FCB FF          >      db 255
2502+  6FCC FF          >      db 255
2502+  6FCD FF          >      db 255
2502+  6FCE FF          >      db 255
2502+  6FCF FF          >      db 255
2502+  6FD0 FF          >      db 255
2502+  6FD1 FF          >      db 255
2502+  6FD2 FF          >      db 255
2502+  6FD3 FF          >      db 255
2502+  6FD4 FF          >      db 255
2502+  6FD5 FF          >      db 255
2502+  6FD6 FF          >      db 255
2502+  6FD7 FF          >      db 255
2502+  6FD8 FF          >      db 255
2502+  6FD9 FF          >      db 255
2502+  6FDA FF          >      db 255
2502+  6FDB FF          >      db 255
2502+  6FDC FF          >      db 255
2502+  6FDD FF          >      db 255
2502+  6FDE FF          >      db 255
2502+  6FDF FF          >      db 255
2503+  6FE0             ;ATTACK BONUS ITEMS:
2504+  6FE0                   db 'A'+127, 'T'+127, 'T'+127, 'A'+127, 'C'+127, 'K'+127, 255, 'B'+127, 'O'+127, 'N'+127, 'U'+127, 'S'+127, 255, 'I'+127, 'T'+127, 'E'+127, 'M'+127, 'S'+127, 253
2504+  6FE0 C0D3D3C0C2CAFFC1CECDD4D2FFC8D3C4CCD2FD
2505+  6FF3                   rept 7
2506+  6FF3~                  db 255
2507+  6FF3                   endm
2507+  6FF3 FF          >      db 255
2507+  6FF4 FF          >      db 255
2507+  6FF5 FF          >      db 255
2507+  6FF6 FF          >      db 255
2507+  6FF7 FF          >      db 255
2507+  6FF8 FF          >      db 255
2507+  6FF9 FF          >      db 255
2508+  6FFA             ;  % +00   % +00   % +00
2509+  6FFA                   db 255, 255, 41, 255, 246, 'L'+127, 'O'+127, 'W'+127, 255, 255, 49, 255, 246, 'M'+127, 'I'+127, 'D'+127, 255, 255, 48, 255, 246, 'H'+127, 'I'+127, 'G'+127, 'H'+127
2509+  6FFA FFFF29FFF6CBCED6FFFF31FFF6CCC8C3FFFF30FFF6C7C8C6C7
2510+  7013                   rept 1+26
2511+  7013~                  db 255
2512+  7013                   endm
2512+  7013 FF          >      db 255
2512+  7014 FF          >      db 255
2512+  7015 FF          >      db 255
2512+  7016 FF          >      db 255
2512+  7017 FF          >      db 255
2512+  7018 FF          >      db 255
2512+  7019 FF          >      db 255
2512+  701A FF          >      db 255
2512+  701B FF          >      db 255
2512+  701C FF          >      db 255
2512+  701D FF          >      db 255
2512+  701E FF          >      db 255
2512+  701F FF          >      db 255
2512+  7020 FF          >      db 255
2512+  7021 FF          >      db 255
2512+  7022 FF          >      db 255
2512+  7023 FF          >      db 255
2512+  7024 FF          >      db 255
2512+  7025 FF          >      db 255
2512+  7026 FF          >      db 255
2512+  7027 FF          >      db 255
2512+  7028 FF          >      db 255
2512+  7029 FF          >      db 255
2512+  702A FF          >      db 255
2512+  702B FF          >      db 255
2512+  702C FF          >      db 255
2512+  702D FF          >      db 255
2513+  702E             ;DEFENSE BONUS ITEMS:
2514+  702E                   db 'D'+127, 'E'+127, 'F'+127, 'E'+127, 'N'+127, 'S'+127, 'E'+127, 255, 'B'+127, 'O'+127, 'N'+127, 'U'+127, 'S'+127, 255, 'I'+127, 'T'+127, 'E'+127, 'M'+127, 'S'+127, 253
2514+  702E C3C4C5C4CDD2C4FFC1CECDD4D2FFC8D3C4CCD2FD
2515+  7042                   rept 6
2516+  7042~                  db 255
2517+  7042                   endm
2517+  7042 FF          >      db 255
2517+  7043 FF          >      db 255
2517+  7044 FF          >      db 255
2517+  7045 FF          >      db 255
2517+  7046 FF          >      db 255
2517+  7047 FF          >      db 255
2518+  7048             ;  % +00   % +00   % +00
2519+  7048                   db 255, 255, 42, 255, 246, 'L'+127, 'O'+127, 'W'+127, 255, 255, 50, 255, 246, 'M'+127, 'I'+127, 'D'+127, 255, 255, 51, 255, 246, 'H'+127, 'I'+127, 'G'+127, 'H'+127,255
2519+  7048 FFFF2AFFF6CBCED6FFFF32FFF6CCC8C3FFFF33FFF6C7C8C6C7FF
2520+  7062                   
2521+  7062             
2522+  7062             
2523+  7062             introtext6:
2524+  7062             ; start at 2,3
2525+  7062             ;     - HOW TO PLAY -
2526+  7062                   db 255,255,255,255,255,254,255,'H'+127,'O'+127,'W'+127,255,'T'+127,'O'+127,255,'P'+127,'L'+127,'A'+127,'Y'+127,255,254
2526+  7062 FFFFFFFFFFFEFFC7CED6FFD3CEFFCFCBC0D8FFFE
2527+  7076                   rept 6+26
2528+  7076~                  db 255
2529+  7076                   endm
2529+  7076 FF          >      db 255
2529+  7077 FF          >      db 255
2529+  7078 FF          >      db 255
2529+  7079 FF          >      db 255
2529+  707A FF          >      db 255
2529+  707B FF          >      db 255
2529+  707C FF          >      db 255
2529+  707D FF          >      db 255
2529+  707E FF          >      db 255
2529+  707F FF          >      db 255
2529+  7080 FF          >      db 255
2529+  7081 FF          >      db 255
2529+  7082 FF          >      db 255
2529+  7083 FF          >      db 255
2529+  7084 FF          >      db 255
2529+  7085 FF          >      db 255
2529+  7086 FF          >      db 255
2529+  7087 FF          >      db 255
2529+  7088 FF          >      db 255
2529+  7089 FF          >      db 255
2529+  708A FF          >      db 255
2529+  708B FF          >      db 255
2529+  708C FF          >      db 255
2529+  708D FF          >      db 255
2529+  708E FF          >      db 255
2529+  708F FF          >      db 255
2529+  7090 FF          >      db 255
2529+  7091 FF          >      db 255
2529+  7092 FF          >      db 255
2529+  7093 FF          >      db 255
2529+  7094 FF          >      db 255
2529+  7095 FF          >      db 255
2530+  7096             ;THE DUNGEON IS CRAWLING
2531+  7096                   db 'T'+127, 'H'+127, 'E'+127, 255, 'D'+127, 'U'+127, 'N'+127, 'G'+127, 'E'+127, 'O'+127, 'N'+127, 255, 'I'+127, 'S'+127, 255, 'C'+127, 'R'+127, 'A'+127, 'W'+127, 'L'+127, 'I'+127, 'N'+127, 'G'+127
2531+  7096 D3C7C4FFC3D4CDC6C4CECDFFC8D2FFC2D1C0D6CBC8CDC6
2532+  70AD                   rept 3
2533+  70AD~                  db 255
2534+  70AD                   endm
2534+  70AD FF          >      db 255
2534+  70AE FF          >      db 255
2534+  70AF FF          >      db 255
2535+  70B0             ;WITH VARIOUS ENEMIES. 
2536+  70B0                   db 'W'+127, 'I'+127, 'T'+127, 'H'+127, 255, 'V'+127, 'A'+127, 'R'+127, 'I'+127, 'O'+127, 'U'+127, 'S'+127, 255, 'E'+127, 'N'+127, 'E'+127, 'M'+127, 'I'+127, 'E'+127, 'S'+127, 255
2536+  70B0 D6C8D3C7FFD5C0D1C8CED4D2FFC4CDC4CCC8C4D2FF
2537+  70C5                   rept 5
2538+  70C5~                  db 255
2539+  70C5                   endm
2539+  70C5 FF          >      db 255
2539+  70C6 FF          >      db 255
2539+  70C7 FF          >      db 255
2539+  70C8 FF          >      db 255
2539+  70C9 FF          >      db 255
2540+  70CA             ;MOST OF THEM WILL STOP AT
2541+  70CA                   db 'M'+127, 'O'+127, 'S'+127, 'T'+127, 255, 'O'+127, 'F'+127, 255, 'T'+127, 'H'+127, 'E'+127, 'M'+127, 255, 'W'+127, 'I'+127, 'L'+127, 'L'+127, 255, 'S'+127, 'T'+127, 'O'+127, 'P'+127, 255, 'A'+127, 'T'+127
2541+  70CA CCCED2D3FFCEC5FFD3C7C4CCFFD6C8CBCBFFD2D3CECFFFC0D3
2542+  70E3                   rept 1
2543+  70E3~                  db 255
2544+  70E3                   endm
2544+  70E3 FF          >      db 255
2545+  70E4             ;NOTHING TO DESTROY YOU!
2546+  70E4                   db 'N'+127, 'O'+127, 'T'+127, 'H'+127, 'I'+127, 'N'+127, 'G'+127, 255, 'T'+127, 'O'+127, 255, 'D'+127, 'E'+127, 'S'+127, 'T'+127, 'R'+127, 'O'+127, 'Y'+127, 255, 'Y'+127, 'O'+127, 'U'+127, 249
2546+  70E4 CDCED3C7C8CDC6FFD3CEFFC3C4D2D3D1CED8FFD8CED4F9
2547+  70FB                   rept 3
2548+  70FB~                  db 255
2549+  70FB                   endm
2549+  70FB FF          >      db 255
2549+  70FC FF          >      db 255
2549+  70FD FF          >      db 255
2550+  70FE             ;   % BAT      % DRAGON
2551+  70FE                   db 255, 255, 255, 96, 255, 'B'+127, 'A'+127, 'T'+127, 255, 255, 255, 255, 255, 255, 106, 255, 'D'+127, 'R'+127, 'A'+127, 'G'+127, 'O'+127, 'N'+127
2551+  70FE FFFFFF60FFC1C0D3FFFFFFFFFFFF6AFFC3D1C0C6CECD
2552+  7114                   rept 4
2553+  7114~                  db 255
2554+  7114                   endm
2554+  7114 FF          >      db 255
2554+  7115 FF          >      db 255
2554+  7116 FF          >      db 255
2554+  7117 FF          >      db 255
2555+  7118             ;   % GOBLIN   % GHOST
2556+  7118                   db 255, 255, 255, 98, 255, 'G'+127, 'O'+127, 'B'+127, 'L'+127, 'I'+127, 'N'+127, 255, 255, 255,115, 255, 'G'+127, 'H'+127, 'O'+127, 'S'+127, 'T'+127
2556+  7118 FFFFFF62FFC6CEC1CBC8CDFFFFFF73FFC6C7CED2D3
2557+  712D                   rept 5+26
2558+  712D~                  db 255
2559+  712D                   endm
2559+  712D FF          >      db 255
2559+  712E FF          >      db 255
2559+  712F FF          >      db 255
2559+  7130 FF          >      db 255
2559+  7131 FF          >      db 255
2559+  7132 FF          >      db 255
2559+  7133 FF          >      db 255
2559+  7134 FF          >      db 255
2559+  7135 FF          >      db 255
2559+  7136 FF          >      db 255
2559+  7137 FF          >      db 255
2559+  7138 FF          >      db 255
2559+  7139 FF          >      db 255
2559+  713A FF          >      db 255
2559+  713B FF          >      db 255
2559+  713C FF          >      db 255
2559+  713D FF          >      db 255
2559+  713E FF          >      db 255
2559+  713F FF          >      db 255
2559+  7140 FF          >      db 255
2559+  7141 FF          >      db 255
2559+  7142 FF          >      db 255
2559+  7143 FF          >      db 255
2559+  7144 FF          >      db 255
2559+  7145 FF          >      db 255
2559+  7146 FF          >      db 255
2559+  7147 FF          >      db 255
2559+  7148 FF          >      db 255
2559+  7149 FF          >      db 255
2559+  714A FF          >      db 255
2559+  714B FF          >      db 255
2560+  714C             ;ATTACK BY DIRECTLY WALKING
2561+  714C                   db 'A'+127, 'T'+127, 'T'+127, 'A'+127, 'C'+127, 'K'+127, 255, 'B'+127, 'Y'+127, 255, 'D'+127, 'I'+127, 'R'+127, 'E'+127, 'C'+127, 'T'+127, 'L'+127, 'Y'+127, 255, 'W'+127, 'A'+127, 'L'+127, 'K'+127, 'I'+127, 'N'+127, 'G'+127
2561+  714C C0D3D3C0C2CAFFC1D8FFC3C8D1C4C2D3CBD8FFD6C0CBCAC8CDC6
2562+  7166             ;INTO THEM.
2563+  7166                   db 'I'+127, 'N'+127, 'T'+127, 'O'+127, 255, 'T'+127, 'H'+127, 'E'+127, 'M'+127, 248
2563+  7166 C8CDD3CEFFD3C7C4CCF8
2564+  7170                   rept 16
2565+  7170~                  db 255
2566+  7170                   endm
2566+  7170 FF          >      db 255
2566+  7171 FF          >      db 255
2566+  7172 FF          >      db 255
2566+  7173 FF          >      db 255
2566+  7174 FF          >      db 255
2566+  7175 FF          >      db 255
2566+  7176 FF          >      db 255
2566+  7177 FF          >      db 255
2566+  7178 FF          >      db 255
2566+  7179 FF          >      db 255
2566+  717A FF          >      db 255
2566+  717B FF          >      db 255
2566+  717C FF          >      db 255
2566+  717D FF          >      db 255
2566+  717E FF          >      db 255
2566+  717F FF          >      db 255
2567+  7180             
2568+  7180             
2569+  7180             
2570+  7180             
2571+  7180             keytest:        
2572+  7180 CD AB 7A             call _joy
2573+  7183 E6 10                and    00010000B
2574+  7185 28 07                jr     z,2f
2575+  7187             
2576+  7187 3E 08               ld a,8
2577+  7189 CD 41 01            call 0x0141 ; getin keytest
2578+  718C 3C                  inc a
2579+  718D C8                  ret z
2580+  718E F1          2:      pop af  ; remove ret
2581+  718F C9                  ret        
2582+  7190             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
2583+  7190             spritemask2:
2584+  7190                     db 72-1,80,3*4,1,72-1,120,4*4,1,80-1,128,5*4,1,0xD0
2584+  7190 47500C01477810014F801401D0
2585+  719D             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
2586+  719D             
2587+  719D             foundamulet
2588+  719D CD 41 00    		call    disscr
2589+  71A0 21 CA AF    		ld	hl,MUSIC2			; hl <- initial address of module 
2590+  71A3 CD CF A0            call	PT3_INIT			; Inits PT3 player
2591+  71A6             
2592+  71A6             
2593+  71A6             ; - clean screen
2594+  71A6             
2595+  71A6 21 00 18            ld hl,0x1800
2596+  71A9 CD 53 00            call setwrt
2597+  71AC AF                  xor a
2598+  71AD 47                  ld  b,a
2599+  71AE 3D                  dec a
2600+  71AF                     rept    3
2601+  71AF~            1:      out (0x98),a
2602+  71AF~                    nop
2603+  71AF~                    djnz    1b
2604+  71AF                     endm
2604+  71AF D3 98       >1:      out (0x98),a
2604+  71B1 00          >        nop
2604+  71B2 10 FB       >        djnz    1b
2604+  71B4 D3 98       >1:      out (0x98),a
2604+  71B6 00          >        nop
2604+  71B7 10 FB       >        djnz    1b
2604+  71B9 D3 98       >1:      out (0x98),a
2604+  71BB 00          >        nop
2604+  71BC 10 FB       >        djnz    1b
2605+  71BE             
2606+  71BE 21 54 92            ld hl,ddampat
2607+  71C1 11 00 00            ld de,0x0000
2608+  71C4 CD 72 5D            call    out2k
2609+  71C7 21 0F 90            ld hl,ddamcol
2610+  71CA 11 00 20            ld de,0x2000
2611+  71CD CD 72 5D            call    out2k
2612+  71D0             
2613+  71D0 21 54 92            ld hl,ddampat
2614+  71D3 11 00 08            ld de,0x0000+256*8
2615+  71D6 CD 72 5D            call    out2k
2616+  71D9 21 0F 90            ld hl,ddamcol
2617+  71DC 11 00 28            ld de,0x2000+256*8
2618+  71DF CD 72 5D            call    out2k
2619+  71E2             
2620+  71E2             
2621+  71E2                   ; show sprite 3 at 80,72
2622+  71E2                   ; show sprite 4 at 120,72
2623+  71E2                   ; show sprite 5 at 128,80
2624+  71E2             
2625+  71E2 21 00 1B            ld hl,0x1b00
2626+  71E5 CD 53 00            call setwrt
2627+  71E8 76                  halt
2628+  71E9 21 90 71            ld   hl,spritemask2
2629+  71EC 01 98 0D            ld   bc,(3*4+1)*256+0x98
2630+  71EF ED B3               otir
2631+  71F1             
2632+  71F1             
2633+  71F1             ; Plot amulet picture
2634+  71F1 76                  halt
2635+  71F2 11 B3 72            ld      de,amuletpnt
2636+  71F5 21 A7 18            ld      hl,0x1800+5*32+7
2637+  71F8 01 98 09            ld      bc,9*256+0x98
2638+  71FB             1:
2639+  71FB C5                  push    bc
2640+  71FC             
2641+  71FC CD 53 00            call setwrt
2642+  71FF             
2643+  71FF 01 20 00            ld      bc,32
2644+  7202 09                  add     hl,bc
2645+  7203 E5                  push    hl
2646+  7204             
2647+  7204 EB                  ex      de,hl
2648+  7205 01 98 12            ld      bc,18*256+0x98
2649+  7208 CD 82 7B            call slowotir
2650+  720B EB                  ex      de,hl
2651+  720C             
2652+  720C E1                  pop     hl
2653+  720D C1                  pop     bc
2654+  720E 10 EB               djnz    1b
2655+  7210             
2656+  7210 CD 44 00            call    enascr
2657+  7213             
2658+  7213             ; Draw text 1
2659+  7213             
2660+  7213 21 06 1A            ld      hl,0x1800+16*32+6
2661+  7216 11 82 73            ld      de,amulettext1
2662+  7219 06 02               ld      b,2
2663+  721B 3E 15               ld      a,21
2664+  721D CD 55 73            call    printtext
2665+  7220             
2666+  7220 06 96               ld  b,3*50
2667+  7222 76          1:      halt
2668+  7223 10 FD               djnz    1b
2669+  7225             
2670+  7225             ; Draw text 2
2671+  7225             
2672+  7225 21 06 1A            ld      hl,0x1800+16*32+6
2673+  7228 06 02               ld      b,2
2674+  722A 3E 13               ld      a,19
2675+  722C 11 AC 73            ld      de,amulettext2
2676+  722F CD 55 73            call    printtext
2677+  7232             
2678+  7232                     ; wait  seq == 2
2679+  7232             
2680+  7232 76          1:      halt
2681+  7233 CD A1 72            call keytest2
2682+  7236             
2683+  7236 CD DD 52            call    seq
2684+  7239 3E 01               ld  a,1
2685+  723B BD                  cp  l
2686+  723C 30 F4               jr  nc,1b
2687+  723E             
2688+  723E             ; Draw text 3
2689+  723E             
2690+  723E 21 06 1A            ld      hl,0x1800+16*32+6
2691+  7241 06 03               ld      b,3
2692+  7243 3E 17               ld      a,23
2693+  7245 11 D2 73            ld      de,amulettext3
2694+  7248 CD 55 73            call    printtext
2695+  724B             
2696+  724B                     ; wait  seq == 3
2697+  724B             
2698+  724B 76          1:      halt
2699+  724C CD A1 72            call keytest2
2700+  724F             
2701+  724F CD DD 52            call    seq
2702+  7252 3E 02               ld  a,2
2703+  7254 BD                  cp  l
2704+  7255 30 F4               jr  nc,1b
2705+  7257             
2706+  7257             ; Draw text 4
2707+  7257             
2708+  7257 21 06 1A            ld      hl,0x1800+16*32+6
2709+  725A 06 03               ld      b,3
2710+  725C 3E 17               ld      a,23
2711+  725E 11 17 74            ld      de,amulettext4
2712+  7261 CD 55 73            call    printtext
2713+  7264             
2714+  7264                     ; wait  seq == 4
2715+  7264             
2716+  7264 76          1:      halt
2717+  7265 CD A1 72            call keytest2
2718+  7268             
2719+  7268 CD DD 52            call    seq
2720+  726B 3E 03               ld  a,3
2721+  726D BD                  cp  l
2722+  726E 30 F4               jr  nc,1b
2723+  7270             
2724+  7270             ; restore in fame tiles
2725+  7270             
2726+  7270             restoreingamescreen:
2727+  7270             
2728+  7270 CD 41 00            call    disscr
2729+  7273 21 BF 7F            ld hl,ddpatterns
2730+  7276 11 00 00            ld de,0x0000
2731+  7279 CD 72 5D            call    out2k
2732+  727C 21 0B 7D            ld hl,ddcolors
2733+  727F 11 00 20            ld de,0x2000
2734+  7282 CD 72 5D            call    out2k
2735+  7285             
2736+  7285 21 BF 7F            ld hl,ddpatterns
2737+  7288 11 00 08            ld de,0x0000+256*8
2738+  728B CD 72 5D            call    out2k
2739+  728E 21 0B 7D            ld hl,ddcolors
2740+  7291 11 00 28            ld de,0x2000+256*8
2741+  7294 CD 72 5D            call    out2k
2742+  7297             
2743+  7297 CD 7E 76            call _nosprt
2744+  729A CD F5 5C            call drawlogo
2745+  729D CD 44 00            call    enascr
2746+  72A0             
2747+  72A0 C9                  ret
2748+  72A1             
2749+  72A1             keytest2:
2750+  72A1 CD AB 7A             call _joy
2751+  72A4 E6 10                and    00010000B
2752+  72A6 28 07                jr     z,2f
2753+  72A8             
2754+  72A8 3E 08               ld a,8
2755+  72AA CD 41 01            call 0x0141 ; getin keytest2
2756+  72AD 3C                  inc a
2757+  72AE C8                  ret z
2758+  72AF F1          2:      pop af  ; remove ret
2759+  72B0 C3 70 72            jp  restoreingamescreen
2760+  72B3             
2761+  72B3             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
2762+  72B3             amuletpnt:
2763+  72B3                   ; show amulet at 7,5
2764+  72B3                   db 48,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 80
2764+  72B3 30000102030405060708090A0B0C0D0E0F50
2765+  72C5                   db 49, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 81
2765+  72C5 31202122232425262728292A2B2C2D2E2F51
2766+  72D7                   db 50, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 82
2766+  72D7 32404142434445464748494A4B4C4D4E4F52
2767+  72E9                   db 51, 96, 97, 98, 99,100,101,102,103,104,105,106,107,108,109,110,111, 83
2767+  72E9 33606162636465666768696A6B6C6D6E6F53
2768+  72FB                   db 52,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143, 84
2768+  72FB 34808182838485868788898A8B8C8D8E8F54
2769+  730D                   db 53,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175, 85
2769+  730D 35A0A1A2A3A4A5A6A7A8A9AAABACADAEAF55
2770+  731F                   db 54,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207, 86
2770+  731F 36C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF56
2771+  7331                   db 55,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239, 87
2771+  7331 37E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF57
2772+  7343                   db 56, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 88
2772+  7343 38101112131415161718191A1B1C1D1E1F58
2773+  7355             
2774+  7355             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
2775+  7355             ;       B # of line
2776+  7355             ;       A # line length
2777+  7355             ;       HL VRAM address
2778+  7355             ;       DE RAM  address
2779+  7355             
2780+  7355             printtext:
2781+  7355 76                  halt
2782+  7356 D9                  exx
2783+  7357 08                  ex  af,af
2784+  7358 06 00               ld  b,0
2785+  735A 21 00 1A            ld  hl,0x1800+32*16
2786+  735D CD 53 00            call setwrt         
2787+  7360 AF                  xor a
2788+  7361 D3 98       1:      out (0x98),a
2789+  7363 00                  nop
2790+  7364 00                  nop
2791+  7365 10 FA               djnz 1b
2792+  7367 08                  ex      af,af
2793+  7368 D9                  exx
2794+  7369             
2795+  7369             _printtext:
2796+  7369 76                  halt
2797+  736A             1:      
2798+  736A C5                  push    bc
2799+  736B F5                  push    af
2800+  736C CD 53 00            call setwrt         
2801+  736F F1                  pop     af
2802+  7370             
2803+  7370 01 40 00            ld      bc,64
2804+  7373 09                  add     hl,bc
2805+  7374 E5                  push    hl
2806+  7375                     
2807+  7375 EB                  ex      de,hl
2808+  7376 47                  ld      b,a
2809+  7377 0E 98               ld      c,0x98
2810+  7379 CD 82 7B            call slowotir
2811+  737C EB                  ex      de,hl        
2812+  737D                     
2813+  737D E1                  pop     hl
2814+  737E C1                  pop     bc
2815+  737F 10 E9               djnz    1b
2816+  7381 C9                  ret
2817+  7382             
2818+  7382             amulettext1:
2819+  7382             
2820+  7382             ; show text at 6,16
2821+  7382             ;WELL DONE!
2822+  7382                   db 87+127, 69+127, 76+127, 76+127, 255, 68+127, 79+127, 78+127, 69+127, 249
2822+  7382 D6C4CBCBFFC3CECDC4F9
2823+  738C                   rept 11
2824+  738C~                  db 255
2825+  738C                   endm
2825+  738C FF          >      db 255
2825+  738D FF          >      db 255
2825+  738E FF          >      db 255
2825+  738F FF          >      db 255
2825+  7390 FF          >      db 255
2825+  7391 FF          >      db 255
2825+  7392 FF          >      db 255
2825+  7393 FF          >      db 255
2825+  7394 FF          >      db 255
2825+  7395 FF          >      db 255
2825+  7396 FF          >      db 255
2826+  7397             ;YOU FOUND THE AMULET.
2827+  7397                   db 89+127, 79+127, 85+127, 255, 70+127, 79+127, 85+127, 78+127, 68+127, 255, 84+127, 72+127, 69+127, 255, 65+127, 77+127, 85+127, 76+127, 69+127, 84+127, 255
2827+  7397 D8CED4FFC5CED4CDC3FFD3C7C4FFC0CCD4CBC4D3FF
2828+  73AC             
2829+  73AC             ; wait a few seconds
2830+  73AC             ; clear text
2831+  73AC             
2832+  73AC             amulettext2:
2833+  73AC             
2834+  73AC             ;pt3 seq#1
2835+  73AC             ; show text at 6,16
2836+  73AC             ;YET, YOU ARE ONLY 
2837+  73AC                   db 89+127, 69+127, 84+127, 247   , 255   , 89+127, 79+127, 85+127, 255,    65+127, 82+127, 69+127, 255, 'O'+127, 'N'+127, 'L'+127, 'Y'+127
2837+  73AC D8C4D3F7FFD8CED4FFC0D1C4FFCECDCBD8
2838+  73BD                   rept (19-17)
2839+  73BD~                  db 255
2840+  73BD                   endm
2840+  73BD FF          >      db 255
2840+  73BE FF          >      db 255
2841+  73BF             ;HALFWAY YOUR QUEST.
2842+  73BF                   db 'H'+127, 'A'+127,'L'+127, 'F'+127, 'W'+127, 'A'+127, 'Y'+127, 255,    89+127, 79+127, 85+127, 82+127, 255   , 81+127, 85+127, 69+127, 83+127, 84+127, 255
2842+  73BF C7C0CBC5D6C0D8FFD8CED4D1FFD0D4C4D2D3FF
2843+  73D2             
2844+  73D2             ; wait a few seconds
2845+  73D2             ; clear text
2846+  73D2             
2847+  73D2             amulettext3
2848+  73D2             
2849+  73D2             ;pt3 seq#2
2850+  73D2             ; show text at 5,16
2851+  73D2             ;QUICKLY!
2852+  73D2                   db 81+127, 85+127, 73+127, 67+127, 75+127, 76+127, 89+127, 249
2852+  73D2 D0D4C8C2CACBD8F9
2853+  73DA                   rept (23-8)
2854+  73DA~                  db 255
2855+  73DA                   endm
2855+  73DA FF          >      db 255
2855+  73DB FF          >      db 255
2855+  73DC FF          >      db 255
2855+  73DD FF          >      db 255
2855+  73DE FF          >      db 255
2855+  73DF FF          >      db 255
2855+  73E0 FF          >      db 255
2855+  73E1 FF          >      db 255
2855+  73E2 FF          >      db 255
2855+  73E3 FF          >      db 255
2855+  73E4 FF          >      db 255
2855+  73E5 FF          >      db 255
2855+  73E6 FF          >      db 255
2855+  73E7 FF          >      db 255
2855+  73E8 FF          >      db 255
2856+  73E9                   
2857+  73E9             ;IF YOU EVER WISH TO SEE
2858+  73E9                   db 73+127, 70+127, 255, 89+127, 79+127, 85+127, 255, 'E'+127, 'V'+127, 'E'+127, 'R'+127, 255, 'W'+127, 'I'+127, 'S'+127, 'H'+127, 255, 84+127, 79+127, 255, 83+127, 69+127, 69+127
2858+  73E9 C8C5FFD8CED4FFC4D5C4D1FFD6C8D2C7FFD3CEFFD2C4C4
2859+  7400             ;THE LIGHT OF DAY AGAIN,
2860+  7400                   db 84+127, 72+127, 69+127, 255, 76+127, 73+127, 71+127, 72+127, 84+127, 255, 79+127, 70+127, 255, 68+127, 65+127, 89+127, 255, 65+127, 71+127,65+127, 73+127, 78+127, 247
2860+  7400 D3C7C4FFCBC8C6C7D3FFCEC5FFC3C0D8FFC0C6C0C8CDF7
2861+  7417             
2862+  7417             
2863+  7417             amulettext4:
2864+  7417             
2865+  7417             ; wait a few seconds
2866+  7417             ; clear text
2867+  7417             ;pt3 seq#3
2868+  7417             ; show text at 5,16
2869+  7417             ;ASCEND BACK FROM THESE
2870+  7417                   db 65+127, 83+127, 67+127, 69+127, 78+127, 68+127, 255, 66+127, 65+127, 67+127, 75+127, 255, 70+127, 82+127, 79+127, 77+127, 255, 84+127, 72+127, 69+127, 83+127, 69+127,255
2870+  7417 C0D2C2C4CDC3FFC1C0C2CAFFC5D1CECCFFD3C7C4D2C4FF
2871+  742E             ;DANK DEPTHS OF THE DEEP
2872+  742E                   db 68+127, 65+127, 78+127, 75+127, 255, 68+127, 69+127, 80+127, 84+127, 72+127, 83+127, 255, 79+127, 70+127, 255, 84+127, 72+127, 69+127, 255, 68+127, 69+127, 69+127, 80+127
2872+  742E C3C0CDCAFFC3C4CFD3C7D2FFCEC5FFD3C7C4FFC3C4C4CF
2873+  7445             ;DUNGEON!
2874+  7445                   db 68+127, 85+127, 78+127, 71+127, 69+127, 79+127, 78+127,249
2874+  7445 C3D4CDC6C4CECDF9
2875+  744D                   rept (23-8)
2876+  744D~                  db 255
2877+  744D                   endm
2877+  744D FF          >      db 255
2877+  744E FF          >      db 255
2877+  744F FF          >      db 255
2877+  7450 FF          >      db 255
2877+  7451 FF          >      db 255
2877+  7452 FF          >      db 255
2877+  7453 FF          >      db 255
2877+  7454 FF          >      db 255
2877+  7455 FF          >      db 255
2877+  7456 FF          >      db 255
2877+  7457 FF          >      db 255
2877+  7458 FF          >      db 255
2877+  7459 FF          >      db 255
2877+  745A FF          >      db 255
2877+  745B FF          >      db 255
2878+  745C             
2879+  745C             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
2880+  745C             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
2881+  745C             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
2882+  745C             
2883+  745C             spritemask3:
2884+  745C                     db 64-1,104,6*4,1,80-1,104, 7*4,1,96-1,104, 8*4,1
2884+  745C 3F6818014F681C015F682001
2885+  7468                     db 64-1,144,9*4,1,80-1,144,10*4,1,96-1,144,11*4,1,0xD0
2885+  7468 3F9024014F9028015F902C01D0
2886+  7475             
2887+  7475             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
2888+  7475             
2889+  7475             badendscript:
2890+  7475             
2891+  7475             ; no need to load tilesets
2892+  7475             ;[silence]
2893+  7475             
2894+  7475             
2895+  7475 21 84 BA    		ld	hl,MUSIC6			; hl <- initial address of module 
2896+  7478 CD CF A0    		call	PT3_INIT			; Inits PT3 player
2897+  747B             
2898+  747B CD 57 5D            call cls
2899+  747E CD 41 00            call    disscr
2900+  7481             		
2901+  7481             ; show sprite 6 at 104,64 and sprite 7 at 104,80 and sprite 8 at 104,96
2902+  7481             ; shpw sprite 9 at 144,64 and sprite 10 at 144,80 and sprite 11 at 144,96
2903+  7481             
2904+  7481 76                  halt
2905+  7482 21 00 1B            ld hl,0x1b00
2906+  7485 CD 53 00            call setwrt
2907+  7488 76                  halt
2908+  7489 21 5C 74            ld   hl,spritemask3
2909+  748C 01 98 19            ld   bc,(6*4+1)*256+0x98
2910+  748F ED B3               otir
2911+  7491             
2912+  7491             
2913+  7491             ; show Exit start pos 11,6 (x,y) width 9 tiles and height 10
2914+  7491                     
2915+  7491 11 4F 75            ld      de,exitpnt
2916+  7494 21 CB 18            ld      hl,0x1800+6*32+11
2917+  7497 01 98 09            ld      bc,9*256+0x98
2918+  749A 76          1:      halt
2919+  749B C5                  push    bc
2920+  749C             
2921+  749C CD 53 00            call setwrt
2922+  749F             
2923+  749F 01 20 00            ld      bc,32
2924+  74A2 09                  add     hl,bc
2925+  74A3 E5                  push    hl
2926+  74A4             
2927+  74A4 EB                  ex      de,hl
2928+  74A5 01 98 09            ld      bc,9*256+0x98
2929+  74A8 ED A3       99:     outi
2930+  74AA 00                  nop
2931+  74AB 00                  nop
2932+  74AC 20 FA               jr  nz,99b
2933+  74AE EB                  ex      de,hl
2934+  74AF             
2935+  74AF E1                  pop     hl
2936+  74B0 C1                  pop     bc
2937+  74B1 10 E7               djnz    1b
2938+  74B3             
2939+  74B3             ; Draw text 1
2940+  74B3             ; show text. start at pos 6,16
2941+  74B3             
2942+  74B3 21 06 1A            ld      hl,0x1800+16*32+6
2943+  74B6 11 A0 75            ld      de,fakeendtext1
2944+  74B9 06 02               ld      b,2
2945+  74BB 3E 14               ld      a,20
2946+  74BD CD 55 73            call    printtext
2947+  74C0             
2948+  74C0 CD 44 00            call    enascr
2949+  74C3             
2950+  74C3             
2951+  74C3 06 96               ld  b,3*50
2952+  74C5 76          1:      halt
2953+  74C6 CD AB 7A             call MAIN._joy
2954+  74C9 E6 10                and    00010000B
2955+  74CB 28 0B                jr     z,2f        ; skip on joystick button
2956+  74CD 3E 08                ld     a,8
2957+  74CF CD 41 01             call   0x0141      ; skip on space
2958+  74D2 E6 01                and    1
2959+  74D4 28 02                jr     z,2f
2960+  74D6 10 ED               djnz    1b
2961+  74D8             2:        
2962+  74D8             
2963+  74D8             ; Draw text 2
2964+  74D8             ; show text at 4,16
2965+  74D8             
2966+  74D8 21 04 1A            ld      hl,0x1800+16*32+4
2967+  74DB 11 C8 75            ld      de,fakeendtext2
2968+  74DE 06 04               ld      b,4
2969+  74E0 3E 1A               ld      a,26
2970+  74E2 CD 55 73            call    printtext
2971+  74E5             
2972+  74E5 06 FA               ld  b,5*50
2973+  74E7 76          1:      halt
2974+  74E8 CD AB 7A             call MAIN._joy
2975+  74EB E6 10                and    00010000B
2976+  74ED 28 0B                jr     z,2f        ; skip on joystick button
2977+  74EF 3E 08                ld     a,8
2978+  74F1 CD 41 01             call   0x0141      ; skip on space
2979+  74F4 E6 01                and    1
2980+  74F6 28 02                jr     z,2f
2981+  74F8 10 ED               djnz    1b
2982+  74FA             2:      
2983+  74FA             
2984+  74FA             ; Draw text 3
2985+  74FA             ; show text. start at pos 6,16
2986+  74FA             
2987+  74FA 21 06 1A            ld      hl,0x1800+16*32+6
2988+  74FD 11 30 76            ld      de,fakeendtext3
2989+  7500 06 02               ld      b,2
2990+  7502 3E 15               ld      a,21
2991+  7504 CD 55 73            call    printtext
2992+  7507             
2993+  7507 06 96               ld  b,3*50
2994+  7509 76          1:      halt
2995+  750A CD AB 7A             call MAIN._joy
2996+  750D E6 10                and    00010000B
2997+  750F 28 0B                jr     z,2f        ; skip on joystick button
2998+  7511 3E 08                ld     a,8
2999+  7513 CD 41 01             call   0x0141      ; skip on space
3000+  7516 E6 01                and    1
3001+  7518 28 02                jr     z,2f
3002+  751A 10 ED               djnz    1b
3003+  751C             2:      
3004+  751C             
3005+  751C             ; Draw text 4
3006+  751C             ; show text at 7,16
3007+  751C             
3008+  751C 21 07 1A            ld      hl,0x1800+16*32+7
3009+  751F 11 5A 76            ld      de,fakeendtext4
3010+  7522 06 02               ld      b,2
3011+  7524 3E 12               ld      a,18
3012+  7526 CD 55 73            call    printtext
3013+  7529             
3014+  7529 06 96               ld  b,3*50
3015+  752B 76          1:      halt
3016+  752C CD AB 7A             call MAIN._joy
3017+  752F E6 10                and    00010000B
3018+  7531 28 0B                jr     z,2f        ; skip on joystick button
3019+  7533 3E 08                ld     a,8
3020+  7535 CD 41 01             call   0x0141      ; skip on space
3021+  7538 E6 01                and    1
3022+  753A 28 02                jr     z,2f
3023+  753C 10 ED               djnz    1b
3024+  753E             2:      
3025+  753E             
3026+  753E             ; return into the game. Start music again.
3027+  753E CD 7E 76            call _nosprt
3028+  7541 CD F5 5C            call    drawlogo
3029+  7544             
3030+  7544 21 64 AA    		ld	hl,MUSIC1			; hl <- initial address of module 
3031+  7547 CD CF A0    		call	PT3_INIT			; Inits PT3 player
3032+  754A             
3033+  754A DD 21 03 C0         ld ix,PAGE0
3034+  754E             
3035+  754E C9                  ret
3036+  754F             
3037+  754F             exitpnt:
3038+  754F             ; show Exit start pos 11,6 (x,y) width 9 tiles and height 9
3039+  754F               db 255,255,255,128,255,129,130,255,255
3039+  754F FFFFFF80FF8182FFFF
3040+  7558               db 255,255,131,132,133,134,135,136,255
3040+  7558 FFFF838485868788FF
3041+  7561               db 255,137,138,139,140,140,140,141,255
3041+  7561 FF898A8B8C8C8C8DFF
3042+  756A               db 255,142,143,140,140,140,140,144,145
3042+  756A FF8E8F8C8C8C8C9091
3043+  7573               db 255,146,147,140,140,140,140,148,149
3043+  7573 FF92938C8C8C8C9495
3044+  757C               db 255,150,151,140,140,140,140,152,153
3044+  757C FF96978C8C8C8C9899
3045+  7585               db 255,160,161,162,163,164,165,166,167
3045+  7585 FFA0A1A2A3A4A5A6A7
3046+  758E               db 168,169,170,171,172,173,174,175,176
3046+  758E A8A9AAABACADAEAFB0
3047+  7597               db 177,178,179,180,181,182,183,184,185
3047+  7597 B1B2B3B4B5B6B7B8B9
3048+  75A0             
3049+  75A0             fakeendtext1:
3050+  75A0             ; YOU RETURNED, ENDING
3051+  75A0                   db 89+127, 79+127, 85+127, 255, 82+127, 69+127, 84+127, 85+127, 82+127, 78+127, 69+127, 68+127,  247, 255, 69+127, 78+127, 68+127, 73+127, 78+127, 71+127
3051+  75A0 D8CED4FFD1C4D3D4D1CDC4C3F7FFC4CDC3C8CDC6
3052+  75B4             ; YOUR QUEST.
3053+  75B4                   db 89+127, 79+127, 85+127, 82+127, 255, 81+127, 85+127, 69+127, 83+127, 84+127, 248
3053+  75B4 D8CED4D1FFD0D4C4D2D3F8
3054+  75BF                   rept (20-11)
3055+  75BF~                       db 255
3056+  75BF                   endm
3056+  75BF FF          >           db 255
3056+  75C0 FF          >           db 255
3056+  75C1 FF          >           db 255
3056+  75C2 FF          >           db 255
3056+  75C3 FF          >           db 255
3056+  75C4 FF          >           db 255
3056+  75C5 FF          >           db 255
3056+  75C6 FF          >           db 255
3056+  75C7 FF          >           db 255
3057+  75C8             ; wait some time
3058+  75C8             ; clear text
3059+  75C8             
3060+  75C8             ; show text at 4,16
3061+  75C8             fakeendtext2:
3062+  75C8             ;HASTELY, YOU MAKE YOUR WAY
3063+  75C8                   db 72+127, 65+127, 83+127, 84+127, 69+127, 76+127, 89+127, 247, 255, 89+127, 79+127, 85+127, 255, 77+127, 65+127, 75+127, 69+127, 255, 89+127, 79+127, 85+127, 82+127, 255, 87+127, 65+127, 89+127
3063+  75C8 C7C0D2D3C4CBD8F7FFD8CED4FFCCC0CAC4FFD8CED4D1FFD6C0D8
3064+  75E2             ;BACK OUTSIDE, CHASED BY A
3065+  75E2                   db 66+127, 65+127, 67+127, 75+127, 255, 79+127, 85+127, 84+127, 83+127, 73+127, 68+127, 69+127, 247, 255, 67+127, 72+127, 65+127, 83+127, 69+127, 68+127, 255, 66+127, 89+127, 255, 65+127,255
3065+  75E2 C1C0C2CAFFCED4D3D2C8C3C4F7FFC2C7C0D2C4C3FFC1D8FFC0FF
3066+  75FC             ;FIERCE HORDE OF YOUR
3067+  75FC                   db 70+127, 73+127, 69+127, 82+127, 67+127, 69+127, 255, 72+127, 79+127, 82+127, 68+127, 69+127, 255, 79+127, 70+127, 255, 89+127, 79+127, 85+127, 82+127,255,255,255,255,255,255
3067+  75FC C5C8C4D1C2C4FFC7CED1C3C4FFCEC5FFD8CED4D1FFFFFFFFFFFF
3068+  7616             ;ENEMIES.
3069+  7616                   db 'E'+127, 'N'+127, 'E'+127, 'M'+127, 'I'+127, 'E'+127, 'S'+127, 255
3069+  7616 C4CDC4CCC8C4D2FF
3070+  761E                   rept (26-8)
3071+  761E~                       db    255
3072+  761E                   endm
3072+  761E FF          >           db    255
3072+  761F FF          >           db    255
3072+  7620 FF          >           db    255
3072+  7621 FF          >           db    255
3072+  7622 FF          >           db    255
3072+  7623 FF          >           db    255
3072+  7624 FF          >           db    255
3072+  7625 FF          >           db    255
3072+  7626 FF          >           db    255
3072+  7627 FF          >           db    255
3072+  7628 FF          >           db    255
3072+  7629 FF          >           db    255
3072+  762A FF          >           db    255
3072+  762B FF          >           db    255
3072+  762C FF          >           db    255
3072+  762D FF          >           db    255
3072+  762E FF          >           db    255
3072+  762F FF          >           db    255
3073+  7630             ; wait some time
3074+  7630             ; clear text
3075+  7630             
3076+  7630             fakeendtext3:
3077+  7630             ;show text at 6,16
3078+  7630             ;...BUT AREN'T YOU
3079+  7630                   db 248, 248, 248, 66+127, 85+127, 84+127, 255, 65+127, 82+127, 69+127, 78+127, 251, 84+127, 255, 89+127, 79+127, 85+127,255,255,255,255
3079+  7630 F8F8F8C1D4D3FFC0D1C4CDFBD3FFD8CED4FFFFFFFF
3080+  7645             ;FORGETTING SOMETHING?
3081+  7645                   db 'F'+127,'O'+127,'R'+127,'G'+127,'E'+127,'T'+127,'T'+127,'I'+127,'N'+127,'G'+127,255,'S'+127,'O'+127,'M'+127,'E'+127,'T'+127,'H'+127,'I'+127,'N'+127,'G'+127,250
3081+  7645 C5CED1C6C4D3D3C8CDC6FFD2CECCC4D3C7C8CDC6FA
3082+  765A             
3083+  765A             ; wait some time
3084+  765A             ; clear text
3085+  765A             
3086+  765A             ;show text at 7,16
3087+  765A             fakeendtext4:
3088+  765A             ;YOU FEEL SILLY AND
3089+  765A                   db 89+127, 79+127, 85+127, 255, 70+127, 69+127, 69+127, 76+127, 255, 83+127, 73+127, 76+127, 76+127, 89+127, 255, 65+127, 78+127, 68+127
3089+  765A D8CED4FFC5C4C4CBFFD2C8CBCBD8FFC0CDC3
3090+  766C             ;RETURN.
3091+  766C                   db 82+127, 69+127, 84+127, 85+127, 82+127, 78+127, 255
3091+  766C D1C4D3D4D1CDFF
3092+  7673                   rept (18-7)
3093+  7673~                       db    255
3094+  7673                   endm
3094+  7673 FF          >           db    255
3094+  7674 FF          >           db    255
3094+  7675 FF          >           db    255
3094+  7676 FF          >           db    255
3094+  7677 FF          >           db    255
3094+  7678 FF          >           db    255
3094+  7679 FF          >           db    255
3094+  767A FF          >           db    255
3094+  767B FF          >           db    255
3094+  767C FF          >           db    255
3094+  767D FF          >           db    255
3095+  767E             
3096+  767E             
3097+  767E             
3098+  767E             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3099+  767E             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3100+  767E             ; disable all sprites
3101+  767E             
3102+  767E             _nosprt:
3103+  767E F3                      di
3104+  767F AF                      xor a
3105+  7680 D3 99                   out (0x99),a
3106+  7682 3E 5B                   ld a,0x1b00/256 + 0x40 ; SAT
3107+  7684 D3 99                   out (0x99),a
3108+  7686 3E D0                   ld a,0xD0
3109+  7688 D3 98                   out (0x98),a ; disable sprites
3110+  768A FB                      ei
3111+  768B C9                      ret
3112+  768C             
3113+  768C             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3114+  768C             
3115+  768C             ;----- text
3116+  768C             
3117+  768C             
3118+  768C             startgamemessage:
3119+  768C             ;         db "PRESS SPACE TO START"
3120+  768C                      db 80+127, 82+127, 69+127, 83+127, 83+127, 255, 83+127, 80+127, 65+127, 67+127, 69+127, 255, 84+127, 79+127, 255, 83+127, 84+127, 65+127, 82+127, 84+127
3120+  768C CFD1C4D2D2FFD2CFC0C2C4FFD3CEFFD2D3C0D1D3
3121+  76A0             
3122+  76A0             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3123+  76A0             
3124+  76A0             render:
3125+  76A0 CD B9 5A             call   _3dview
3126+  76A3 CD FC 77             call   new_colors
3127+  76A6             
3128+  76A6 21 00 18             ld     hl,0x1800
3129+  76A9 CD 53 00             call   setwrt
3130+  76AC EB                   ex     de,hl
3131+  76AD 21 03 C1             ld     hl,buffer
3132+  76B0 01 98 18             ld     bc,24*256+0x98
3133+  76B3             2:
3134+  76B3 C5                   push   bc
3135+  76B4 06 18                ld     b,24 ; always 24
3136+  76B6 ED A3       1:       outi
3137+  76B8 00                   nop
3138+  76B9 20 FB                jr nz,1b
3139+  76BB                         
3140+  76BB EB                   ex     de,hl
3141+  76BC 01 20 00             ld     bc,32
3142+  76BF 09                   add    hl,bc
3143+  76C0 CD 53 00             call   setwrt
3144+  76C3 EB                   ex     de,hl
3145+  76C4             
3146+  76C4 C1                   pop    bc
3147+  76C5 10 EC                djnz   2b
3148+  76C7             
3149+  76C7                      ;
3150+  76C7                      ;
3151+  76C7             sidebar:
3152+  76C7             ;-- "Hp:10 Gold:0000 L:01"
3153+  76C7             
3154+  76C7 21 B8 18             ld hl,0x18A0+24
3155+  76CA CD 53 00             call setwrt
3156+  76CD 21 FB 56             ld hl,gold
3157+  76D0 06 04                ld b,4
3158+  76D2 CD 82 7B             call slowotir
3159+  76D5 DD 7E 11             ld a,(ix+GOLD)
3160+  76D8 21 BF 18             ld hl,0x18A0+31
3161+  76DB CD A2 55             call writebcd
3162+  76DE DD 7E 12             ld a,(ix+GOLD100)
3163+  76E1 2B                   dec hl
3164+  76E2 CD A2 55             call writebcd
3165+  76E5             
3166+  76E5 21 18 19             ld hl,0x1900+24
3167+  76E8 CD 53 00             call setwrt
3168+  76EB 21 F6 56             ld hl,hp
3169+  76EE 06 05                ld b,5
3170+  76F0 CD 82 7B             call slowotir
3171+  76F3 DD 7E 0B             ld a,(ix+HITPOINTS)
3172+  76F6 21 1F 19             ld hl,0x1900+31
3173+  76F9 CD A2 55             call writebcd
3174+  76FC             
3175+  76FC 21 58 19             ld hl,0x1960+24-32
3176+  76FF CD 53 00             call setwrt
3177+  7702 21 FF 56             ld hl,att
3178+  7705 06 06                ld b,6
3179+  7707 CD 82 7B             call slowotir
3180+  770A DD 7E 0D             ld a,(ix+ATT)
3181+  770D 21 5F 19             ld hl,0x1960+31-32
3182+  7710 CD A2 55             call writebcd
3183+  7713             
3184+  7713 21 78 19             ld hl,0x1980+24-32
3185+  7716 CD 53 00             call setwrt
3186+  7719 21 05 57             ld hl,def
3187+  771C 06 06                ld b,6
3188+  771E CD 82 7B             call slowotir
3189+  7721 DD 7E 0C             ld a,(ix+DEF)
3190+  7724 21 7F 19             ld hl,0x1980+31-32
3191+  7727 CD A2 55             call writebcd
3192+  772A             
3193+  772A             
3194+  772A DD 7E 14             ld a,(ix+AMULET)
3195+  772D A7                   and    a
3196+  772E 28 16                jr z,1f
3197+  7730 21 D8 1A             ld hl,0x1A80+24+64
3198+  7733 CD 53 00             call setwrt
3199+  7736 21 11 57             ld hl,amulet
3200+  7739 06 03                ld b,3
3201+  773B CD 82 7B             call slowotir
3202+  773E 3E 2B                ld     a,amuletchr
3203+  7740 21 DE 1A             ld hl,0x1A80+30+64
3204+  7743 CD 4D 00             call   wrtvrm
3205+  7746             1:
3206+  7746 21 B8 1A             ld hl,0x1AC0+24-32
3207+  7749 CD 53 00             call setwrt
3208+  774C 21 0B 57             ld hl,lv
3209+  774F 06 06                ld b,6
3210+  7751 CD 82 7B             call slowotir
3211+  7754 DD 7E 13             ld a,(ix+LEVEL)
3212+  7757 21 BF 1A             ld hl,0x1AC0+31-32
3213+  775A CD A2 55             call writebcd
3214+  775D             
3215+  775D 21 F8 1A             ld hl,0x1AC0+24+32
3216+  7760 CD 53 00             call setwrt
3217+  7763 3E 2C                ld     a,44           ;T
3218+  7765 D3 98                out    (0x98),a
3219+  7767 3E FD                ld     a,253           ;:
3220+  7769 00                   nop
3221+  776A 00                   nop
3222+  776B D3 98                out    (0x98),a
3223+  776D             
3224+  776D 21 FF 1A             ld hl,0x1AC0+31+32
3225+  7770 3A 00 C0             ld a,(nround)
3226+  7773 CD A2 55             call writebcd
3227+  7776 3A 01 C0             ld a,(nround+1)
3228+  7779 2B                   dec hl         
3229+  777A CD A2 55             call writebcd
3230+  777D 3A 02 C0             ld a,(nround+2)
3231+  7780 2B                   dec hl         
3232+  7781 CD A2 55             call writebcd
3233+  7784             
3234+  7784 C9                   ret
3235+  7785             logo:
3236+  7785                     db  224,225,226,227,228,229,230,255
3236+  7785 E0E1E2E3E4E5E6FF
3237+  778D                     db  231,232,233,234,235,236,237,238
3237+  778D E7E8E9EAEBECEDEE
3238+  7795                     db  255,239,240,241,242,243,244,245
3238+  7795 FFEFF0F1F2F3F4F5
3239+  779D             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3240+  779D             ;
3241+  779D             setdot:
3242+  779D 08                  ex  af,af
3243+  779E D9                  exx
3244+  779F             
3245+  779F             ;-- displace depth indicator in the scorebar
3246+  779F             
3247+  779F 3A 25 C0            ld  a,(PAGE0+_lastlevel)
3248+  77A2 CD 43 79            call    Bcd2Hex
3249+  77A5 3D                  dec a
3250+  77A6 4F                  ld  c,a
3251+  77A7             
3252+  77A7 AF                  xor a
3253+  77A8 67                  ld  h,a
3254+  77A9 57                  ld  d,a
3255+  77AA                     
3256+  77AA 3A 16 C0            ld  a,(PAGE0+LEVEL)
3257+  77AD CD 43 79            call    Bcd2Hex
3258+  77B0 3D                  dec a
3259+  77B1 87                  add a,a
3260+  77B2 87                  add a,a
3261+  77B3 5F                  ld  e,a    ;x4
3262+  77B4             
3263+  77B4 6F                  ld  l,a
3264+  77B5                     
3265+  77B5 29                  add hl,hl
3266+  77B6 29                  add hl,hl
3267+  77B7 29                  add hl,hl   ;x32
3268+  77B8                     
3269+  77B8 19                  add hl,de   ;x36
3270+  77B9 AF                  xor a
3271+  77BA CD D2 78            call    div16
3272+  77BD 55                  ld      d,l
3273+  77BE                     
3274+  77BE 21 00 1B            ld      hl,0x1b00
3275+  77C1 CD 53 00            call    setwrt        
3276+  77C4 3E 6F               ld      a,14*8-1
3277+  77C6 82                  add     a,d
3278+  77C7 F5                  push    af
3279+  77C8 D3 98               out (0x98),a
3280+  77CA 3E E0               ld    a,28*8
3281+  77CC 00                  nop
3282+  77CD 00                  nop
3283+  77CE D3 98               out (0x98),a
3284+  77D0 3E 70               ld    a,112
3285+  77D2 00                  nop
3286+  77D3 00                  nop
3287+  77D4 D3 98               out (0x98),a
3288+  77D6 00                  nop
3289+  77D7 00                  nop
3290+  77D8 3E 0F               ld    a,15
3291+  77DA D3 98               out (0x98),a
3292+  77DC             
3293+  77DC F1                  pop     af
3294+  77DD 00                  nop
3295+  77DE 00                  nop
3296+  77DF D3 98               out (0x98),a
3297+  77E1 3E E0               ld    a,28*8
3298+  77E3 00                  nop
3299+  77E4 00                  nop
3300+  77E5 D3 98               out (0x98),a
3301+  77E7 3E 6C               ld    a,108
3302+  77E9 00                  nop
3303+  77EA 00                  nop
3304+  77EB D3 98               out (0x98),a
3305+  77ED 3E 01               ld    a,1
3306+  77EF 00                  nop
3307+  77F0 00                  nop
3308+  77F1 D3 98               out (0x98),a
3309+  77F3 00                  nop
3310+  77F4 00                  nop
3311+  77F5 3E D0               ld    a,0xd0
3312+  77F7 D3 98               out (0x98),a
3313+  77F9 08                  ex  af,af
3314+  77FA D9                  exx
3315+  77FB                     
3316+  77FB C9                  ret
3317+  77FC             
3318+  77FC             ;-- change colors in the level
3319+  77FC             
3320+  77FC             new_colors:
3321+  77FC             
3322+  77FC 08                  ex  af,af
3323+  77FD D9                  exx
3324+  77FE             
3325+  77FE 3A 25 C0            ld  a,(PAGE0+_lastlevel)
3326+  7801 CD 43 79            call    Bcd2Hex
3327+  7804 5F                  ld  e,a
3328+  7805             
3329+  7805 3A 16 C0            ld  a,(PAGE0+LEVEL)
3330+  7808 CD 43 79            call    Bcd2Hex        
3331+  780B 3D                  dec a
3332+  780C 57                  ld  d,a
3333+  780D 87                  add a,a
3334+  780E 87                  add a,a
3335+  780F 82                  add a,d         ; x5
3336+  7810                     
3337+  7810 57                  ld  d,a         ; D = Dividend, E = Divisor, A = 0
3338+  7811 AF                  xor a
3339+  7812 CD 82 57            call    div8    ;Output: D = Quotient, A = Remainder
3340+  7815             
3341+  7815 7A                  ld      a,d
3342+  7816 C6 7A               add     a,122   ; wall(s) position
3343+  7818 6F                  ld      l,a
3344+  7819 26 00               ld      h,0
3345+  781B 29                  add     hl,hl
3346+  781C 29                  add     hl,hl
3347+  781D 29                  add     hl,hl   ;x8
3348+  781E 01 00 20            ld      bc,0x2000  ; vram address
3349+  7821 09                  add     hl,bc
3350+  7822 CD 50 00            call    setrd
3351+  7825 21 03 D1            ld      hl,dummy
3352+  7828 01 98 08            ld      bc,0x0898
3353+  782B CD 88 7B            call slowinir
3354+  782E             
3355+  782E 21 08 20            ld      hl,0x2000+1*8
3356+  7831 CD 53 00            call    setwrt
3357+  7834 21 03 D1            ld      hl,dummy
3358+  7837 01 98 08            ld      bc,0x0898
3359+  783A CD 82 7B            call slowotir
3360+  783D 21 08 28            ld      hl,0x2000+1*8+256*8
3361+  7840 CD 53 00            call    setwrt
3362+  7843 21 03 D1            ld      hl,dummy
3363+  7846 01 98 08            ld      bc,0x0898
3364+  7849 CD 82 7B            call slowotir
3365+  784C 21 08 30            ld      hl,0x2000+1*8+256*8*2
3366+  784F CD 53 00            call    setwrt
3367+  7852 21 03 D1            ld      hl,dummy
3368+  7855 01 98 08            ld      bc,0x0898
3369+  7858 CD 82 7B            call slowotir
3370+  785B             
3371+  785B             ;;;;;;;;;;;
3372+  785B             
3373+  785B 7A                  ld      a,d
3374+  785C 87                  add     a,a     ;x2
3375+  785D C6 06               add     a,6     ; floor position
3376+  785F 6F                  ld      l,a
3377+  7860 26 00               ld      h,0
3378+  7862 29                  add     hl,hl
3379+  7863 29                  add     hl,hl
3380+  7864 29                  add     hl,hl       ;x8
3381+  7865 01 00 20            ld      bc,0x2000  ; vram address
3382+  7868 09                  add     hl,bc
3383+  7869 CD 50 00            call    setrd
3384+  786C 21 03 D1            ld      hl,dummy
3385+  786F 01 98 10            ld      bc,0x1098
3386+  7872 CD 88 7B            call    slowinir
3387+  7875             
3388+  7875 21 08 21            ld      hl,0x2000+33*8
3389+  7878 CD 53 00            call    setwrt
3390+  787B 21 03 D1            ld      hl,dummy
3391+  787E 01 98 08            ld      bc,0x0898
3392+  7881 CD 82 7B            call slowotir
3393+  7884 21 08 29            ld      hl,0x2000+33*8+256*8
3394+  7887 CD 53 00            call    setwrt
3395+  788A 21 03 D1            ld      hl,dummy
3396+  788D 01 98 08            ld      bc,0x0898
3397+  7890 CD 82 7B            call slowotir
3398+  7893 21 08 31            ld      hl,0x2000+33*8+256*8*2
3399+  7896 CD 53 00            call    setwrt
3400+  7899 21 03 D1            ld      hl,dummy
3401+  789C 01 98 08            ld      bc,0x0898
3402+  789F CD 82 7B            call slowotir
3403+  78A2             
3404+  78A2 21 00 21            ld      hl,0x2000+32*8
3405+  78A5 CD 53 00            call    setwrt
3406+  78A8 21 0B D1            ld      hl,dummy+8
3407+  78AB 01 98 08            ld      bc,0x0898
3408+  78AE CD 82 7B            call slowotir
3409+  78B1 21 00 29            ld      hl,0x2000+32*8+256*8
3410+  78B4 CD 53 00            call    setwrt
3411+  78B7 21 0B D1            ld      hl,dummy+8
3412+  78BA 01 98 08            ld      bc,0x0898
3413+  78BD CD 82 7B            call slowotir
3414+  78C0 21 00 31            ld      hl,0x2000+32*8+256*8*2
3415+  78C3 CD 53 00            call    setwrt
3416+  78C6 21 0B D1            ld      hl,dummy+8
3417+  78C9 01 98 08            ld      bc,0x0898
3418+  78CC CD 82 7B            call slowotir
3419+  78CF             
3420+  78CF 08                  ex  af,af
3421+  78D0 D9                  exx
3422+  78D1             
3423+  78D1 C9                  ret        
3424+  78D2                     
3425+  78D2             ;Input: HL = Dividend, C = Divisor, A = 0
3426+  78D2             ;Output: HL = Quotient, A = Remainder (see note)
3427+  78D2             div16:
3428+  78D2                 rept        16
3429+  78D2~            	add	hl,hl		; unroll 16 times
3430+  78D2~            	rla			; ...
3431+  78D2~            	cp	c		; ...
3432+  78D2~            	jr	c,$+4		; ...
3433+  78D2~            	sub	c		; ...
3434+  78D2~            	inc	l		; ...
3435+  78D2                 endm
3435+  78D2 29          >	add	hl,hl		; unroll 16 times
3435+  78D3 17          >	rla			; ...
3435+  78D4 B9          >	cp	c		; ...
3435+  78D5 38 02       >	jr	c,$+4		; ...
3435+  78D7 91          >	sub	c		; ...
3435+  78D8 2C          >	inc	l		; ...
3435+  78D9 29          >	add	hl,hl		; unroll 16 times
3435+  78DA 17          >	rla			; ...
3435+  78DB B9          >	cp	c		; ...
3435+  78DC 38 02       >	jr	c,$+4		; ...
3435+  78DE 91          >	sub	c		; ...
3435+  78DF 2C          >	inc	l		; ...
3435+  78E0 29          >	add	hl,hl		; unroll 16 times
3435+  78E1 17          >	rla			; ...
3435+  78E2 B9          >	cp	c		; ...
3435+  78E3 38 02       >	jr	c,$+4		; ...
3435+  78E5 91          >	sub	c		; ...
3435+  78E6 2C          >	inc	l		; ...
3435+  78E7 29          >	add	hl,hl		; unroll 16 times
3435+  78E8 17          >	rla			; ...
3435+  78E9 B9          >	cp	c		; ...
3435+  78EA 38 02       >	jr	c,$+4		; ...
3435+  78EC 91          >	sub	c		; ...
3435+  78ED 2C          >	inc	l		; ...
3435+  78EE 29          >	add	hl,hl		; unroll 16 times
3435+  78EF 17          >	rla			; ...
3435+  78F0 B9          >	cp	c		; ...
3435+  78F1 38 02       >	jr	c,$+4		; ...
3435+  78F3 91          >	sub	c		; ...
3435+  78F4 2C          >	inc	l		; ...
3435+  78F5 29          >	add	hl,hl		; unroll 16 times
3435+  78F6 17          >	rla			; ...
3435+  78F7 B9          >	cp	c		; ...
3435+  78F8 38 02       >	jr	c,$+4		; ...
3435+  78FA 91          >	sub	c		; ...
3435+  78FB 2C          >	inc	l		; ...
3435+  78FC 29          >	add	hl,hl		; unroll 16 times
3435+  78FD 17          >	rla			; ...
3435+  78FE B9          >	cp	c		; ...
3435+  78FF 38 02       >	jr	c,$+4		; ...
3435+  7901 91          >	sub	c		; ...
3435+  7902 2C          >	inc	l		; ...
3435+  7903 29          >	add	hl,hl		; unroll 16 times
3435+  7904 17          >	rla			; ...
3435+  7905 B9          >	cp	c		; ...
3435+  7906 38 02       >	jr	c,$+4		; ...
3435+  7908 91          >	sub	c		; ...
3435+  7909 2C          >	inc	l		; ...
3435+  790A 29          >	add	hl,hl		; unroll 16 times
3435+  790B 17          >	rla			; ...
3435+  790C B9          >	cp	c		; ...
3435+  790D 38 02       >	jr	c,$+4		; ...
3435+  790F 91          >	sub	c		; ...
3435+  7910 2C          >	inc	l		; ...
3435+  7911 29          >	add	hl,hl		; unroll 16 times
3435+  7912 17          >	rla			; ...
3435+  7913 B9          >	cp	c		; ...
3435+  7914 38 02       >	jr	c,$+4		; ...
3435+  7916 91          >	sub	c		; ...
3435+  7917 2C          >	inc	l		; ...
3435+  7918 29          >	add	hl,hl		; unroll 16 times
3435+  7919 17          >	rla			; ...
3435+  791A B9          >	cp	c		; ...
3435+  791B 38 02       >	jr	c,$+4		; ...
3435+  791D 91          >	sub	c		; ...
3435+  791E 2C          >	inc	l		; ...
3435+  791F 29          >	add	hl,hl		; unroll 16 times
3435+  7920 17          >	rla			; ...
3435+  7921 B9          >	cp	c		; ...
3435+  7922 38 02       >	jr	c,$+4		; ...
3435+  7924 91          >	sub	c		; ...
3435+  7925 2C          >	inc	l		; ...
3435+  7926 29          >	add	hl,hl		; unroll 16 times
3435+  7927 17          >	rla			; ...
3435+  7928 B9          >	cp	c		; ...
3435+  7929 38 02       >	jr	c,$+4		; ...
3435+  792B 91          >	sub	c		; ...
3435+  792C 2C          >	inc	l		; ...
3435+  792D 29          >	add	hl,hl		; unroll 16 times
3435+  792E 17          >	rla			; ...
3435+  792F B9          >	cp	c		; ...
3435+  7930 38 02       >	jr	c,$+4		; ...
3435+  7932 91          >	sub	c		; ...
3435+  7933 2C          >	inc	l		; ...
3435+  7934 29          >	add	hl,hl		; unroll 16 times
3435+  7935 17          >	rla			; ...
3435+  7936 B9          >	cp	c		; ...
3435+  7937 38 02       >	jr	c,$+4		; ...
3435+  7939 91          >	sub	c		; ...
3435+  793A 2C          >	inc	l		; ...
3435+  793B 29          >	add	hl,hl		; unroll 16 times
3435+  793C 17          >	rla			; ...
3435+  793D B9          >	cp	c		; ...
3435+  793E 38 02       >	jr	c,$+4		; ...
3435+  7940 91          >	sub	c		; ...
3435+  7941 2C          >	inc	l		; ...
3436+  7942 C9              ret
3437+  7943             
3438+  7943             ;Input: A = BCD number
3439+  7943             ;Output: A = binary value
3440+  7943                 
3441+  7943             Bcd2Hex:
3442+  7943 C5                  push    bc
3443+  7944 F5                  push    af
3444+  7945 0F                  rrca
3445+  7946 0F                  rrca
3446+  7947 0F                  rrca
3447+  7948 0F                  rrca
3448+  7949 E6 0F               and 15
3449+  794B             
3450+  794B 87                  add a,a 
3451+  794C 4F                  ld  c,a
3452+  794D 87                  add a,a
3453+  794E 87                  add a,a
3454+  794F 81                  add a,c     ; x10
3455+  7950                     
3456+  7950 4F                  ld  c,a
3457+  7951 F1                  pop af
3458+  7952 E6 0F               and 15
3459+  7954 81                  add a,c
3460+  7955 C1                  pop bc
3461+  7956 C9                  ret        
3462+  7957                 
3463+  7957             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3464+  7957             
3465+  7957             
3466+  7957                     endmodule
3467+  7957             
3468+  7957             
3469+  7957             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3470+  7957             
3471+  7957             ; pletter v0.5 msx unpacker
3472+  7957             
3473+  7957             ; call unpack with hl pointing to some pletter5 data, and de pointing to the destination.
3474+  7957             ; changes all registers
3475+  7957             
3476+  7957                 module pletter
3477+  7957               
3478+  7957                 MACRO MGBIT
3479+  7957~                add a,a
3480+  7957~                call z,getbit
3481+  7957                 ENDM
3482+  7957             
3483+  7957                 MACRO MGBITEXX
3484+  7957~                add a,a
3485+  7957~                call z,getbitexx
3486+  7957                 ENDM
3487+  7957                 
3488+  7957             _unpack:
3489+  7957 7E              ld a,(hl)
3490+  7958 23              inc hl
3491+  7959 D9              exx
3492+  795A 11 00 00        ld de,0
3493+  795D 87              add a,a
3494+  795E 3C              inc a
3495+  795F CB 13           rl e
3496+  7961 87              add a,a
3497+  7962 CB 13           rl e
3498+  7964 87              add a,a
3499+  7965 CB 13           rl e
3500+  7967 CB 13           rl e
3501+  7969 21 FB 79        ld hl,_modes
3502+  796C 19              add hl,de
3503+  796D 5E              ld e,(hl)
3504+  796E DD 6B           db 0xdd,0x6b ; ld ixl,e
3505+  7970 23              inc hl
3506+  7971 5E              ld e,(hl)
3507+  7972 DD 63           db 0xdd,0x63 ; ld ixh,e
3508+  7974 1E 01           ld e,1
3509+  7976 D9              exx
3510+  7977 FD 21 7D 79     ld iy,loop
3511+  797B             literal:
3512+  797B ED A0           ldi
3513+  797D             loop:
3514+  797D                 MGBIT
3514+  797D 87          >    add a,a
3514+  797E CC F1 79    >    call z,getbit
3515+  7981 30 F8           jr nc,literal
3516+  7983 D9              exx
3517+  7984 62              ld h,d
3518+  7985 6B              ld l,e
3519+  7986             getlen:
3520+  7986                 MGBITEXX
3520+  7986 87          >    add a,a
3520+  7987 CC F5 79    >    call z,getbitexx
3521+  798A 30 1B           jr nc,_lenok
3522+  798C             _lus:
3523+  798C                 MGBITEXX
3523+  798C 87          >    add a,a
3523+  798D CC F5 79    >    call z,getbitexx
3524+  7990 ED 6A           adc hl,hl
3525+  7992 D8              ret c
3526+  7993                 MGBITEXX
3526+  7993 87          >    add a,a
3526+  7994 CC F5 79    >    call z,getbitexx
3527+  7997 30 0E           jr nc,_lenok
3528+  7999                 MGBITEXX
3528+  7999 87          >    add a,a
3528+  799A CC F5 79    >    call z,getbitexx
3529+  799D ED 6A           adc hl,hl
3530+  799F D8              ret c
3531+  79A0                 MGBITEXX
3531+  79A0 87          >    add a,a
3531+  79A1 CC F5 79    >    call z,getbitexx
3532+  79A4 DA 8C 79        jp c,_lus
3533+  79A7             _lenok:
3534+  79A7 23              inc hl
3535+  79A8 D9              exx
3536+  79A9 4E              ld c,(hl)
3537+  79AA 23              inc hl
3538+  79AB 06 00           ld b,0
3539+  79AD CB 79           bit 7,c
3540+  79AF CA E2 79        jp z,_offsok
3541+  79B2 DD E9           jp (ix)
3542+  79B4                 
3543+  79B4             mode7:
3544+  79B4                 MGBIT
3544+  79B4 87          >    add a,a
3544+  79B5 CC F1 79    >    call z,getbit
3545+  79B8 CB 10           rl b
3546+  79BA             mode6:
3547+  79BA                 MGBIT
3547+  79BA 87          >    add a,a
3547+  79BB CC F1 79    >    call z,getbit
3548+  79BE CB 10           rl b
3549+  79C0             mode5:
3550+  79C0                 MGBIT
3550+  79C0 87          >    add a,a
3550+  79C1 CC F1 79    >    call z,getbit
3551+  79C4 CB 10           rl b
3552+  79C6             mode4:
3553+  79C6                 MGBIT
3553+  79C6 87          >    add a,a
3553+  79C7 CC F1 79    >    call z,getbit
3554+  79CA CB 10           rl b
3555+  79CC             mode3:
3556+  79CC                 MGBIT
3556+  79CC 87          >    add a,a
3556+  79CD CC F1 79    >    call z,getbit
3557+  79D0 CB 10           rl b
3558+  79D2             mode2:
3559+  79D2                 MGBIT
3559+  79D2 87          >    add a,a
3559+  79D3 CC F1 79    >    call z,getbit
3560+  79D6 CB 10           rl b
3561+  79D8                 MGBIT
3561+  79D8 87          >    add a,a
3561+  79D9 CC F1 79    >    call z,getbit
3562+  79DC 30 04           jr nc,_offsok
3563+  79DE B7              or a
3564+  79DF 04              inc b
3565+  79E0 CB B9           res 7,c
3566+  79E2             _offsok:
3567+  79E2 03              inc bc
3568+  79E3 E5              push hl
3569+  79E4 D9              exx
3570+  79E5 E5              push hl
3571+  79E6 D9              exx
3572+  79E7 6B              ld l,e
3573+  79E8 62              ld h,d
3574+  79E9 ED 42           sbc hl,bc
3575+  79EB C1              pop bc
3576+  79EC ED B0           ldir
3577+  79EE E1              pop hl
3578+  79EF FD E9           jp (iy)
3579+  79F1                 
3580+  79F1             getbit:
3581+  79F1 7E              ld a,(hl)
3582+  79F2 23              inc hl
3583+  79F3 17              rla
3584+  79F4 C9              ret
3585+  79F5                 
3586+  79F5             getbitexx:
3587+  79F5 D9              exx
3588+  79F6 7E              ld a,(hl)
3589+  79F7 23              inc hl
3590+  79F8 D9              exx
3591+  79F9 17              rla
3592+  79FA C9              ret
3593+  79FB                 
3594+  79FB             _modes:
3595+  79FB E2 79         dw _offsok
3596+  79FD D2 79         dw mode2
3597+  79FF CC 79         dw mode3
3598+  7A01 C6 79         dw mode4
3599+  7A03 C0 79         dw mode5
3600+  7A05 BA 79         dw mode6
3601+  7A07 B4 79         dw mode7
3602+  7A09             
3603+  7A09                 endmodule
3604+  7A09             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3605+  7A09                     module MAIN
3606+  7A09                     
3607+  7A09             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3608+  7A09             ;
3609+  7A09             ; to be called at game start
3610+  7A09             ;
3611+  7A09             
3612+  7A09             initchest:
3613+  7A09 DD 46 22             ld   b,(ix+_lastlevel)
3614+  7A0C 21 90 E2             ld   hl,memchst
3615+  7A0F 3E FF                ld   a,0xFF
3616+  7A11 77          1:       ld   (hl),a
3617+  7A12 23                   inc  hl
3618+  7A13 10 FC                djnz 1b        ; all chests in all levels are closed and full
3619+  7A15             
3620+  7A15 DD 66 22             ld    h,(ix+_lastlevel)
3621+  7A18 DD 5E 30             ld    e,(ix+_chests)
3622+  7A1B CD 08 58             call  mul8
3623+  7A1E 29                   add   hl,hl
3624+  7A1F 44 4D                ld    bc,hl         ; 2*LASTLEVEL*CHESTS
3625+  7A21 21 B8 E2             ld     hl,locchst
3626+  7A24             
3627+  7A24             
3628+  7A24 36 00       1:       ld     (hl),0
3629+  7A26 23                   inc    hl
3630+  7A27 0B                   dec    bc
3631+  7A28 78                   ld     a,b
3632+  7A29 B1                   or     c
3633+  7A2A 20 F8                jr     nz,1b   ; positions of all chests reset to 0
3634+  7A2C                      
3635+  7A2C C9                   ret
3636+  7A2D             
3637+  7A2D             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3638+  7A2D             ;
3639+  7A2D             ; points to the list of chest positions for current LEVEL
3640+  7A2D             ; output:
3641+  7A2D             ;  hl points to the first chest in locchst
3642+  7A2D             
3643+  7A2D             chestlist:
3644+  7A2D DD 5E 13            ld      e,(ix+LEVEL)
3645+  7A30 1D                  dec     e
3646+  7A31 DD 66 30            ld      h,(ix+_chests)
3647+  7A34 CB 24               sla     h               ; 2*CHESTS
3648+  7A36 CD 08 58            call    MAIN.mul8
3649+  7A39 11 B8 E2            ld      de,locchst
3650+  7A3C 19                  add     hl,de           ; points to the list of chest positions for current LEVEL
3651+  7A3D C9                  ret
3652+  7A3E             
3653+  7A3E             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3654+  7A3E             ;
3655+  7A3E             ; input
3656+  7A3E             ; b = number of chest in the current LEVEL
3657+  7A3E             ; de position of the chest to be stored in table locchst
3658+  7A3E             ;
3659+  7A3E             
3660+  7A3E             storechestinfo:
3661+  7A3E D5                  push    de
3662+  7A3F CD 2D 7A            call    chestlist        ; LEVEL == 1 -> prima riga, LEVEL == 2 -> seconda riga, ect
3663+  7A42 58                  ld      e,b
3664+  7A43 16 00               ld      d,0
3665+  7A45 1B                  dec     de              ; b=1 prima posizione, b=2 seconda posizione, etc
3666+  7A46 19                  add     hl,de
3667+  7A47 19                  add     hl,de           ; points to the position of the chest #b
3668+  7A48 D1                  pop     de
3669+  7A49 73 23 72 2B         ld      (hl),de         ; store the chest position
3670+  7A4D C9                  ret
3671+  7A4E             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3672+  7A4E             ;
3673+  7A4E             ; no input
3674+  7A4E             ; remove opened chests in the current level
3675+  7A4E             ;
3676+  7A4E             
3677+  7A4E             removeopenchests:
3678+  7A4E             
3679+  7A4E DD 46 30            ld      b,(ix+_chests)
3680+  7A51             1:
3681+  7A51 CD 68 7A            call    testchst
3682+  7A54 20 0F               jr      nz,chestfull
3683+  7A56             
3684+  7A56 CD 2D 7A            call    chestlist        ; LEVEL == 1 -> prima riga, LEVEL == 2 -> seconda riga, ect
3685+  7A59 58                  ld      e,b
3686+  7A5A 16 00               ld      d,0
3687+  7A5C 1B                  dec     de              ; b=1 prima posizione, b=2 seconda posizione, etc
3688+  7A5D 19                  add     hl,de
3689+  7A5E 19                  add     hl,de           ; points to the position of the chest #b
3690+  7A5F                     
3691+  7A5F 7E                  ld      a,(hl)
3692+  7A60 23                  inc     hl
3693+  7A61 66                  ld      h,(hl)
3694+  7A62 6F                  ld      l,a
3695+  7A63             
3696+  7A63 36 20               ld      (hl),floorchr
3697+  7A65             
3698+  7A65             chestfull:
3699+  7A65 10 EA               djnz    1b
3700+  7A67 C9                  ret
3701+  7A68             
3702+  7A68             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3703+  7A68             ; input
3704+  7A68             ; b = number of chest in the current LEVEL
3705+  7A68             ; output
3706+  7A68             ; NZ if the chest is full, Z if the chest has been already opened
3707+  7A68             ; hl points to the byte dedicated to the current level
3708+  7A68             ; a is the masked value
3709+  7A68             
3710+  7A68             testchst:
3711+  7A68 3E 01                ld     a,0x01          ; genera una maschera di 0 con uno 1 nella posizione data da b
3712+  7A6A C5                   push   bc
3713+  7A6B             
3714+  7A6B 05                   dec    b
3715+  7A6C 18 01                jr     2f
3716+  7A6E 07          1:       rlca
3717+  7A6F 10 FD       2:       djnz   1b            ; b=1 -> a=1, b=2 -> a=2, b=3 -> a=4, b=4 -> a=8, etc
3718+  7A71             
3719+  7A71 C1                   pop    bc
3720+  7A72             
3721+  7A72 DD 5E 13             ld     e,(ix+LEVEL)
3722+  7A75 1D                   dec    e
3723+  7A76 16 00                ld     d,0
3724+  7A78 21 90 E2             ld     hl,memchst
3725+  7A7B 19                   add    hl,de         ; LEVEL == 1 prima posizione, LEVEL == 2 seconda posizione,etc
3726+  7A7C A6                   and    (hl)
3727+  7A7D             
3728+  7A7D C9                   ret        ; return NZ if the chest is full, Z if it is already opened
3729+  7A7E             
3730+  7A7E             
3731+  7A7E             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3732+  7A7E             ; input
3733+  7A7E             ;   hl   = X,Y chest position in level LEVEL
3734+  7A7E             ; output
3735+  7A7E             ;   reset the chest flag in memchst table
3736+  7A7E             
3737+  7A7E             openchest:
3738+  7A7E CD E2 57            call       locate       ; convert x,y to position
3739+  7A81 D5                  push       de
3740+  7A82             
3741+  7A82 CD 2D 7A            call       chestlist    ; LEVEL == 1 -> prima riga, LEVEL == 2 -> seconda riga, ect
3742+  7A85             
3743+  7A85 E5 FD E1            ld         iy,hl
3744+  7A88 D1                  pop        de
3745+  7A89                                             ; search for the chest position in the list
3746+  7A89             
3747+  7A89 DD 46 30            ld         b,(ix+_chests)
3748+  7A8C             1:      ld         hl,(iy+0)
3748+  7A8C FD6E00FD6601
3749+  7A92 CD 20 00            call       0x20         ; compare HL and DE
3750+  7A95 28 07               jr         z,found      ; return in B the number of iteration, now if B = CHESTS, the chest is in the first position
3751+  7A97 FD 23               inc        iy
3752+  7A99 FD 23               inc        iy
3753+  7A9B 10 EF               djnz       1b
3754+  7A9D             notfound:
3755+  7A9D C9                  ret
3756+  7A9E             
3757+  7A9E DD 7E 30    found:  ld          a,(ix+_chests)
3758+  7AA1 3C                  inc         a
3759+  7AA2 90                  sub         b            ; now, if B = CHESTS => a = 1
3760+  7AA3 47                  ld          b,a
3761+  7AA4             
3762+  7AA4 CD 68 7A            call       testchst     ; if the chest is closed, a is the mask             
3763+  7AA7 2F                  cpl                     ; negate the mask
3764+  7AA8 A6                  and        (hl)         
3765+  7AA9 77                  ld         (hl),a       ; open the current chest
3766+  7AAA C9                  ret        
3767+  7AAB             
3768+  7AAB             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3769+  7AAB             ; input
3770+  7AAB             ;   none
3771+  7AAB             ; output
3772+  7AAB             ;   a and l
3773+  7AAB             ; Bit    	Description
3774+  7AAB             ;0        Input joystick pin 1      (up)
3775+  7AAB             ;1        Input joystick pin 2      (down)
3776+  7AAB             ;2        Input joystick pin 3      (left)
3777+  7AAB             ;3        Input joystick pin 4      (right)
3778+  7AAB             ;4        Input joystick pin 6      (trigger A)
3779+  7AAB             ;5        Input joystick pin 7      (trigger B)
3780+  7AAB             
3781+  7AAB                     include "joy.asm"
0001++ 7AAB             
0002++ 7AAB             ; Bit    	Description
0003++ 7AAB             ;0        Input joystick pin 1      (up)
0004++ 7AAB             ;1        Input joystick pin 2      (down)
0005++ 7AAB             ;2        Input joystick pin 3      (left)
0006++ 7AAB             ;3        Input joystick pin 4      (right)
0007++ 7AAB             ;4        Input joystick pin 6      (trigger A)
0008++ 7AAB             ;5        Input joystick pin 7      (trigger B)
0009++ 7AAB             
0010++ 7AAB             _joy:
0011++ 7AAB F3                  di
0012++ 7AAC 3E 0F               ld      a,15
0013++ 7AAE D3 A0               out     (0xa0),a    ; read/write from r#15
0014++ 7AB0             
0015++ 7AB0 DB A2               in      a,(0xa2)
0016++ 7AB2 E6 BF               and     255-64
0017++ 7AB4 D3 A1               out     (0xa1),a    ; set joystick in port 1
0018++ 7AB6             
0019++ 7AB6 3E 0E               ld      a,14
0020++ 7AB8 D3 A0               out     (0xa0),a    ; read/write from r#14
0021++ 7ABA             
0022++ 7ABA DB A2               in      a,(0xa2)
0023++ 7ABC 6F                  ld      l,a
0024++ 7ABD FB                  ei
0025++ 7ABE C9                  ret
0026++ 7ABF             
3782+  7ABF             
3783+  7ABF             		; --- INCLUDE new FoV code ---
3784+  7ABF             
3785+  7ABF                     include "fastfov.asm"
0001++ 7ABF             
0002++ 7ABF             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0003++ 7ABF             ; Input :
0004++ 7ABF             ; DE = pointer in hidden to (x-coordinate,y-coordinate)
0005++ 7ABF             
0006++ 7ABF             ;- draw one line-of-sight
0007++ 7ABF             
0008++ 7ABF             _drawline:
0009++ 7ABF                     
0010++ 7ABF EB          1:      ex      de,hl   
0011++ 7AC0 09                  add     hl,bc
0012++ 7AC1 7E                  ld      a,(hl)
0013++ 7AC2 EB                  ex      de,hl
0014++ 7AC3                     
0015++ 7AC3 21 00 04            ld      hl,-hidden+visible
0016++ 7AC6 19                  add     hl,de
0017++ 7AC7 77                  ld      (hl),a
0018++ 7AC8                              
0019++ 7AC8 FE 03               cp      wallchr                     ; view blocking characters
0020++ 7ACA C8                  ret     z
0021++ 7ACB FE 24               cp      doorchr        
0022++ 7ACD C8                  ret     z
0023++ 7ACE C3 BF 7A            jp      1b        
0024++ 7AD1             
0025++ 7AD1             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0026++ 7AD1             ;Input:
0027++ 7AD1             ; None
0028++ 7AD1             ;Output:
0029++ 7AD1             ; compute the FoV visible area
0030++ 7AD1             
0031++ 7AD1             fastmanview:
0032++ 7AD1             
0033++ 7AD1 CD DC 57            call    locateman        
0034++ 7AD4 ED 53 03 C1         ld      (buffer),de
0035++ 7AD8 E5 D5 C5            push    hl,de,bc
0036++ 7ADB CD E2 7A            call    viewsegments
0037++ 7ADE C1 D1 E1            pop     hl,de,bc
0038++ 7AE1 C9                  ret
0039++ 7AE2             
0040++ 7AE2             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0041++ 7AE2             ;Input:
0042++ 7AE2             ; buffer points to the buffer of the FoV
0043++ 7AE2             ;Output:
0044++ 7AE2             ; compute the FoV in 8 octants (split in 4 quadrants)
0045++ 7AE2             
0046++ 7AE2             viewsegments:
0047++ 7AE2             
0048++ 7AE2 01 E9 FF            ld      bc,-MAPW+1      ; segment 1
0049++ 7AE5 ED 5B 03 C1         ld      de,(buffer)
0050++ 7AE9 CD 26 7B            call    segxloopinc
0051++ 7AEC                     
0052++ 7AEC ED 5B 03 C1         ld      de,(buffer)
0053++ 7AF0 CD 69 7B            call    segyloopdec
0054++ 7AF3             
0055++ 7AF3 01 19 00            ld      bc,MAPW+1       ; segment 2
0056++ 7AF6 ED 5B 03 C1         ld      de,(buffer)
0057++ 7AFA CD 26 7B            call    segxloopinc
0058++ 7AFD                     
0059++ 7AFD ED 5B 03 C1         ld      de,(buffer)
0060++ 7B01 CD 50 7B            call    segyloopinc
0061++ 7B04                     
0062++ 7B04 01 17 00            ld      bc,MAPW-1       ; segment 3
0063++ 7B07 ED 5B 03 C1         ld      de,(buffer)
0064++ 7B0B CD 3B 7B            call    segxloopdec
0065++ 7B0E                     
0066++ 7B0E ED 5B 03 C1         ld      de,(buffer)
0067++ 7B12 CD 50 7B            call    segyloopinc
0068++ 7B15             
0069++ 7B15 01 E7 FF            ld      bc,-MAPW-1      ; segment 4
0070++ 7B18 ED 5B 03 C1         ld      de,(buffer)
0071++ 7B1C CD 3B 7B            call    segxloopdec
0072++ 7B1F                     
0073++ 7B1F ED 5B 03 C1         ld      de,(buffer)
0074++ 7B23 C3 69 7B            jp      segyloopdec
0075++ 7B26                     
0076++ 7B26             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0077++ 7B26                     
0078++ 7B26             segxloopinc:
0079++ 7B26             1:
0080++ 7B26 1A                  ld      a,(de)
0081++ 7B27 21 00 04            ld      hl,-hidden+visible
0082++ 7B2A 19                  add     hl,de
0083++ 7B2B 77                  ld      (hl),a
0084++ 7B2C                     
0085++ 7B2C FE 03               cp      wallchr                     ; view blocking characters
0086++ 7B2E C8                  ret     z
0087++ 7B2F FE 24               cp      doorchr        
0088++ 7B31 C8                  ret     z
0089++ 7B32             
0090++ 7B32 D5                  push    de
0091++ 7B33 CD BF 7A            call    _drawline
0092++ 7B36 D1                  pop     de
0093++ 7B37             
0094++ 7B37 13                  inc     de
0095++ 7B38 C3 26 7B            jp     1b
0096++ 7B3B                     
0097++ 7B3B             segxloopdec:
0098++ 7B3B             1:
0099++ 7B3B 1A                  ld      a,(de)
0100++ 7B3C 21 00 04            ld      hl,-hidden+visible
0101++ 7B3F 19                  add     hl,de
0102++ 7B40 77                  ld      (hl),a
0103++ 7B41                     
0104++ 7B41 FE 03               cp      wallchr                     ; view blocking characters
0105++ 7B43 C8                  ret     z
0106++ 7B44 FE 24               cp      doorchr        
0107++ 7B46 C8                  ret     z
0108++ 7B47             
0109++ 7B47 D5                  push    de
0110++ 7B48 CD BF 7A            call    _drawline
0111++ 7B4B D1                  pop     de
0112++ 7B4C             
0113++ 7B4C 1B                  dec     de
0114++ 7B4D C3 3B 7B            jp     1b
0115++ 7B50             
0116++ 7B50             segyloopinc:
0117++ 7B50             1:
0118++ 7B50 21 18 00            ld      hl,MAPW
0119++ 7B53 19                  add     hl,de
0120++ 7B54 7E                  ld      a,(hl)
0121++ 7B55 EB                  ex      de,hl
0122++ 7B56                     
0123++ 7B56 21 00 04            ld      hl,-hidden+visible
0124++ 7B59 19                  add     hl,de
0125++ 7B5A 77                  ld      (hl),a
0126++ 7B5B             
0127++ 7B5B FE 03               cp      wallchr                     ; view blocking characters
0128++ 7B5D C8                  ret     z
0129++ 7B5E FE 24               cp      doorchr        
0130++ 7B60 C8                  ret     z
0131++ 7B61             
0132++ 7B61 D5                  push    de
0133++ 7B62 CD BF 7A            call    _drawline
0134++ 7B65 D1                  pop     de
0135++ 7B66 C3 50 7B            jp     1b
0136++ 7B69             
0137++ 7B69             segyloopdec:
0138++ 7B69             1:
0139++ 7B69 21 E8 FF            ld      hl,-MAPW
0140++ 7B6C 19                  add     hl,de
0141++ 7B6D 7E                  ld      a,(hl)
0142++ 7B6E EB                  ex      de,hl
0143++ 7B6F                     
0144++ 7B6F 21 00 04            ld      hl,-hidden+visible
0145++ 7B72 19                  add     hl,de
0146++ 7B73 77                  ld      (hl),a
0147++ 7B74             
0148++ 7B74 FE 03               cp      wallchr                     ; view blocking characters
0149++ 7B76 C8                  ret     z
0150++ 7B77 FE 24               cp      doorchr        
0151++ 7B79 C8                  ret     z
0152++ 7B7A             
0153++ 7B7A D5                  push    de
0154++ 7B7B CD BF 7A            call    _drawline
0155++ 7B7E D1                  pop     de
0156++ 7B7F C3 69 7B            jp     1b
0157++ 7B82             
0158++ 7B82             
3786+  7B82             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3787+  7B82             ; slow Vram patch
3788+  7B82             ;
3789+  7B82             slowotir:
3790+  7B82 ED A3       1:      outi
3791+  7B84 00                  nop
3792+  7B85 20 FB               jr  nz,1b
3793+  7B87 C9                  ret
3794+  7B88             slowinir:
3795+  7B88 ED A2       1:      ini
3796+  7B8A 00                  nop
3797+  7B8B 20 FB               jr  nz,1b
3798+  7B8D C9                  ret
3799+  7B8E             
3800+  7B8E                 
3801+  7B8E               endmodule
3802+  7B8E             
3803+  7B8E             
3804+  7B8E             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
3805+  7B8E             
3806+  7B8E             ; sprites
3807+  7B8E             ;-------------------------------------
3808+  7B8E             
3809+  7B8E             titlesprites:
3810+  7B8E             ;            include titlespgt.asm
3811+  7B8E                         include newspgt.asm
0001++ 7B8E                 ; newspgt - BIN2ASC converted File
0002++ 7B8E 3B 00 C0 00     db 59,0,192,0
0003++ 7B92 01 03 0F 0D     db 1,3,15,13
0004++ 7B96 07 40 03 00     db 7,64,3,0
0005++ 7B9A 07 07 0F 0F     db 7,7,15,15
0006++ 7B9E 1F 19 3F 7F     db 31,25,63,127
0007++ 7BA2 FF 00 0F 14     db 255,0,15,20
0008++ 7BA6 03 1F 00 70     db 3,31,0,112
0009++ 7BAA 00 C0 E0 3D     db 0,192,224,61
0010++ 7BAE F0 FC E0 1F     db 240,252,224,31
0011++ 7BB2 FC F1 E3 C3     db 252,241,227,195
0012++ 7BB6 00 C6 9C E4     db 0,198,156,228
0013++ 7BBA B5 DE C3 E3     db 181,222,195,227
0014++ 7BBE F1 60 FD 0F     db 241,96,253,15
0015++ 7BC2 9F C7 63 00     db 159,199,99,0
0016++ 7BC6 C1 21 5C D2     db 193,33,92,210
0017++ 7BCA B8 6D E1 23     db 184,109,225,35
0018++ 7BCE 37 67 5F 00     db 55,103,95,0
0019++ 7BD2 27 21 E0 D0     db 39,33,224,208
0020++ 7BD6 9C 9F 9B 08     db 156,159,155,8
0021++ 7BDA 0D 0E 70 30     db 13,14,112,48
0022++ 7BDE 52 40 1C 3F     db 82,64,28,63
0023++ 7BE2 E4 1C 80 47     db 228,28,128,71
0024++ 7BE6 98 80 60 00     db 152,128,96,0
0025++ 7BEA 40 E1 00 E1     db 64,225,0,225
0026++ 7BEE 33 43 E2 C2     db 51,67,226,194
0027++ 7BF2 03 11 2F 37     db 3,17,47,55
0028++ 7BF6 1C 38 01 1A     db 28,56,1,26
0029++ 7BFA E8 F4 A8 50     db 232,244,168,80
0030++ 7BFE A0 80 07 A0     db 160,128,7,160
0031++ 7C02 E0 A0 40 80     db 224,160,64,128
0032++ 7C06 FE 37 0E 40     db 254,55,14,64
0033++ 7C0A 00 80 80 05     db 0,128,128,5
0034++ 7C0E 71 C0 1B E0     db 113,192,27,224
0035++ 7C12 C0 AA 42 1F     db 192,170,66,31
0036++ 7C16 00 20 40 20     db 0,32,64,32
0037++ 7C1A 23 F3 2B 5C     db 35,243,43,92
0038++ 7C1E 00 01 0B 11     db 0,1,11,17
0039++ 7C22 01 05 03 05     db 1,5,3,5
0040++ 7C26 02 A0 0B 02     db 2,160,11,2
0041++ 7C2A 05 0B FE 1E     db 5,11,254,30
0042++ 7C2E C4 AC 03 01     db 196,172,3,1
0043++ 7C32 57 0A 1F 01     db 87,10,31,1
0044++ 7C36 79 09 27 BC     db 121,9,39,188
0045++ 7C3A D2 87 00 05     db 210,135,0,5
0046++ 7C3E 22 15 86 0B     db 34,21,134,11
0047++ 7C42 05 2A AC 5E     db 5,42,172,94
0048++ 7C46 F8 44 F0 94     db 248,68,240,148
0049++ 7C4A 00 80 EC 00     db 0,128,236,0
0050++ 7C4E 07 9D CC 52     db 7,157,204,82
0051++ 7C52 1F DD 7F 62     db 31,221,127,98
0052++ 7C56 00 3F 1F AB     db 0,63,31,171
0053++ 7C5A 8F 00 07 50     db 143,0,7,80
0054++ 7C5E 1E EB 00 6A     db 30,235,0,106
0055++ 7C62 BE 8F 13 E6     db 190,143,19,230
0056++ 7C66 41 0D 7D 5F     db 65,13,125,95
0057++ 7C6A 9F 93 88 1E     db 159,147,136,30
0058++ 7C6E DC 62 60 EA     db 220,98,96,234
0059++ 7C72 03 3E 00 3B     db 3,62,0,59
0060++ 7C76 87 04 5D 2A     db 135,4,93,42
0061++ 7C7A 15 F0 1B AA     db 21,240,27,170
0062++ 7C7E 15 82 00 10     db 21,130,0,16
0063++ 7C82 88 04 AA 00     db 136,4,170,0
0064++ 7C86 A8 00 22 07     db 168,0,34,7
0065++ 7C8A 90 81 90 C0     db 144,129,144,192
0066++ 7C8E 90 F0 1F 50     db 144,240,31,80
0067++ 7C92 80 D0 00 C8     db 128,208,0,200
0068++ 7C96 E0 48 AE 51     db 224,72,174,81
0069++ 7C9A 00 04 20 06     db 0,4,32,6
0070++ 7C9E 47 00 41 62     db 71,0,65,98
0071++ 7CA2 54 B8 5E 1C     db 84,184,94,28
0072++ 7CA6 7B EA 81 7B     db 123,234,129,123
0073++ 7CAA A8 58 B0 60     db 168,88,176,96
0074++ 7CAE 5E BA B0 1F     db 94,186,176,31
0075++ 7CB2 8A 00 62 50     db 138,0,98,80
0076++ 7CB6 04 95 4B 0B     db 4,149,75,11
0077++ 7CBA 0A 07 16 14     db 10,7,22,20
0078++ 7CBE 10 24 20 F8     db 16,36,32,248
0079++ 7CC2 AB D3 8C F0     db 171,211,140,240
0080++ 7CC6 D1 0D E0 B9     db 209,13,224,185
0081++ 7CCA 0D A1 0B 40     db 13,161,11,64
0082++ 7CCE 31 B2 0C 3C     db 49,178,12,60
0083++ 7CD2 02 63 30 06     db 2,99,48,6
0084++ 7CD6 18 CD 98 78     db 24,205,152,120
0085++ 7CDA A2 05 06 E1     db 162,5,6,225
0086++ 7CDE 8D C3 03 40     db 141,195,3,64
0087++ 7CE2 0D 31 21 60     db 13,49,33,96
0088++ 7CE6 30 1F 30 38     db 48,31,48,56
0089++ 7CEA 18 2A 3E 7C     db 24,42,62,124
0090++ 7CEE 02 C5 1D C3     db 2,197,29,195
0091++ 7CF2 E2 7C 0B 97     db 226,124,11,151
0092++ 7CF6 CB 6C CB 20     db 203,108,203,32
0093++ 7CFA 00 32 10 08     db 0,50,16,8
0094++ 7CFE 0F 03 F7 0F     db 15,3,247,15
0095++ 7D02 00 08 1C D3     db 0,8,28,211
0096++ 7D06 1E FF FF FF     db 30,255,255,255
0097++ 7D0A FF              db 255
3812+  7D0B             
3813+  7D0B             ; in game tileset
3814+  7D0B             ddcolors:
3815+  7D0B                 incbin "tiles\ddcol.bin.miz"
3816+  7FBF             ddpatterns:
3817+  7FBF                 incbin "tiles\ddpat.bin.miz"
3818+  8497             
3819+  8497             ; title
3820+  8497             ddpat1:
3821+  8497                 ; incbin "tiles\ddapat1.bin.miz"
3822+  8497             ddpat2:
3823+  8497                 ; incbin "tiles\ddapat2.bin.miz"
3824+  8497             ddpatl2:
3825+  8497             	incbin "tiles\ddapat12.bin.miz"
3826+  8C3D             
3827+  8C3D             ddcol1:
3828+  8C3D                 ; incbin "tiles\ddacol1.bin.miz"
3829+  8C3D             ddcol2:
3830+  8C3D                 ; incbin "tiles\ddacol2.bin.miz"
3831+  8C3D             	
3832+  8C3D             ddcol12:
3833+  8C3D             	incbin "tiles\ddacol12.bin.miz"
3834+  900F             
3835+  900F             	; amulet
3836+  900F             ddamcol:
3837+  900F                 incbin "tiles\ddamcol.bin.miz"
3838+  9254             ddampat:
3839+  9254                 incbin "tiles\ddampat.bin.miz"
3840+  9634             
3841+  9634             ; ending
3842+  9634             ; endpat1:
3843+  9634             ;    incbin "tiles\dde1pat.bin.miz"
3844+  9634             ; endpat2:
3845+  9634             ;    incbin "tiles\dde2pat.bin.miz"
3846+  9634             ; endpat3:
3847+  9634             ;    incbin "tiles\dde3pat.bin.miz"
3848+  9634             endpat123:
3849+  9634                 incbin "tiles\endpat.pgt.bin.miz"
3850+  9C83             
3851+  9C83             ; endcol1:
3852+  9C83             ;    incbin "tiles\dde1col.bin.miz"
3853+  9C83             ; endcol2:
3854+  9C83             ;    incbin "tiles\dde2col.bin.miz"
3855+  9C83             ; endcol3:
3856+  9C83             ;    incbin "tiles\dde3col.bin.miz"
3857+  9C83             endcol123:
3858+  9C83                 incbin "tiles\endcol.ct.bin.miz"
3859+  9FFD             
3860+  9FFD             
3861+  9FFD                     module miz
3862+  9FFD             ; -------------------------------------------------------
3863+  9FFD             ; MSX-O-Mizer v1.5f datas depacker    *ROM based version*
3864+  9FFD             ; Improved from Metalbrain's z80 version.
3865+  9FFD             ; -------------------------------------------------------
3866+  9FFD             ; source in hl
3867+  9FFD             ; dest in de
3868+  9FFD             
3869+  9FFD             ; 328 bytes which must be aligned on 8 bits boundary
3870+  9FFD             mom_map_bits_rom    =       0xF100
3871+  9FFD             ; 26 bytes located in ram
3872+  9FFD             mom_offset_table    =       0xF100 + 328
3873+  9FFD             
3874+  9FFD             _unpack:
3875+  9FFD             
3876+  9FFD D5          mom_depack_rom:     push    de
3877+  9FFE 01 48 F2                        ld      bc, mom_offset_table
3878+  A001 C5                              push    bc
3879+  A002 50 59                           ld      de, bc
3880+  A004 01 1A 00                        ld      bc, 26
3881+  A007 ED B0                           ldir
3882+  A009 E5                              push    hl
3883+  A00A F1                              pop     af
3884+  A00B E1                              pop     hl
3885+  A00C F5                              push    af
3886+  A00D FD 21 F0 F1                     ld      iy, mom_map_bits_rom + 0xf0
3887+  A011 06 34                           ld      b, 52
3888+  A013 FD 7D       mom_init_bits_rom:  ld      a, iyl
3889+  A015 E6 0F                           and     15
3890+  A017 20 03                           jr      nz, mom_node_rom
3891+  A019 11 01 00                        ld      de, 1
3892+  A01C ED 67       mom_node_rom:       rrd
3893+  A01E FD 77 00                        ld      (iy), a
3894+  A021 FD 73 24                        ld      (iy + 36), e
3895+  A024 FD 72 48                        ld      (iy + 72), d
3896+  A027 FD 2C                           inc     iyl
3897+  A029 3C                              inc     a
3898+  A02A E5                              push    hl
3899+  A02B 21 00 00                        ld      hl, 0
3900+  A02E 37                              scf
3901+  A02F ED 6A       mom_set_bit_rom:    adc     hl, hl
3902+  A031 3D                              dec     a
3903+  A032 20 FB                           jr      nz, mom_set_bit_rom
3904+  A034 19                              add     hl, de
3905+  A035 EB                              ex      de, hl
3906+  A036 E1                              pop     hl
3907+  A037 CB 40                           bit     0, b
3908+  A039 28 01                           jr      z, mom_wait_step_rom
3909+  A03B 23                              inc     hl
3910+  A03C 10 D5       mom_wait_step_rom:  djnz    mom_init_bits_rom
3911+  A03E E1                              pop     hl
3912+  A03F 7E                              ld      a, (hl)
3913+  A040 23                              inc     hl
3914+  A041 DD 67                           ld      ixh, a
3915+  A043 D1                              pop     de
3916+  A044 ED A0       mom_lit_copy_rom:   ldi
3917+  A046 CD A3 A0    mom_main_loop_rom:  call    mom_get_bit_rom
3918+  A049 38 F9                           jr      c, mom_lit_copy_rom
3919+  A04B 0E EF                           ld      c, -17
3920+  A04D CD A3 A0    mom_get_index_rom:  call    mom_get_bit_rom
3921+  A050 0C                              inc     c
3922+  A051 30 FA                           jr      nc, mom_get_index_rom
3923+  A053 79                              ld      a, c
3924+  A054 C8                              ret     z
3925+  A055 D5                              push    de
3926+  A056 CD 82 A0                        call    mom_get_pair_rom
3927+  A059 C5                              push    bc
3928+  A05A 20 0C                           jr      nz, mom_out_range_rom
3929+  A05C 11 20 02                        ld      de, 0x0220
3930+  A05F 0D                              dec     c
3931+  A060 28 09                           jr      z, mom_go_for_it_rom
3932+  A062 11 10 04                        ld      de, 0x0410
3933+  A065 0D                              dec     c
3934+  A066 28 03                           jr      z, mom_go_for_it_rom
3935+  A068 11 00 04    mom_out_range_rom:  ld      de, 0x0400
3936+  A06B F1          mom_go_for_it_rom:  pop     af
3937+  A06C 08                              ex      af, af'
3938+  A06D CD 94 A0                        call    mom_get_bits_rom
3939+  A070 83                              add     a, e
3940+  A071 CD 82 A0                        call    mom_get_pair_rom
3941+  A074 D1                              pop     de
3942+  A075 E5                              push    hl
3943+  A076 62                              ld      h, d
3944+  A077 6B                              ld      l, e
3945+  A078 ED 42                           sbc     hl, bc
3946+  A07A 08                              ex      af, af'
3947+  A07B F5                              push    af
3948+  A07C C1                              pop     bc
3949+  A07D ED B0                           ldir
3950+  A07F E1                              pop     hl
3951+  A080 18 C4                           jr      mom_main_loop_rom
3952+  A082 FD 6F       mom_get_pair_rom:   ld      iyl, a
3953+  A084 FD 56 00                        ld      d, (iy)
3954+  A087 CD 94 A0                        call    mom_get_bits_rom
3955+  A08A FD 86 24                        add     (iy + 36)
3956+  A08D 4F                              ld      c, a
3957+  A08E 78                              ld      a, b
3958+  A08F FD 8E 48                        adc     (iy + 72)
3959+  A092 47                              ld      b, a
3960+  A093 C9                              ret
3961+  A094 01 00 00    mom_get_bits_rom:   ld      bc, 0
3962+  A097             mom_getting_bits_rom:
3963+  A097 15                              dec     d
3964+  A098 79                              ld      a, c
3965+  A099 F8                              ret     m
3966+  A09A CD A3 A0                        call    mom_get_bit_rom
3967+  A09D CB 11                           rl      c
3968+  A09F CB 10                           rl      b
3969+  A0A1 18 F4                           jr      mom_getting_bits_rom
3970+  A0A3 DD 7C       mom_get_bit_rom:    ld      a, ixh
3971+  A0A5 87                              add     a
3972+  A0A6 20 03                           jr      nz, mom_byte_done_rom
3973+  A0A8 7E                              ld      a, (hl)
3974+  A0A9 23                              inc     hl
3975+  A0AA 17                              rla
3976+  A0AB DD 67       mom_byte_done_rom:  ld      ixh, a
3977+  A0AD C9                              ret
3978+  A0AE                                 
3979+  A0AE                                 endmodule
0233   A0AE             
0234   A0AE             
0235   A0AE             		; --- INCLUDE PT3-ROM.ASM in ROM code ---
0236   A0AE             
0237   A0AE             REPLAYER:	INCLUDE	"audio\PT3-ROM.ASM"
0001+  A0AE             		; --- PT3 REPLAYER WORKING ON ROM ---
0002+  A0AE             		; --- Can be assembled with sjasm ---
0003+  A0AE             		; --- ROM version: MSX-KUN        ---
0004+  A0AE             		; --- sjasm version: ArtRag       ---
0005+  A0AE             
0006+  A0AE             ; Based on MSX version of PT3 by Dioniso
0007+  A0AE             ;
0008+  A0AE             ; This version of the replayer uses a fixed volume and note table, if you need a 
0009+  A0AE             ; different note table you can copy it from TABLES.TXT file, distributed with the
0010+  A0AE             ; original PT3 distribution. This version also allows the use of PT3 commands.
0011+  A0AE             ;
0012+  A0AE             ; PLAY and PSG WRITE routines seperated to allow independent calls
0013+  A0AE             ;
0014+  A0AE             ; ROM LENGTH: 1528 bytes
0015+  A0AE             ; RAM LENGTH:  382 bytes
0016+  A0AE             
0017+  A0AE             		; --- CONSTANT VALUES DEFINITION ---
0018+  A0AE             
0019+  A0AE             ;ChannelsVars
0020+  A0AE             ;struc	CHNPRM
0021+  A0AE             ;reset group
0022+  A0AE             CHNPRM_PsInOr	.equ 0	;RESB 1
0023+  A0AE             CHNPRM_PsInSm	.equ 1	;RESB 1
0024+  A0AE             CHNPRM_CrAmSl	.equ 2	;RESB 1
0025+  A0AE             CHNPRM_CrNsSl	.equ 3	;RESB 1
0026+  A0AE             CHNPRM_CrEnSl	.equ 4	;RESB 1
0027+  A0AE             CHNPRM_TSlCnt	.equ 5	;RESB 1
0028+  A0AE             CHNPRM_CrTnSl	.equ 6	;RESW 1
0029+  A0AE             CHNPRM_TnAcc	.equ 8	;RESW 1
0030+  A0AE             CHNPRM_COnOff	.equ 10	;RESB 1
0031+  A0AE             ;reset group
0032+  A0AE             
0033+  A0AE             CHNPRM_OnOffD	.equ 11	;RESB 1
0034+  A0AE             
0035+  A0AE             ;IX for PTDECOD here [+12]
0036+  A0AE             CHNPRM_OffOnD	.equ 12	;RESB 1
0037+  A0AE             CHNPRM_OrnPtr	.equ 13	;RESW 1
0038+  A0AE             CHNPRM_SamPtr	.equ 15	;RESW 1
0039+  A0AE             CHNPRM_NNtSkp	.equ 17	;RESB 1
0040+  A0AE             CHNPRM_Note	.equ 18	;RESB 1
0041+  A0AE             CHNPRM_SlToNt	.equ 19	;RESB 1
0042+  A0AE             CHNPRM_Env_En	.equ 20	;RESB 1
0043+  A0AE             CHNPRM_Flags	.equ 21	;RESB 1
0044+  A0AE              ;Enabled - 0,SimpleGliss - 2
0045+  A0AE             CHNPRM_TnSlDl	.equ 22	;RESB 1
0046+  A0AE             CHNPRM_TSlStp	.equ 23	;RESW 1
0047+  A0AE             CHNPRM_TnDelt	.equ 25	;RESW 1
0048+  A0AE             CHNPRM_NtSkCn	.equ 27	;RESB 1
0049+  A0AE             CHNPRM_Volume	.equ 28	;RESB 1
0050+  A0AE             nsample EQU 29
0051+  A0AE             CHNPRM_Size	.equ 30	;RESB 1
0052+  A0AE             ;endstruc
0053+  A0AE             
0054+  A0AE             ;struc	AR
0055+  A0AE             AR_TonA		.equ 0	;RESW 1
0056+  A0AE             AR_TonB		.equ 2	;RESW 1
0057+  A0AE             AR_TonC		.equ 4	;RESW 1
0058+  A0AE             AR_Noise	.equ 6	;RESB 1
0059+  A0AE             AR_Mixer	.equ 7	;RESB 1
0060+  A0AE             AR_AmplA	.equ 8	;RESB 1
0061+  A0AE             AR_AmplB	.equ 9	;RESB 1
0062+  A0AE             AR_AmplC	.equ 10	;RESB 1
0063+  A0AE             AR_Env		.equ 11	;RESW 1
0064+  A0AE             AR_EnvTp	.equ 13	;RESB 1
0065+  A0AE             ;endstruc
0066+  A0AE             
0067+  A0AE             		; --- CODE STARTS HERE ---
0068+  A0AE             
0069+  A0AE 21 4A E4    CHECKLP:	LD	HL,PT3_SETUP
0070+  A0B1 CB FE       		SET	7,[HL]
0071+  A0B3 CB 46       		BIT	0,[HL]
0072+  A0B5 C8          		RET	Z
0073+  A0B6 E1          		POP	HL
0074+  A0B7 21 C5 E4    		LD	HL,DelyCnt
0075+  A0BA 34          		INC	[HL]
0076+  A0BB 21 86 E4    		LD	HL,ChanA+CHNPRM_NtSkCn
0077+  A0BE 34          		INC	[HL]
0078+  A0BF AF          PT3_MUTE:	XOR	A
0079+  A0C0 67          		LD	H,A
0080+  A0C1 6F          		LD	L,A
0081+  A0C2 32 D3 E4    		LD	[AYREGS+AR_AmplA],A
0082+  A0C5 22 D4 E4    		LD	[AYREGS+AR_AmplB],HL
0083+  A0C8             
0084+  A0C8 3D          	dec a
0085+  A0C9 32 D2 E4    	ld  (AYREGS+AR_Mixer),a
0086+  A0CC             
0087+  A0CC C3 F7 40    	JP      PT3_ROUT
0088+  A0CF             	
0089+  A0CF             PT3_INIT:	;HL - AddressOfModule 
0090+  A0CF 11 DC E5    		ld	de,_waves			; set waves
0091+  A0D2 01 10 00    		ld	bc,16
0092+  A0D5 ED B0       		ldir
0093+  A0D7             		
0094+  A0D7             ; call unpack with hl pointing to some pletter5 data, and de pointing to the destination.
0095+  A0D7                     
0096+  A0D7 11 67 D1            ld  de,MUSICBUFF
0097+  A0DA CD FD 9F            call miz._unpack
0098+  A0DD 21 03 D1            ld  hl,MUSICBUFF-100
0099+  A0E0             
0100+  A0E0 22 4B E4    		LD [PT3_MODADDR],HL
0101+  A0E3 E5          		PUSH HL
0102+  A0E4 11 64 00    		LD DE,100
0103+  A0E7 19          		ADD HL,DE
0104+  A0E8 7E          		LD A,[HL]
0105+  A0E9 32 66 E4    		LD [PT3_Delay],A
0106+  A0EC E5          		PUSH HL
0107+  A0ED DD E1       		POP IX
0108+  A0EF 19          		ADD HL,DE
0109+  A0F0 22 4D E4    		LD [PT3_CrPsPtr],HL
0110+  A0F3 DD 5E 02    		LD E,[IX+102-100]
0111+  A0F6 19          		ADD HL,DE
0112+  A0F7 23          		INC HL
0113+  A0F8 22 62 E4    		LD [PT3_LPosPtr],HL
0114+  A0FB D1          		POP DE
0115+  A0FC DD 6E 03    		LD L,[IX+103-100]
0116+  A0FF DD 66 04    		LD H,[IX+104-100]
0117+  A102 19          		ADD HL,DE
0118+  A103 22 64 E4    		LD [PT3_PatsPtr],HL
0119+  A106 21 A9 00    		LD HL,169
0120+  A109 19          		ADD HL,DE
0121+  A10A 22 51 E4    		LD [PT3_OrnPtrs],HL
0122+  A10D 21 69 00    		LD HL,105
0123+  A110 19          		ADD HL,DE
0124+  A111 22 4F E4    		LD [PT3_SAMPTRS],HL
0125+  A114 21 4A E4    		LD HL,PT3_SETUP
0126+  A117 CB BE       		RES 7,[HL]
0127+  A119             
0128+  A119             		; --- CREATE PT3 VOLUME TABLE (c) Ivan Roshin, adapted by SapphiRe ---
0129+  A119 21 11 00    		ld	hl,$11
0130+  A11C 54          		ld	d,h
0131+  A11D 5C          		ld	e,h
0132+  A11E DD 21 DB E4 		ld	IX,VT_+16
0133+  A122 06 0F       		ld	b,15
0134+  A124 E5          _INITV1:	push	hl
0135+  A125 19          		add	hl,de
0136+  A126 EB          		ex	de,hl
0137+  A127 ED 62       		sbc	hl,hl
0138+  A129 48          		ld	c,b
0139+  A12A 06 10       		ld	b,16
0140+  A12C 7D          _INITV2:	ld	a,l
0141+  A12D 17          		rla
0142+  A12E 7C          		ld	a,h
0143+  A12F CE 00       		adc	a,0
0144+  A131 DD 77 00    		ld	[ix],a
0145+  A134 DD 23       		inc	ix
0146+  A136 19          		add	hl,de
0147+  A137 10 F3       		djnz	_INITV2
0148+  A139 E1          		pop	hl
0149+  A13A 7B          		ld	a,e
0150+  A13B FE 77       		cp	$77
0151+  A13D 20 01       		jr	nz,_INITV3
0152+  A13F 1C          		inc	e
0153+  A140 41          _INITV3:	ld	b,c
0154+  A141 10 E1       		djnz	_INITV1
0155+  A143             
0156+  A143             		; --- INITIALIZE PT3 VARIABLES ---
0157+  A143 AF          		XOR A
0158+  A144 21 6B E4    		LD HL,VARS
0159+  A147 77          		LD [HL],A
0160+  A148 11 6C E4    		LD DE,VARS+1
0161+  A14B 01 6F 00    		LD BC,VAR0END-VARS-1
0162+  A14E ED B0       		LDIR
0163+  A150             
0164+  A150 3C          		INC A
0165+  A151 32 C5 E4    		LD [DelyCnt],A
0166+  A154 21 01 F0    		LD HL,$F001 ;H - CHNPRM_Volume, L - CHNPRM_NtSkCn
0167+  A157 22 86 E4    		LD [ChanA+CHNPRM_NtSkCn],HL
0168+  A15A 22 A4 E4    		LD [ChanB+CHNPRM_NtSkCn],HL
0169+  A15D 22 C2 E4    		LD [ChanC+CHNPRM_NtSkCn],HL
0170+  A160             
0171+  A160 21 89 A5    		LD HL,EMPTYSAMORN
0172+  A163 22 5C E4    		LD [PT3_AdInPtA],HL ;ptr to zero
0173+  A166 22 78 E4    		LD [ChanA+CHNPRM_OrnPtr],HL ;ornament 0 is "0,1,0"
0174+  A169 22 96 E4    		LD [ChanB+CHNPRM_OrnPtr],HL ;in all versions from
0175+  A16C 22 B4 E4    		LD [ChanC+CHNPRM_OrnPtr],HL ;3.xx to 3.6x and VTII
0176+  A16F             
0177+  A16F 22 7A E4    		LD [ChanA+CHNPRM_SamPtr],HL ;S1 There is no default
0178+  A172 22 98 E4    		LD [ChanB+CHNPRM_SamPtr],HL ;S2 sample in PT3, so, you
0179+  A175 22 B6 E4    		LD [ChanC+CHNPRM_SamPtr],HL ;S3 can comment S1,2,3; see
0180+  A178             					    ;also EMPTYSAMORN comment
0181+  A178 C9          		RET
0182+  A179             
0183+  A179             		;pattern decoder
0184+  A179 DD 36 08 00 PD_OrSm:	LD [IX+(CHNPRM_Env_En-12)],0
0185+  A17D CD 06 A3    		CALL SETORN
0186+  A180 0A          		LD A,[BC]
0187+  A181 03          		INC BC
0188+  A182 0F          		RRCA
0189+  A183             
0190+  A183 87          PD_SAM:		ADD A,A
0191+  A184 5F          PD_SAM_:	LD E,A
0192+  A185 16 00       		LD D,0
0193+  A187             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0194+  A187             ; SCC patch
0195+  A187             ;
0196+  A187 DD 77 11    	LD (IX-12+ nsample),A
0197+  A18A             
0198+  A18A             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0199+  A18A 2A 4F E4    		LD HL,[PT3_SAMPTRS]
0200+  A18D 19          		ADD HL,DE
0201+  A18E 5E          		LD E,[HL]
0202+  A18F 23          		INC HL
0203+  A190 56          		LD D,[HL]
0204+  A191 2A 4B E4    		LD HL,[PT3_MODADDR]
0205+  A194 19          		ADD HL,DE
0206+  A195 DD 75 03    		LD [IX+(CHNPRM_SamPtr-12)],L
0207+  A198 DD 74 04    		LD [IX+(CHNPRM_SamPtr+1-12)],H
0208+  A19B 18 41       		JR PD_LOOP
0209+  A19D             
0210+  A19D 07          PD_VOL:		RLCA
0211+  A19E 07          		RLCA
0212+  A19F 07          		RLCA
0213+  A1A0 07          		RLCA
0214+  A1A1 DD 77 10    		LD [IX+(CHNPRM_Volume-12)],A
0215+  A1A4 18 3B       		JR PD_LP2
0216+  A1A6             	
0217+  A1A6 DD 77 08    PD_EOff:	LD [IX+(CHNPRM_Env_En-12)],A
0218+  A1A9 DD 77 F4    		LD [IX+(CHNPRM_PsInOr-12)],A
0219+  A1AC 18 33       		JR PD_LP2
0220+  A1AE             
0221+  A1AE 3D          PD_SorE:	DEC A
0222+  A1AF 20 07       		JR NZ,PD_ENV
0223+  A1B1 0A          		LD A,[BC]
0224+  A1B2 03          		INC BC
0225+  A1B3 DD 77 05    		LD [IX+(CHNPRM_NNtSkp-12)],A
0226+  A1B6 18 29       		JR PD_LP2
0227+  A1B8             
0228+  A1B8 CD EA A2    PD_ENV:		CALL SETENV
0229+  A1BB 18 24       		JR PD_LP2
0230+  A1BD             
0231+  A1BD CD 06 A3    PD_ORN:		CALL SETORN
0232+  A1C0 18 1C       		JR PD_LOOP
0233+  A1C2                    
0234+  A1C2 DD 77 08    PD_ESAM:	LD [IX+(CHNPRM_Env_En-12)],A
0235+  A1C5 DD 77 F4    		LD [IX+(CHNPRM_PsInOr-12)],A
0236+  A1C8 C4 EA A2    		CALL NZ,SETENV
0237+  A1CB 0A          		LD A,[BC]
0238+  A1CC 03          		INC BC
0239+  A1CD 18 B5       		JR PD_SAM_
0240+  A1CF             
0241+  A1CF DD 7E 06    PTDECOD:	LD A,[IX+(CHNPRM_Note-12)]
0242+  A1D2 32 59 E4    		LD [PT3_PrNote],A
0243+  A1D5 DD 6E FA    		LD L,[IX+(CHNPRM_CrTnSl-12)]
0244+  A1D8 DD 66 FB    		LD H,[IX+(CHNPRM_CrTnSl+1-12)]
0245+  A1DB 22 5A E4    		LD [PT3_PrSlide],HL
0246+  A1DE             
0247+  A1DE 11 10 20    PD_LOOP:	LD DE,$2010
0248+  A1E1 0A          PD_LP2:		LD A,[BC]
0249+  A1E2 03          		INC BC
0250+  A1E3 83          		ADD A,E
0251+  A1E4 38 93       		JR C,PD_OrSm
0252+  A1E6 82          		ADD A,D
0253+  A1E7 28 4A       		JR Z,PD_FIN
0254+  A1E9 38 98       		JR C,PD_SAM
0255+  A1EB 83          		ADD A,E
0256+  A1EC 28 25       		JR Z,PD_REL
0257+  A1EE 38 AD       		JR C,PD_VOL
0258+  A1F0 83          		ADD A,E
0259+  A1F1 28 B3       		JR Z,PD_EOff
0260+  A1F3 38 B9       		JR C,PD_SorE
0261+  A1F5 C6 60       		ADD A,96
0262+  A1F7 38 20       		JR C,PD_NOTE
0263+  A1F9 83          		ADD A,E
0264+  A1FA 38 C1       		JR C,PD_ORN
0265+  A1FC 82          		ADD A,D
0266+  A1FD 38 0F       		JR C,PD_NOIS
0267+  A1FF 83          		ADD A,E
0268+  A200 38 C0       		JR C,PD_ESAM
0269+  A202 87          		ADD A,A
0270+  A203 5F          		LD E,A
0271+  A204 21 3F 82    		LD HL, (SPCCOMS+$DF20) % 65536	; Adapted from original Speccy version (saves 6 bytes)
0272+  A207 19          		ADD HL,DE
0273+  A208 5E          		LD E,[HL]
0274+  A209 23          		INC HL
0275+  A20A 56          		LD D,[HL]
0276+  A20B D5          		PUSH DE
0277+  A20C 18 D0       		JR PD_LOOP
0278+  A20E             
0279+  A20E 32 C9 E4    PD_NOIS:	LD [Ns_Base],A
0280+  A211 18 CE       		JR PD_LP2
0281+  A213             
0282+  A213 DD CB 09 86 PD_REL:		RES 0,[IX+(CHNPRM_Flags-12)]
0283+  A217 18 08       		JR PD_RES
0284+  A219             	
0285+  A219 DD 77 06    PD_NOTE:	LD [IX+(CHNPRM_Note-12)],A
0286+  A21C DD CB 09 C6 		SET 0,[IX+(CHNPRM_Flags-12)]
0287+  A220 AF          		XOR A
0288+  A221             
0289+  A221 ED 73 53 E4 PD_RES:		LD [PT3_PDSP],SP
0290+  A225 DD F9       		LD SP,IX
0291+  A227 67          		LD H,A
0292+  A228 6F          		LD L,A
0293+  A229 E5          		PUSH HL
0294+  A22A E5          		PUSH HL
0295+  A22B E5          		PUSH HL
0296+  A22C E5          		PUSH HL
0297+  A22D E5          		PUSH HL
0298+  A22E E5          		PUSH HL
0299+  A22F ED 7B 53 E4 		LD SP,[PT3_PDSP]
0300+  A233             
0301+  A233 DD 7E 05    PD_FIN:		LD A,[IX+(CHNPRM_NNtSkp-12)]
0302+  A236 DD 77 0F    		LD [IX+(CHNPRM_NtSkCn-12)],A
0303+  A239 C9          		RET
0304+  A23A             
0305+  A23A DD CB 09 96 C_PORTM:	RES 2,[IX+(CHNPRM_Flags-12)]
0306+  A23E 0A          		LD A,[BC]
0307+  A23F 03          		INC BC
0308+  A240             		;SKIP PRECALCULATED TONE DELTA [BECAUSE
0309+  A240             		;CANNOT BE RIGHT AFTER PT3 COMPILATION]
0310+  A240 03          		INC BC
0311+  A241 03          		INC BC
0312+  A242 DD 77 0A    		LD [IX+(CHNPRM_TnSlDl-12)],A
0313+  A245 DD 77 F9    		LD [IX+(CHNPRM_TSlCnt-12)],A
0314+  A248 11 8D A5    		LD DE,NT_
0315+  A24B DD 7E 06    		LD A,[IX+(CHNPRM_Note-12)]
0316+  A24E DD 77 07    		LD [IX+(CHNPRM_SlToNt-12)],A
0317+  A251 87          		ADD A,A
0318+  A252 6F          		LD L,A
0319+  A253 26 00       		LD H,0
0320+  A255 19          		ADD HL,DE
0321+  A256 7E          		LD A,[HL]
0322+  A257 23          		INC HL
0323+  A258 66          		LD H,[HL]
0324+  A259 6F          		LD L,A
0325+  A25A E5          		PUSH HL
0326+  A25B 3A 59 E4    		LD A,[PT3_PrNote]
0327+  A25E DD 77 06    		LD [IX+(CHNPRM_Note-12)],A
0328+  A261 87          		ADD A,A
0329+  A262 6F          		LD L,A
0330+  A263 26 00       		LD H,0
0331+  A265 19          		ADD HL,DE
0332+  A266 5E          		LD E,[HL]
0333+  A267 23          		INC HL
0334+  A268 56          		LD D,[HL]
0335+  A269 E1          		POP HL
0336+  A26A ED 52       		SBC HL,DE
0337+  A26C DD 75 0D    		LD [IX+(CHNPRM_TnDelt-12)],L
0338+  A26F DD 74 0E    		LD [IX+(CHNPRM_TnDelt+1-12)],H
0339+  A272 ED 5B 5A E4 		LD DE,[PT3_PrSlide]
0340+  A276 DD 73 FA    		LD [IX+(CHNPRM_CrTnSl-12)],E
0341+  A279 DD 72 FB    		LD [IX+(CHNPRM_CrTnSl+1-12)],D
0342+  A27C 0A          		LD A,[BC] ;SIGNED TONE STEP
0343+  A27D 03          		INC BC
0344+  A27E 08          		EX AF,AF'
0345+  A27F 0A          		LD A,[BC]
0346+  A280 03          		INC BC
0347+  A281 A7          		AND A
0348+  A282 28 01       		JR Z,_NOSIG
0349+  A284 EB          		EX DE,HL
0350+  A285 ED 52       _NOSIG:	SBC HL,DE
0351+  A287 F2 8F A2    		JP P,SET_STP
0352+  A28A 2F          		CPL
0353+  A28B 08          		EX AF,AF'
0354+  A28C ED 44       		NEG
0355+  A28E 08          		EX AF,AF'
0356+  A28F DD 77 0C    SET_STP:	LD [IX+(CHNPRM_TSlStp+1-12)],A
0357+  A292 08          		EX AF,AF'
0358+  A293 DD 77 0B    		LD [IX+(CHNPRM_TSlStp-12)],A
0359+  A296 DD 36 FE 00 		LD [IX+(CHNPRM_COnOff-12)],0
0360+  A29A C9          		RET
0361+  A29B             
0362+  A29B DD CB 09 D6 C_GLISS:	SET 2,[IX+(CHNPRM_Flags-12)]
0363+  A29F 0A          		LD A,[BC]
0364+  A2A0 03          		INC BC
0365+  A2A1 DD 77 0A    		LD [IX+(CHNPRM_TnSlDl-12)],A
0366+  A2A4 DD 77 F9    		LD [IX+(CHNPRM_TSlCnt-12)],A
0367+  A2A7 0A          		LD A,[BC]
0368+  A2A8 03          		INC BC
0369+  A2A9 08          		EX AF,AF'
0370+  A2AA 0A          		LD A,[BC]
0371+  A2AB 03          		INC BC
0372+  A2AC 18 E1       		JR SET_STP
0373+  A2AE             
0374+  A2AE 0A          C_SMPOS:	LD A,[BC]
0375+  A2AF 03          		INC BC
0376+  A2B0 DD 77 F5    		LD [IX+(CHNPRM_PsInSm-12)],A
0377+  A2B3 C9          		RET
0378+  A2B4             
0379+  A2B4 0A          C_ORPOS:	LD A,[BC]
0380+  A2B5 03          		INC BC
0381+  A2B6 DD 77 F4    		LD [IX+(CHNPRM_PsInOr-12)],A
0382+  A2B9 C9          		RET
0383+  A2BA             
0384+  A2BA 0A          C_VIBRT:	LD A,[BC]
0385+  A2BB 03          		INC BC
0386+  A2BC DD 77 FF    		LD [IX+(CHNPRM_OnOffD-12)],A
0387+  A2BF DD 77 FE    		LD [IX+(CHNPRM_COnOff-12)],A
0388+  A2C2 0A          		LD A,[BC]
0389+  A2C3 03          		INC BC
0390+  A2C4 DD 77 00    		LD [IX+(CHNPRM_OffOnD-12)],A
0391+  A2C7 AF          		XOR A
0392+  A2C8 DD 77 F9    		LD [IX+(CHNPRM_TSlCnt-12)],A
0393+  A2CB DD 77 FA    		LD [IX+(CHNPRM_CrTnSl-12)],A
0394+  A2CE DD 77 FB    		LD [IX+(CHNPRM_CrTnSl+1-12)],A
0395+  A2D1 C9          		RET
0396+  A2D2             
0397+  A2D2 0A          C_ENGLS:	LD A,[BC]
0398+  A2D3 03          		INC BC
0399+  A2D4 32 68 E4    		LD [PT3_Env_Del],A
0400+  A2D7 32 C8 E4    		LD [CurEDel],A
0401+  A2DA 0A          		LD A,[BC]
0402+  A2DB 03          		INC BC
0403+  A2DC 6F          		LD L,A
0404+  A2DD 0A          		LD A,[BC]
0405+  A2DE 03          		INC BC
0406+  A2DF 67          		LD H,A
0407+  A2E0 22 69 E4    		LD [PT3_ESldAdd],HL
0408+  A2E3 C9          		RET
0409+  A2E4             
0410+  A2E4 0A          C_DELAY:	LD A,[BC]
0411+  A2E5 03          		INC BC
0412+  A2E6 32 66 E4    		LD [PT3_Delay],A
0413+  A2E9 C9          		RET
0414+  A2EA             	
0415+  A2EA DD 73 08    SETENV:		LD [IX+(CHNPRM_Env_En-12)],E
0416+  A2ED 32 D8 E4    		LD [AYREGS+AR_EnvTp],A
0417+  A2F0 0A          		LD A,[BC]
0418+  A2F1 03          		INC BC
0419+  A2F2 67          		LD H,A
0420+  A2F3 0A          		LD A,[BC]
0421+  A2F4 03          		INC BC
0422+  A2F5 6F          		LD L,A
0423+  A2F6 22 D9 E4    		LD [EnvBase],HL
0424+  A2F9 AF          		XOR A
0425+  A2FA DD 77 F4    		LD [IX+(CHNPRM_PsInOr-12)],A
0426+  A2FD 32 C8 E4    		LD [CurEDel],A
0427+  A300 67          		LD H,A
0428+  A301 6F          		LD L,A
0429+  A302 22 C6 E4    		LD [CurESld],HL
0430+  A305 C9          C_NOP:		RET
0431+  A306             
0432+  A306 87          SETORN:		ADD A,A
0433+  A307 5F          		LD E,A
0434+  A308 16 00       		LD D,0
0435+  A30A DD 72 F4    		LD [IX+(CHNPRM_PsInOr-12)],D
0436+  A30D 2A 51 E4    		LD HL,[PT3_OrnPtrs]
0437+  A310 19          		ADD HL,DE
0438+  A311 5E          		LD E,[HL]
0439+  A312 23          		INC HL
0440+  A313 56          		LD D,[HL]
0441+  A314 2A 4B E4    		LD HL,[PT3_MODADDR]
0442+  A317 19          		ADD HL,DE
0443+  A318 DD 75 01    		LD [IX+(CHNPRM_OrnPtr-12)],L
0444+  A31B DD 74 02    		LD [IX+(CHNPRM_OrnPtr+1-12)],H
0445+  A31E C9          		RET
0446+  A31F             
0447+  A31F             		;ALL 16 ADDRESSES TO PROTECT FROM BROKEN PT3 MODULES
0448+  A31F 05 A3       SPCCOMS:	dw C_NOP
0449+  A321 9B A2       		dw C_GLISS
0450+  A323 3A A2       		dw C_PORTM
0451+  A325 AE A2       		dw C_SMPOS
0452+  A327 B4 A2       		dw C_ORPOS
0453+  A329 BA A2       		dw C_VIBRT
0454+  A32B 05 A3       		dw C_NOP
0455+  A32D 05 A3       		dw C_NOP
0456+  A32F D2 A2       		dw C_ENGLS
0457+  A331 E4 A2       		dw C_DELAY
0458+  A333 05 A3       		dw C_NOP
0459+  A335 05 A3       		dw C_NOP
0460+  A337 05 A3       		dw C_NOP
0461+  A339 05 A3       		dw C_NOP
0462+  A33B 05 A3       		dw C_NOP
0463+  A33D 05 A3       		dw C_NOP
0464+  A33F             
0465+  A33F AF          CHREGS:		XOR A
0466+  A340 32 D5 E4    		LD [AYREGS+AR_AmplC],A
0467+  A343 DD CB 15 46 		BIT 0,[IX+CHNPRM_Flags]
0468+  A347 E5          		PUSH HL
0469+  A348 CA 6E A4    		JP Z,_CH_EXIT
0470+  A34B ED 73 55 E4 		LD [PT3_CSP],SP
0471+  A34F DD 6E 0D    		LD L,[IX+CHNPRM_OrnPtr]
0472+  A352 DD 66 0E    		LD H,[IX+CHNPRM_OrnPtr+1]
0473+  A355 F9          		LD SP,HL
0474+  A356 D1          		POP DE
0475+  A357 67          		LD H,A
0476+  A358 DD 7E 00    		LD A,[IX+CHNPRM_PsInOr]
0477+  A35B 6F          		LD L,A
0478+  A35C 39          		ADD HL,SP
0479+  A35D 3C          		INC A
0480+  A35E BA          		CP D
0481+  A35F 38 01       		JR C,_CH_ORPS
0482+  A361 7B          		LD A,E
0483+  A362 DD 77 00    _CH_ORPS:	LD [IX+CHNPRM_PsInOr],A
0484+  A365 DD 7E 12    		LD A,[IX+CHNPRM_Note]
0485+  A368 86          		ADD A,[HL]
0486+  A369 F2 6D A3    		JP P,_CH_NTP
0487+  A36C AF          		XOR A
0488+  A36D FE 60       _CH_NTP:	CP 96
0489+  A36F 38 02       		JR C,_CH_NOK
0490+  A371 3E 5F       		LD A,95
0491+  A373 87          _CH_NOK:	ADD A,A
0492+  A374 08          		EX AF,AF'
0493+  A375 DD 6E 0F    		LD L,[IX+CHNPRM_SamPtr]
0494+  A378 DD 66 10    		LD H,[IX+CHNPRM_SamPtr+1]
0495+  A37B F9          		LD SP,HL
0496+  A37C D1          		POP DE
0497+  A37D 26 00       		LD H,0
0498+  A37F DD 7E 01    		LD A,[IX+CHNPRM_PsInSm]
0499+  A382 47          		LD B,A
0500+  A383 87          		ADD A,A
0501+  A384 87          		ADD A,A
0502+  A385 6F          		LD L,A
0503+  A386 39          		ADD HL,SP
0504+  A387 F9          		LD SP,HL
0505+  A388 78          		LD A,B
0506+  A389 3C          		INC A
0507+  A38A BA          		CP D
0508+  A38B 38 01       		JR C,_CH_SMPS
0509+  A38D 7B          		LD A,E
0510+  A38E DD 77 01    _CH_SMPS:	LD [IX+CHNPRM_PsInSm],A
0511+  A391 C1          		POP BC
0512+  A392 E1          		POP HL
0513+  A393 DD 5E 08    		LD E,[IX+CHNPRM_TnAcc]
0514+  A396 DD 56 09    		LD D,[IX+CHNPRM_TnAcc+1]
0515+  A399 19          		ADD HL,DE
0516+  A39A CB 70       		BIT 6,B
0517+  A39C 28 06       		JR Z,_CH_NOAC
0518+  A39E DD 75 08    		LD [IX+CHNPRM_TnAcc],L
0519+  A3A1 DD 74 09    		LD [IX+CHNPRM_TnAcc+1],H
0520+  A3A4 EB          _CH_NOAC:	EX DE,HL
0521+  A3A5 08          		EX AF,AF'
0522+  A3A6 6F          		LD L,A
0523+  A3A7 26 00       		LD H,0
0524+  A3A9 31 8D A5    		LD SP,NT_
0525+  A3AC 39          		ADD HL,SP
0526+  A3AD F9          		LD SP,HL
0527+  A3AE E1          		POP HL
0528+  A3AF 19          		ADD HL,DE
0529+  A3B0 DD 5E 06    		LD E,[IX+CHNPRM_CrTnSl]
0530+  A3B3 DD 56 07    		LD D,[IX+CHNPRM_CrTnSl+1]
0531+  A3B6 19          		ADD HL,DE
0532+  A3B7 ED 7B 55 E4 		LD SP,[PT3_CSP]
0533+  A3BB E3          		EX [SP],HL
0534+  A3BC AF          		XOR A
0535+  A3BD DD B6 05    		OR [IX+CHNPRM_TSlCnt]
0536+  A3C0 28 3E       		JR Z,_CH_AMP
0537+  A3C2 DD 35 05    		DEC [IX+CHNPRM_TSlCnt]
0538+  A3C5 20 39       		JR NZ,_CH_AMP
0539+  A3C7 DD 7E 16    		LD A,[IX+CHNPRM_TnSlDl]
0540+  A3CA DD 77 05    		LD [IX+CHNPRM_TSlCnt],A
0541+  A3CD DD 6E 17    		LD L,[IX+CHNPRM_TSlStp]
0542+  A3D0 DD 66 18    		LD H,[IX+CHNPRM_TSlStp+1]
0543+  A3D3 7C          		LD A,H
0544+  A3D4 19          		ADD HL,DE
0545+  A3D5 DD 75 06    		LD [IX+CHNPRM_CrTnSl],L
0546+  A3D8 DD 74 07    		LD [IX+CHNPRM_CrTnSl+1],H
0547+  A3DB DD CB 15 56 		BIT 2,[IX+CHNPRM_Flags]
0548+  A3DF 20 1F       		JR NZ,_CH_AMP
0549+  A3E1 DD 5E 19    		LD E,[IX+CHNPRM_TnDelt]
0550+  A3E4 DD 56 1A    		LD D,[IX+CHNPRM_TnDelt+1]
0551+  A3E7 A7          		AND A
0552+  A3E8 28 01       		JR Z,_CH_STPP
0553+  A3EA EB          		EX DE,HL
0554+  A3EB ED 52       _CH_STPP:	SBC HL,DE
0555+  A3ED FA 00 A4    		JP M,_CH_AMP
0556+  A3F0 DD 7E 13    		LD A,[IX+CHNPRM_SlToNt]
0557+  A3F3 DD 77 12    		LD [IX+CHNPRM_Note],A
0558+  A3F6 AF          		XOR A
0559+  A3F7 DD 77 05    		LD [IX+CHNPRM_TSlCnt],A
0560+  A3FA DD 77 06    		LD [IX+CHNPRM_CrTnSl],A
0561+  A3FD DD 77 07    		LD [IX+CHNPRM_CrTnSl+1],A
0562+  A400 DD 7E 02    _CH_AMP:	LD A,[IX+CHNPRM_CrAmSl]
0563+  A403 CB 79       		BIT 7,C
0564+  A405 28 13       		JR Z,_CH_NOAM
0565+  A407 CB 71       		BIT 6,C
0566+  A409 28 07       		JR Z,_CH_AMIN
0567+  A40B FE 0F       		CP 15
0568+  A40D 28 0B       		JR Z,_CH_NOAM
0569+  A40F 3C          		INC A
0570+  A410 18 05       		JR _CH_SVAM
0571+  A412 FE F1       _CH_AMIN:	CP -15
0572+  A414 28 04       		JR Z,_CH_NOAM
0573+  A416 3D          		DEC A
0574+  A417 DD 77 02    _CH_SVAM:	LD [IX+CHNPRM_CrAmSl],A
0575+  A41A 6F          _CH_NOAM:	LD L,A
0576+  A41B 78          		LD A,B
0577+  A41C E6 0F       		AND 15
0578+  A41E 85          		ADD A,L
0579+  A41F F2 23 A4    		JP P,_CH_APOS
0580+  A422 AF          		XOR A
0581+  A423 FE 10       _CH_APOS:	CP 16
0582+  A425 38 02       		JR C,_CH_VOL
0583+  A427 3E 0F       		LD A,15
0584+  A429 DD B6 1C    _CH_VOL:	OR [IX+CHNPRM_Volume]
0585+  A42C 6F          		LD L,A
0586+  A42D 26 00       		LD H,0
0587+  A42F 11 CB E4    		LD DE,VT_
0588+  A432 19          		ADD HL,DE
0589+  A433 7E          		LD A,[HL]
0590+  A434 CB 41       _CH_ENV:	BIT 0,C
0591+  A436 20 03       		JR NZ,_CH_NOEN
0592+  A438 DD B6 14    		OR [IX+CHNPRM_Env_En]
0593+  A43B 32 D5 E4    _CH_NOEN:	LD [AYREGS+AR_AmplC],A
0594+  A43E CB 78       		BIT 7,B
0595+  A440 79          		LD A,C
0596+  A441 28 19       		JR Z,_NO_ENSL
0597+  A443 17          		RLA
0598+  A444 17          		RLA
0599+  A445 CB 2F       		SRA A
0600+  A447 CB 2F       		SRA A
0601+  A449 CB 2F       		SRA A
0602+  A44B DD 86 04    		ADD A,[IX+CHNPRM_CrEnSl] ;SEE COMMENT BELOW
0603+  A44E CB 68       		BIT 5,B
0604+  A450 28 03       		JR Z,_NO_ENAC
0605+  A452 DD 77 04    		LD [IX+CHNPRM_CrEnSl],A
0606+  A455 21 67 E4    _NO_ENAC:	LD HL,PT3_AddToEn
0607+  A458 86          		ADD A,[HL] ;BUG IN PT3 - NEED WORD HERE.
0608+  A459             			   ;FIX IT IN NEXT VERSION?
0609+  A459 77          		LD [HL],A
0610+  A45A 18 0E       		JR _CH_MIX
0611+  A45C 1F          _NO_ENSL:	RRA
0612+  A45D DD 86 03    		ADD A,[IX+CHNPRM_CrNsSl]
0613+  A460 32 CA E4    		LD [AddToNs],A
0614+  A463 CB 68       		BIT 5,B
0615+  A465 28 03       		JR Z,_CH_MIX
0616+  A467 DD 77 03    		LD [IX+CHNPRM_CrNsSl],A
0617+  A46A 78          _CH_MIX:	LD A,B
0618+  A46B 1F          		RRA
0619+  A46C E6 48       		AND $48
0620+  A46E 21 D2 E4    _CH_EXIT:	LD HL,AYREGS+AR_Mixer
0621+  A471 B6          		OR [HL]
0622+  A472 0F          		RRCA
0623+  A473 77          		LD [HL],A
0624+  A474 E1          		POP HL
0625+  A475 AF          		XOR A
0626+  A476 DD B6 0A    		OR [IX+CHNPRM_COnOff]
0627+  A479 C8          		RET Z
0628+  A47A DD 35 0A    		DEC [IX+CHNPRM_COnOff]
0629+  A47D C0          		RET NZ
0630+  A47E DD AE 15    		XOR [IX+CHNPRM_Flags]
0631+  A481 DD 77 15    		LD [IX+CHNPRM_Flags],A
0632+  A484 1F          		RRA
0633+  A485 DD 7E 0B    		LD A,[IX+CHNPRM_OnOffD]
0634+  A488 38 03       		JR C,_CH_ONDL
0635+  A48A DD 7E 0C    		LD A,[IX+CHNPRM_OffOnD]
0636+  A48D DD 77 0A    _CH_ONDL:	LD [IX+CHNPRM_COnOff],A
0637+  A490 C9          		RET
0638+  A491             
0639+  A491 AF          PT3_PLAY:	XOR A
0640+  A492 32 67 E4    		LD [PT3_AddToEn],A
0641+  A495 32 D2 E4    		LD [AYREGS+AR_Mixer],A
0642+  A498 3D          		DEC A
0643+  A499 32 D8 E4    		LD [AYREGS+AR_EnvTp],A
0644+  A49C 21 C5 E4    		LD HL,DelyCnt
0645+  A49F 35          		DEC [HL]
0646+  A4A0 C2 27 A5    		JP NZ,_PL2
0647+  A4A3 21 86 E4    		LD HL,ChanA+CHNPRM_NtSkCn
0648+  A4A6 35          		DEC [HL]
0649+  A4A7 20 4E       		JR NZ,_PL1B
0650+  A4A9 ED 4B 5C E4 		LD BC,[PT3_AdInPtA]
0651+  A4AD 0A          		LD A,[BC]
0652+  A4AE A7          		AND A
0653+  A4AF 20 3B       		JR NZ,_PL1A
0654+  A4B1 57          		LD D,A
0655+  A4B2 32 C9 E4    		LD [Ns_Base],A
0656+  A4B5 2A 4D E4    		LD HL,[PT3_CrPsPtr]
0657+  A4B8 23          		INC HL
0658+  A4B9 7E          		LD A,[HL]
0659+  A4BA 3C          		INC A
0660+  A4BB 20 08       		JR NZ,_PLNLP
0661+  A4BD CD AE A0    		CALL CHECKLP
0662+  A4C0 2A 62 E4    		LD HL,[PT3_LPosPtr]
0663+  A4C3 7E          		LD A,[HL]
0664+  A4C4 3C          		INC A
0665+  A4C5 22 4D E4    _PLNLP:	LD [PT3_CrPsPtr],HL
0666+  A4C8 3D          		DEC A
0667+  A4C9 87          		ADD A,A
0668+  A4CA 5F          		LD E,A
0669+  A4CB CB 12       		RL D
0670+  A4CD 2A 64 E4    		LD HL,[PT3_PatsPtr]
0671+  A4D0 19          		ADD HL,DE
0672+  A4D1 ED 5B 4B E4 		LD DE,[PT3_MODADDR]
0673+  A4D5 ED 73 57 E4 		LD [PT3_PSP],SP
0674+  A4D9 F9          		LD SP,HL
0675+  A4DA E1          		POP HL
0676+  A4DB 19          		ADD HL,DE
0677+  A4DC 44          		LD B,H
0678+  A4DD 4D          		LD C,L
0679+  A4DE E1          		POP HL
0680+  A4DF 19          		ADD HL,DE
0681+  A4E0 22 5E E4    		LD [PT3_AdInPtB],HL
0682+  A4E3 E1          		POP HL
0683+  A4E4 19          		ADD HL,DE
0684+  A4E5 22 60 E4    		LD [PT3_AdInPtC],HL
0685+  A4E8 ED 7B 57 E4 		LD SP,[PT3_PSP]
0686+  A4EC             
0687+  A4EC DD 21 77 E4 _PL1A:		LD IX,ChanA+12
0688+  A4F0 CD CF A1    		CALL PTDECOD
0689+  A4F3 ED 43 5C E4 		LD [PT3_AdInPtA],BC
0690+  A4F7             
0691+  A4F7 21 A4 E4    _PL1B:		LD HL,ChanB+CHNPRM_NtSkCn
0692+  A4FA 35          		DEC [HL]
0693+  A4FB 20 0F       		JR NZ,_PL1C
0694+  A4FD DD 21 95 E4 		LD IX,ChanB+12
0695+  A501 ED 4B 5E E4 		LD BC,[PT3_AdInPtB]
0696+  A505 CD CF A1    		CALL PTDECOD
0697+  A508 ED 43 5E E4 		LD [PT3_AdInPtB],BC
0698+  A50C             
0699+  A50C 21 C2 E4    _PL1C:		LD HL,ChanC+CHNPRM_NtSkCn
0700+  A50F 35          		DEC [HL]
0701+  A510 20 0F       		JR NZ,_PL1D
0702+  A512 DD 21 B3 E4 		LD IX,ChanC+12
0703+  A516 ED 4B 60 E4 		LD BC,[PT3_AdInPtC]
0704+  A51A CD CF A1    		CALL PTDECOD
0705+  A51D ED 43 60 E4 		LD [PT3_AdInPtC],BC
0706+  A521             
0707+  A521 3A 66 E4    _PL1D:		LD A,[PT3_Delay]
0708+  A524 32 C5 E4    		LD [DelyCnt],A
0709+  A527             
0710+  A527 DD 21 6B E4 _PL2:		LD IX,ChanA
0711+  A52B 2A CB E4    		LD HL,[AYREGS+AR_TonA]
0712+  A52E CD 3F A3    		CALL CHREGS
0713+  A531 22 CB E4    		LD [AYREGS+AR_TonA],HL
0714+  A534 3A D5 E4    		LD A,[AYREGS+AR_AmplC]
0715+  A537 32 D3 E4    		LD [AYREGS+AR_AmplA],A
0716+  A53A DD 21 89 E4 		LD IX,ChanB
0717+  A53E 2A CD E4    		LD HL,[AYREGS+AR_TonB]
0718+  A541 CD 3F A3    		CALL CHREGS
0719+  A544 22 CD E4    		LD [AYREGS+AR_TonB],HL
0720+  A547 3A D5 E4    		LD A,[AYREGS+AR_AmplC]
0721+  A54A 32 D4 E4    		LD [AYREGS+AR_AmplB],A
0722+  A54D DD 21 A7 E4 		LD IX,ChanC
0723+  A551 2A CF E4    		LD HL,[AYREGS+AR_TonC]
0724+  A554 CD 3F A3    		CALL CHREGS
0725+  A557 22 CF E4    		LD [AYREGS+AR_TonC],HL
0726+  A55A             
0727+  A55A 2A C9 E4    		LD HL,[Ns_Base_AddToNs]
0728+  A55D 7C          		LD A,H
0729+  A55E 85          		ADD A,L
0730+  A55F 32 D1 E4    		LD [AYREGS+AR_Noise],A
0731+  A562             
0732+  A562 3A 67 E4    		LD A,[PT3_AddToEn]
0733+  A565 5F          		LD E,A
0734+  A566 87          		ADD A,A
0735+  A567 9F          		SBC A,A
0736+  A568 57          		LD D,A
0737+  A569 2A D9 E4    		LD HL,[EnvBase]
0738+  A56C 19          		ADD HL,DE
0739+  A56D ED 5B C6 E4 		LD DE,[CurESld]
0740+  A571 19          		ADD HL,DE
0741+  A572 22 D6 E4    		LD [AYREGS+AR_Env],HL
0742+  A575             
0743+  A575 AF          		XOR A
0744+  A576 21 C8 E4    		LD HL,CurEDel
0745+  A579 B6          		OR [HL]
0746+  A57A C8          		RET Z
0747+  A57B 35          		DEC [HL]
0748+  A57C C0          		RET NZ
0749+  A57D 3A 68 E4    		LD A,[PT3_Env_Del]
0750+  A580 77          		LD [HL],A
0751+  A581 2A 69 E4    		LD HL,[PT3_ESldAdd]
0752+  A584 19          		ADD HL,DE
0753+  A585 22 C6 E4    		LD [CurESld],HL
0754+  A588 C9          		RET
0755+  A589             
0756+  A589             
0757+  A589             
0758+  A589             
0759+  A589             
0760+  A589             	
0761+  A589             
0762+  A589             
0763+  A589             	
0764+  A589             
0765+  A589             
0766+  A589             
0767+  A589             
0768+  A589             
0769+  A589             
0770+  A589             
0771+  A589             	
0772+  A589             
0773+  A589             
0774+  A589             	
0775+  A589             
0776+  A589             
0777+  A589             
0778+  A589             
0779+  A589             
0780+  A589             
0781+  A589             
0782+  A589             
0783+  A589             	
0784+  A589             
0785+  A589             
0786+  A589             
0787+  A589             
0788+  A589             	
0789+  A589             
0790+  A589             
0791+  A589             	
0792+  A589             
0793+  A589             
0794+  A589             
0795+  A589             
0796+  A589             
0797+  A589             
0798+  A589             
0799+  A589             	
0800+  A589             
0801+  A589             
0802+  A589             	
0803+  A589             
0804+  A589 00 01 00 90 EMPTYSAMORN: 	db 0,1,0,$90 ;delete $90 if you don't need default sample
0805+  A58D             
0806+  A58D             NT_:	;Note table 2 [if you use another in Vortex Tracker II copy it and paste
0807+  A58D             	;it from TABLES.TXT]
0808+  A58D             
0809+  A58D             	dw $0D10,$0C55,$0BA4,$0AFC,$0A5F,$09CA,$093D,$08B8,$083B,$07C5,$0755,$06EC
0809+  A58D 100D550CA40BFC0A5F0ACA093D09B8083B08C5075507EC06
0810+  A5A5             	dw $0688,$062A,$05D2,$057E,$052F,$04E5,$049E,$045C,$041D,$03E2,$03AB,$0376
0810+  A5A5 88062A06D2057E052F05E5049E045C041D04E203AB037603
0811+  A5BD             	dw $0344,$0315,$02E9,$02BF,$0298,$0272,$024F,$022E,$020F,$01F1,$01D5,$01BB
0811+  A5BD 44031503E902BF02980272024F022E020F02F101D501BB01
0812+  A5D5             	dw $01A2,$018B,$0174,$0160,$014C,$0139,$0128,$0117,$0107,$00F9,$00EB,$00DD
0812+  A5D5 A2018B01740160014C013901280117010701F900EB00DD00
0813+  A5ED             	dw $00D1,$00C5,$00BA,$00B0,$00A6,$009D,$0094,$008C,$0084,$007C,$0075,$006F
0813+  A5ED D100C500BA00B000A6009D0094008C0084007C0075006F00
0814+  A605             	dw $0069,$0063,$005D,$0058,$0053,$004E,$004A,$0046,$0042,$003E,$003B,$0037
0814+  A605 690063005D00580053004E004A00460042003E003B003700
0815+  A61D             	dw $0034,$0031,$002F,$002C,$0029,$0027,$0025,$0023,$0021,$001F,$001D,$001C
0815+  A61D 340031002F002C00290027002500230021001F001D001C00
0816+  A635             	dw $001A,$0019,$0017,$0016,$0015,$0014,$0012,$0011,$0010,$000F,$000E,$000D
0816+  A635 1A00190017001600150014001200110010000F000E000D00
0238   A64D             
0239   A64D             		; --- INCLUDE MUSIC in ROM code (don't forget to strip first 100 bytes of PT3 module ---
0240   A64D             
0241   A64D             
0242   A64D             MUSIC0:		db 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
0242   A64D 000102030405060708090A0B0C0D0E0F
0243   A65D             			INCLUDE	"audio\music0.asm"
0001+  A65D                ;  01 DDINTRO.pt3, without 100 bytes of header, compressed by Mizer
0002+  A65D                db 011h,002h,023h,001h,002h,014h,000h,000h,022h,010h,003h,014h,055h,053h,066h,0A2h
0002+  A65D 110223010214000022100314555366A2
0003+  A66D                db 020h,001h,000h,000h,011h,014h,055h,065h,000h,021h,0C0h,003h,010h,0D2h,000h,0DAh
0003+  A66D 20010000111455650021C00310D200DA
0004+  A67D                db 0C3h,0EFh,007h,0E9h,031h,008h,073h,0A5h,0B9h,0ACh,0FFh,083h,000h,004h,00Eh,011h
0004+  A67D C3EF07E9310873A5B9ACFF8300040E11
0005+  A68D                db 009h,014h,090h,002h,0D9h,003h,0FFh,006h,009h,00Ch,00Fh,012h,015h,018h,01Bh,0FFh
0005+  A68D 09149002D903FF06090C0F1215181BFF
0006+  A69D                db 01Eh,021h,024h,027h,02Ah,02Dh,0FFh,03Ah,0D3h,001h,058h,079h,04Ch,08Ch,085h,0A4h
0006+  A69D 1E2124272A2DFF3AD30158794C8C85A4
0007+  A6AD                db 0AFh,0D0h,053h,0BFh,0D2h,04Dh,0F1h,03Dh,01Ah,002h,02Dh,034h,081h,0D3h,09Ch,0A8h
0007+  A6AD AFD053BFD24DF13D1A022D3481D39CA8
0008+  A6BD                db 04Dh,0FBh,03Dh,023h,003h,03Fh,034h,093h,0D3h,0ABh,0B7h,04Fh,00Ah,004h,033h,04Dh
0008+  A6BD 4DFB3D23033F3493D3ABB74F0A04334D
0009+  A6CD                db 06Bh,034h,0A1h,0D3h,0BAh,0EFh,04Fh,015h,005h,035h,04Dh,05Bh,034h,091h,0D3h,0BAh
0009+  A6CD 6B34A1D3BAEF4F1505354D5B3491D3BA
0010+  A6DD                db 0EFh,04Fh,015h,006h,03Ch,04Dh,062h,034h,06Fh,0D2h,098h,0F1h,035h,0CDh,069h,0F4h
0010+  A6DD EF4F15063C4D62346FD298F135CD69F4
0011+  A6ED                db 0DEh,01Ah,007h,006h,04Fh,0ADh,084h,034h,0ACh,0D3h,0C7h,0D2h,0FEh,0CDh,0B1h,008h
0011+  A6ED DE1A07064FAD8434ACD3C7D2FECDB108
0012+  A6FD                db 074h,078h,0D6h,0CAh,0B7h,004h,073h,0A6h,0C5h,0C3h,097h,02Bh,074h,09Fh,076h,07Ah
0012+  A6FD 7478D6CAB70473A6C5C3972B749F767A
0013+  A70D                db 07Dh,072h,0DCh,07Ch,0D6h,0FBh,000h,0D1h,0CFh,04Ah,065h,015h,0D4h,014h,0C0h,0EDh
0013+  A70D 7D72DC7CD6FB00D1CF4A6515D414C0ED
0014+  A71D                db 002h,067h,068h,0A8h,06Ah,022h,05Eh,0B1h,0A5h,06Ch,00Fh,01Fh,073h,075h,097h,060h
0014+  A71D 026768A86A225EB1A56C0F1F73759760
0015+  A72D                db 06Bh,0CEh,0C6h,07Bh,07Dh,080h,084h,087h,0A2h,0ACh,086h,06Bh,082h,052h,010h,0B7h
0015+  A72D 6BCEC67B7D808487A2AC866B825210B7
0016+  A73D                db 000h,0D2h,059h,001h,0BDh,078h,096h,007h,0D0h,0E5h,07Bh,01Ah,061h,0D2h,07Bh,05Dh
0016+  A73D 00D25901BD789607D0E57B1A61D27B5D
0017+  A74D                db 0CDh,078h,0C9h,0ECh,0EEh,07Ch,04Bh,00Eh,060h,0DFh,089h,084h,0C6h,080h,07Dh,086h
0017+  A74D CD78C9ECEE7C4B0E60DF8984C6807D86
0018+  A75D                db 0ABh,088h,07Ah,038h,0CDh,012h,03Eh,049h,0F0h,078h,07Bh,04Eh,012h,071h,0A7h,050h
0018+  A75D AB887A38CD123E49F0787B4E1271A750
0019+  A76D                db 050h,0E2h,0C7h,0A0h,06Fh,007h,00Ah,07Dh,0DAh,076h,095h,003h,01Dh,0DDh,00Eh,060h
0019+  A76D 50E2C7A06F070A7DDA7695031DDD0E60
0020+  A77D                db 0C0h,055h,025h,08Ch,055h,0D4h,056h,08Bh,0B5h,0ACh,088h,067h,08Ch,057h,000h,0D3h
0020+  A77D C055258C55D4568BB5AC88678C5700D3
0021+  A78D                db 0BBh,0C3h,0BEh,0DFh,078h,074h,0C2h,0FAh,071h,06Ch,068h,065h,0C1h,08Bh,017h,035h
0021+  A78D BBC3BEDF7874C2FA716C6865C18B1735
0022+  A79D                db 095h,078h,0BEh,0C3h,06Bh,0C4h,035h,09Ah,0C5h,0CDh,0C6h,066h,0C7h,0B3h,0C8h,059h
0022+  A79D 9578BEC36BC4359AC5CDC666C7B3C859
0023+  A7AD                db 0C9h,0ACh,0CAh,0D6h,0CBh,06Bh,0CCh,035h,09Ah,0CDh,0CDh,0CEh,077h,000h,0D4h,0CBh
0023+  A7AD C9ACCAD6CB6BCC359ACDCDCE7700D4CB
0024+  A7BD                db 0BFh,008h,033h,00Ah,0C0h,0D6h,0D1h,0C7h,064h,00Eh,084h,087h,012h,063h,023h,05Fh
0024+  A7BD BF08330AC0D6D1C7640E84871263235F
0025+  A7CD                db 008h,037h,006h,08Ch,07Fh,045h,0CBh,0FEh,08Fh,0C0h,049h,022h,06Fh,0CFh,016h,0D7h
0025+  A7CD 0837068C7F45CBFE8FC049226FCF16D7
0026+  A7DD                db 0CEh,00Ch,05Eh,0CCh,019h,05Ch,0CAh,033h,0F8h,0C8h,06Dh,070h,0C6h,0DFh,0E1h,0C4h
0026+  A7DD CE0C5ECC195CCA33F8C86D70C6DFE1C4
0027+  A7ED                db 0C4h,0C1h,0B9h,039h,0DAh,0F2h,00Eh,062h,0ADh,002h,02Dh,04Eh,004h,0A9h,078h,08Eh
0027+  A7ED C4C1B939DAF20E62AD022D4E04A9788E
0028+  A7FD                db 0D6h,084h,06Bh,061h,011h,048h,0DBh,00Ah,063h,04Eh,006h,087h,000h,0AEh,00Ch,0D0h
0028+  A7FD D6846B611148DB0A634E068700AE0CD0
0029+  A80D                db 016h,0F2h,016h,084h,0E7h,08Ch,024h,08Ah,0B8h,062h,08Eh,087h,077h,082h,0FFh,07Fh
0029+  A80D 16F21684E78C248AB8628E877782FF7F
0030+  A81D                db 07Ah,076h,0C2h,073h,06Eh,06Ah,067h,0A8h,0C1h,0B1h,073h,05Fh,07Ah,07Fh,082h,086h
0030+  A81D 7A76C2736E6A67A8C1B1735F7A7F8286
0031+  A82D                db 09Ah,0C3h,0CDh,0C4h,066h,0C5h,0B3h,0C6h,059h,0C7h,0ACh,0C8h,0D6h,0C9h,06Bh,0CAh
0031+  A82D 9AC3CDC466C5B3C659C7ACC8D6C96BCA
0032+  A83D                db 035h,09Ah,0CBh,0CDh,0CCh,066h,0CDh,0B3h,0CEh,053h,0C2h,073h,012h,067h,0E2h,086h
0032+  A83D 359ACBCDCC66CDB3CE53C2731267E286
0033+  A84D                db 066h,09Fh,065h,017h,08Dh,0E2h,0C4h,08Eh,0E3h,08Bh,086h,049h,022h,06Eh,05Ch,01Ch
0033+  A84D 669F65178DE2C48EE38B8649226E5C1C
0034+  A85D                db 052h,0CEh,018h,0A4h,0CCh,032h,088h,0CAh,067h,090h,0C8h,0DAh,021h,0C6h,0BEh,043h
0034+  A85D 52CE18A4CC3288CA6790C8DA21C6BE43
0035+  A86D                db 0C4h,088h,003h,072h,041h,038h,09Eh,064h,0D9h,08Dh,02Fh,036h,09Fh,03Ah,00Ah,054h
0035+  A86D C488037241389E64D98D2F369F3A0A54
0036+  A87D                db 0BDh,086h,087h,089h,0C5h,0F1h,0BDh,08Bh,0C6h,0D0h,0C7h,034h,0C8h,0F5h,0C9h,087h
0036+  A87D BD868789C5F1BD8BC6D0C734C8F5C987
0037+  A88D                db 0CAh,07Ah,0CBh,086h,0CCh,0A7h,0C8h,0CEh,077h,021h,06Eh,086h,072h,08Eh,048h,0AFh
0037+  A88D CA7ACB86CCA7C8CE77216E86728E48AF
0038+  A89D                db 0C1h,090h,0C2h,078h,09Dh,0D0h,0C3h,034h,0C4h,0D2h,0C5h,034h,02Dh,025h,00Bh,04Bh
0038+  A89D C190C2789DD0C334C4D2C5342D250B4B
0039+  A8AD                db 0C7h,0D3h,0CDh,0CEh,04Ch,0CFh,0A2h,03Fh,004h,0C0h,0D1h,041h,0CBh,078h,08Ah,07Ah
0039+  A8AD C7D3CDCE4CCFA23F04C0D141CB788A7A
0040+  A8BD                db 0E6h,0AAh,090h,0CCh,0D2h,021h,049h,07Dh,025h,07Fh,050h,01Bh,019h,0FBh,09Eh,0B7h
0040+  A8BD E6AA90CCD221497D257F501B19FB9EB7
0041+  A8CD                db 067h,073h,071h,0D5h,06Ah,069h,0AFh,014h,06Dh,065h,0B6h,071h,0AFh,069h,06Ch,0BCh
0041+  A8CD 677371D56A69AF146D65B671AF696CBC
0042+  A8DD                db 0F8h,07Ah,0E7h,009h,07Fh,0BCh,086h,066h,091h,00Ah,081h,049h,020h,082h,016h,032h
0042+  A8DD F87AE7097FBC8666910A814920821632
0043+  A8ED                db 0BAh,081h,069h,01Ah,04Ah,07Dh,092h,00Ch,072h,0D9h,07Bh,07Ch,079h,078h,027h,0EEh
0043+  A8ED BA81691A4A7D920C72D97B7C797827EE
0044+  A8FD                db 064h,070h,012h,067h,0F8h,04Dh,07Bh,06Ch,063h,06Fh,043h,0B3h,016h,0D8h,0D1h,0F6h
0044+  A8FD 64701267F84D7B6C636F43B316D8D1F6
0045+  A90D                db 000h,0F6h,0A3h,049h,081h,07Ah,039h,082h,054h,071h,0ABh,008h,07Dh,00Eh,0C3h,07Ch
0045+  A90D 00F6A349817A39825471AB087D0EC37C
0046+  A91D                db 026h,045h,048h,066h,069h,022h,01Ah,004h,0A8h,00Dh,08Ch,04Dh,087h,069h,075h,071h
0046+  A91D 2645486669221A04A80D8C4D87697571
0047+  A92D                db 0D9h,070h,06Eh,0C2h,06Ch,047h,0B9h,0AFh,05Ah,0D2h,06Bh,012h,01Fh,071h,03Dh,025h
0047+  A92D D9706EC26C47B9AF5AD26B121F713D25
0048+  A93D                db 052h,019h,09Ah,044h,029h,083h,024h,080h,084h,058h,0CBh,005h,002h,0DAh,099h,09Eh
0048+  A93D 52199A44298324808458CB0502DA999E
0049+  A94D                db 065h,00Ch,027h,02Dh,0BFh,07Dh,0DDh,059h,07Ah,03Fh,066h,072h,070h,0CAh,06Ch,06Bh
0049+  A94D 650C272DBF7DDD597A3F667270CA6C6B
0050+  A95D                db 0F6h,012h,00Eh,0DEh,077h,03Dh,06Bh,069h,0A2h,0F8h,000h,01Eh,0E2h,069h,02Fh,083h
0050+  A95D F6120EDE773D6B69A2F8001EE2692F83
0051+  A96D                db 055h,084h,02Bh,01Bh,08Dh,008h,052h,0F2h,0BAh,041h,009h,0FAh,0D0h,0F4h,0F3h,091h
0051+  A96D 55842B1B8D0852F2BA4109FAD0F4F391
0052+  A97D                db 0ECh,06Ch,06Ah,0E1h,068h,023h,0F1h,041h,07Ah,0D2h,096h,004h,087h,0D3h,0CFh,0CFh
0052+  A97D EC6C6AE16823F1417AD2960487D3CFCF
0053+  A98D                db 01Bh,078h,02Ah,08Ch,0D4h,068h,0B0h,0B1h,02Dh,07Bh,080h,090h,002h,0C8h,058h,016h
0053+  A98D 1B782A8CD468B0B12D7B809002C85816
0054+  A99D                db 062h,06Eh,0DAh,068h,078h,0B8h,04Bh,061h,06Dh,068h,0B2h,063h,0D1h,078h,07Ch,0B5h
0054+  A99D 626EDA6878B84B616D68B263D1787CB5
0055+  A9AD                db 081h,000h,0E3h,04Ah,02Eh,038h,0E6h,079h,074h,095h,04Fh,076h,06Eh,02Dh,0CCh,000h
0055+  A9AD 8100E34A2E38E67974954F766E2DCC00
0056+  A9BD                db 03Fh,066h,0C7h,087h,046h,082h,0F4h,025h,09Ah,08Dh,016h,034h,092h,084h,048h,086h
0056+  A9BD 3F66C7874682F4259A8D163492844886
0057+  A9CD                db 005h,08Ch,000h,0FBh,004h,06Eh,056h,0CCh,0FCh,0EEh,07Bh,0CDh,07Ch,003h,0F6h,012h
0057+  A9CD 058C00FB046E56CCFCEE7BCD7C03F612
0058+  A9DD                db 060h,08Eh,0C0h,064h,000h,000h,0B6h,077h,0A0h,0B5h,08Bh,0CAh,089h,087h,039h,084h
0058+  A9DD 608EC0640000B677A0B58BCA89873984
0059+  A9ED                db 0BFh,0CDh,077h,009h,010h,0D6h,001h,08Ah,021h,05Bh,089h,018h,023h,082h,083h,092h
0059+  A9ED BFCD770910D6018A215B891823828392
0060+  A9FD                db 088h,0C9h,087h,063h,086h,007h,085h,049h,007h,003h,020h,0CDh,006h,0FDh,0FFh,0DDh
0060+  A9FD 88C9876386078549070320CD06FDFFDD
0061+  AA0D                db 044h,061h,00Bh,010h,069h,08Ch,087h,01Ch,088h,050h,0C3h,01Fh,098h,08Ah,063h,0CAh
0061+  AA0D 44610B10698C871C8850C31F988A63CA
0062+  AA1D                db 0D2h,041h,0C6h,003h,06Fh,079h,0F6h,0EAh,023h,010h,011h,004h,04Eh,046h,00Eh,084h
0062+  AA1D D241C6036F79F6EA231011044E460E84
0063+  AA2D                db 0EEh,0C6h,0B7h,007h,092h,083h,0AAh,043h,0DCh,082h,0D8h,0CDh,0C2h,01Ch,081h,01Ah
0063+  AA2D EEC6B7079283AA43DC82D8CDC21C811A
0064+  AA3D                db 01Dh,090h,0B9h,047h,0C3h,093h,087h,02Bh,006h,0E5h,0E0h,0D0h,0E7h,084h,037h,018h
0064+  AA3D 1D90B947C393872B06E5E0D0E7843718
0065+  AA4D                db 038h,082h,0B1h,0FFh,002h,004h,00Fh,06Fh,0ADh,02Fh,0D5h,005h,06Eh,071h,0B1h,06Dh
0065+  AA4D 3882B1FF02040F6FAD2FD5056E71B16D
0066+  AA5D                db 0A4h,0BFh,01Bh,043h,008h,000h,001h
0066+  AA5D A4BF1B43080001
0244   AA64             MUSIC1:		db 0x03,0x0B,0x0B,0x03,0x03,0x03,0,0x03,0x01,0x01,0x03,0,0,0,0,0
0244   AA64 030B0B03030300030101030000000000
0245   AA74             			INCLUDE	"audio\music3.asm"
0001+  AA74                ;  04 DDBGM2.new.pt3, without 100 bytes of header, compressed by Mizer
0002+  AA74                db 010h,021h,042h,014h,052h,031h,000h,000h,032h,041h,024h,035h,054h,015h,087h,0A9h
0002+  AA74 102142145231000032412435541587A9
0003+  AA84                db 001h,001h,012h,011h,023h,052h,025h,064h,000h,031h,0E8h,003h,016h,000h,0E0h,0A8h
0003+  AA84 01011211235225640031E8031600E0A8
0004+  AA94                db 09Dh,036h,00Ch,068h,06Bh,09Ah,0DCh,05Eh,006h,00Dh,030h,0B5h,05Ah,0ADh,06Ch,076h
0004+  AA94 9D360C686B9ADC5E060D30B55AAD6C76
0005+  AAA4                db 06Bh,0B8h,0FAh,058h,000h,00Ch,081h,004h,080h,00Eh,08Ah,017h,003h,006h,009h,0FFh
0005+  AAA4 6BB8FA58000C8104800E8A17030609FF
0006+  AAB4                db 00Ch,00Fh,012h,015h,018h,01Bh,01Eh,021h,0FFh,024h,027h,02Ah,02Dh,030h,033h,036h
0006+  AAB4 0C0F1215181B1E21FF24272A2D303336
0007+  AAC4                db 039h,0FDh,03Ch,03Fh,0FFh,064h,001h,07Ah,06Bh,09Fh,0A5h,05Ah,0BAh,0D6h,0FAh,0FEh
0007+  AAC4 39FD3C3FFF64017A6B9FA55ABAD6FAFE
0008+  AAD4                db 0BDh,013h,002h,038h,06Bh,03Ch,051h,05Ah,09Bh,0D6h,0B3h,0C6h,0B9h,027h,003h,01Dh
0008+  AAD4 BD1302386B3C515A9BD6B3C6B927031D
0009+  AAE4                db 072h,0B3h,0D3h,013h,01Eh,0D4h,004h,07Eh,08Eh,0C9h,0DEh,026h,005h,070h,0B5h,083h
0009+  AAE4 72B3D3131ED4047E8EC9DE260570B583
0010+  AAF4                db 0ADh,0D7h,0EEh,07Ah,001h,006h,055h,0D6h,07Dh,090h,0B5h,0E4h,0AFh,0FBh,00Eh,007h
0010+  AAF4 ADD7EE7A010655D67D90B5E4AFFB0E07
0011+  AB04                db 063h,052h,08Fh,09Dh,06Dh,0F0h,07Ah,011h,008h,024h,0D4h,078h,047h,037h,0A1h,025h
0011+  AB04 63528F9D6DF07A110824D4784737A125
0012+  AB14                db 006h,0B4h,0DEh,012h,009h,04Ch,0B5h,062h,0ADh,09Bh,0A8h,06Bh,0BDh,006h,0D6h,00Ah
0012+  AB14 06B4DE12094CB562AD9BA86BBD06D60A
0013+  AB24                db 011h,036h,0B5h,09Ah,0ADh,0ADh,0D0h,07Ah,033h,00Bh,03Eh,0D6h,061h,0C3h,0A4h,0BBh
0013+  AB24 1136B59AADADD07A330B3ED661C3A4BB
0014+  AB34                db 0D4h,04Ah,03Fh,0DAh,0C8h,0B1h,0FFh,004h,077h,074h,06Fh,079h,076h,072h,07Bh,075h
0014+  AB34 D44A3FDAC8B1FF0477746F7976727B75
0015+  AB44                db 0C9h,069h,08Ah,011h,039h,000h,0D4h,0CDh,045h,0D6h,05Ch,0D5h,0D6h,0E7h,002h,066h
0015+  AB44 C9698A113900D4CD45D65CD5D6E70266
0016+  AB54                db 073h,068h,0B9h,0CAh,0BDh,001h,0AAh,0C0h,0CAh,0D7h,016h,06Fh,0DBh,0E8h,010h,00Fh
0016+  AB54 7368B9CABD01AAC0CAD7166FDBE8100F
0017+  AB64                db 000h,0D3h,0C6h,0B1h,0DCh,040h,083h,0C1h,0CAh,019h,0B0h,0CBh,076h,06Eh,05Ah,0DBh
0017+  AB64 00D3C6B1DC4083C1CA19B0CB766E5ADB
0018+  AB74                db 053h,04Ah,002h,0CCh,06Dh,062h,069h,08Fh,072h,064h,031h,0A1h,01Bh,0BAh,05Ah,0C0h
0018+  AB74 534A02CC6D62698F726431A11BBA5AC0
0019+  AB84                db 0A9h,02Ch,0A0h,0E6h,058h,0D5h,076h,068h,068h,092h,0D7h,089h,076h,065h,003h,081h
0019+  AB84 A92CA0E658D576686892D78976650381
0020+  AB94                db 022h,065h,000h,098h,0B6h,082h,0CCh,008h,0FAh,0CDh,00Eh,0F8h,0AEh,08Ah,01Eh,09Ch
0020+  AB94 22650098B682CC08FACD0EF8AE8A1E9C
0021+  ABA4                db 0F6h,0C0h,0A0h,04Eh,09Ch,06Ch,0BBh,080h,060h,0CEh,08Ch,0B8h,0CFh,003h,053h,037h
0021+  ABA4 F6C0A04E9C6CBB8060CE8CB8CF035337
0022+  ABB4                db 0D1h,0CEh,093h,0D5h,0A6h,0B8h,0ADh,0CBh,0CCh,04Ah,0CBh,0D7h,033h,0CBh,074h,02Ch
0022+  ABB4 D1CE93D5A6B8ADCBCC4ACBD733CB742C
0023+  ABC4                db 003h,023h,091h,06Fh,0B0h,0AAh,064h,06Dh,0B6h,0E5h,01Ch,07Eh,0C7h,05Eh,0D0h,0C8h
0023+  ABC4 0323916FB0AA646DB6E51C7EC75ED0C8
0024+  ABD4                db 0B5h,0C9h,0ADh,0CAh,0CBh,06Bh,0CCh,0CDh,052h,0EDh,0B6h,008h,000h,009h,02Bh,005h
0024+  ABD4 B5C9ADCACB6BCCCD52EDB60800092B05
0025+  ABE4                db 095h,01Eh,089h,0E7h,0D1h,0CFh,01Dh,063h,02Ah,07Ch,064h,0D5h,0CDh,068h,096h,066h
0025+  ABE4 951E89E7D1CF1D632A7C64D5CD689666
0026+  ABF4                db 045h,088h,060h,09Eh,049h,06Bh,016h,04Dh,0D1h,00Ah,066h,048h,0E5h,068h,0D5h,054h
0026+  ABF4 4588609E496B164DD10A6648E568D554
0027+  AC04                db 063h,0A7h,086h,064h,055h,02Fh,0C0h,091h,01Ah,035h,058h,08Eh,0C9h,0C4h,0F2h,0B8h
0027+  AC04 63A78664552FC0911A35588EC9C4F2B8
0028+  AC14                db 00Dh,048h,0CFh,0D4h,061h,04Ah,011h,05Ch,000h,0C1h,09Fh,087h,0EBh,0C2h,0D0h,0C3h
0028+  AC14 0D48CFD4614A115C00C19F87EBC2D0C3
0029+  AC24                db 0C4h,05Ah,0C5h,0D6h,0C6h,0C7h,02Ah,056h,0B1h,011h,046h,051h,049h,064h,0F3h,035h
0029+  AC24 C45AC5D6C6C72A56B11146514964F335
0030+  AC34                db 099h,0C4h,0E9h,057h,0C1h,080h,080h,0A2h,028h,0EFh,058h,02Ch,09Bh,00Bh,0F7h,096h
0030+  AC34 99C4E957C18080A228EF582C9B0BF796
0031+  AC44                db 05Eh,072h,05Fh,05Ah,0C5h,064h,022h,026h,0D8h,003h,00Dh,079h,063h,023h,064h,03Bh
0031+  AC44 5E725F5AC5642226D8030D796323643B
0032+  AC54                db 0CAh,05Fh,078h,061h,065h,052h,0C0h,0F9h,011h,0A3h,054h,0F0h,039h,039h,001h,02Eh
0032+  AC54 CA5F78616552C0F911A354F03939012E
0033+  AC64                db 036h,061h,0DCh,06Ah,08Ah,0F0h,08Ch,015h,0BCh,08Ah,006h,06Fh,05Ah,02Ch,09Bh,00Bh
0033+  AC64 3661DC6A8AF08C15BC8A066F5A2C9B0B
0034+  AC74                db 0F7h,09Eh,061h,05Ch,02Dh,062h,066h,091h,013h,06Ch,003h,015h,0E4h,06Dh,08Bh,005h
0034+  AC74 F79E615C2D626691136C0315E46D8B05
0035+  AC84                db 079h,065h,0E7h,0C0h,04Bh,08Dh,054h,0D1h,0C0h,063h,01Ah,035h,058h,08Eh,0C9h,0C8h
0035+  AC84 7965E7C04B8D54D1C0631A35588EC9C8
0036+  AC94                db 077h,004h,0D5h,0A1h,0A9h,061h,029h,0A2h,063h,0B4h,085h,005h,06Dh,083h,001h,08Bh
0036+  AC94 7704D5A1A96129A263B485056D83018B
0037+  ACA4                db 000h,07Bh,0ADh,05Ch,07Bh,0CEh,078h,023h,0E9h,068h,09Bh,00Bh,044h,01Ch,062h,0D4h
0037+  ACA4 007BAD5C7BCE7823E9689B0B441C62D4
0038+  ACB4                db 05Fh,030h,093h,06Ch,098h,054h,01Eh,045h,011h,022h,06Fh,0E2h,0F4h,06Ch,055h,0D8h
0038+  ACB4 5F30936C98541E4511226FE2F46C55D8
0039+  ACC4                db 082h,00Ch,0D7h,04Ah,0DEh,019h,01Ch,01Fh,091h,0BEh,0D9h,0CFh,079h,077h,05Bh,04Fh
0039+  ACC4 820CD74ADE191C1F91BED9CF79775B4F
0040+  ACD4                db 076h,092h,01Bh,080h,07Bh,0C9h,082h,00Ch,083h,062h,044h,03Fh,000h,0D4h,09Fh,0CEh
0040+  ACD4 76921B807BC9820C8362443F00D49FCE
0041+  ACE4                db 03Ch,0EBh,0D8h,0D6h,02Fh,040h,0EEh,07Dh,03Bh,074h,066h,02Fh,0C9h,0F0h,0D4h,01Eh
0041+  ACE4 3CEBD8D62F40EE7D3B74662FC9F0D41E
0042+  ACF4                db 035h,0D4h,05Fh,0D5h,021h,0ACh,0CFh,0A1h,099h,072h,000h,0D9h,047h,01Ah,077h,025h
0042+  ACF4 35D45FD521ACCFA1997200D9471A7725
0043+  AD04                db 05Ah,076h,0AEh,033h,00Eh,074h,016h,046h,065h,08Ah,07Bh,067h,079h,0C8h,074h,082h
0043+  AD04 5A76AE330E741646658A7B6779C87482
0044+  AD14                db 063h,083h,012h,021h,0E3h,099h,0CDh,055h,09Fh,061h,0B9h,0D5h,00Eh,0EDh,0F9h,0BBh
0044+  AD14 63831221E399CD559F61B9D50EEDF9BB
0045+  AD24                db 001h,0E3h,053h,099h,087h,035h,07Ah,04Fh,02Eh,02Fh,020h,07Ch,0D3h,0CBh,071h,001h
0045+  AD24 01E3539987357A4F2E2F207CD3CB7101
0046+  AD34                db 0C2h,096h,098h,003h,094h,060h,040h,06Ch,093h,008h,00Dh,091h,081h,001h,01Dh,013h
0046+  AD34 C29698039460406C93080D9181011D13
0047+  AD44                db 076h,082h,021h,08Ch,083h,048h,087h,08Eh,089h,05Ah,037h,01Bh,066h,0D5h,090h,0EEh
0047+  AD44 7682218C8348878E895A371B66D590EE
0048+  AD54                db 01Fh,09Ch,060h,00Eh,09Ah,09Dh,061h,043h,09Ah,0C9h,05Eh,0A3h,0CCh,012h,07Eh,055h
0048+  AD54 1F9C600E9A9D61439AC95EA3CC127E55
0049+  AD64                db 07Ch,0AAh,0E3h,00Eh,07Bh,031h,064h,062h,028h,0F5h,078h,0BBh,048h,063h,083h,012h
0049+  AD64 7CAAE30E7B31646228F578BB48638312
0050+  AD74                db 04Bh,00Bh,033h,09Bh,057h,03Fh,063h,0D5h,072h,01Dh,09Eh,0FCh,0DDh,081h,063h,059h
0050+  AD74 4B0B339B573F63D5721D9EFCDD816359
0051+  AD84                db 05Bh,09Ah,0EEh,067h,0D5h,043h,09Ah,0BFh,002h,0B9h,0D0h,0F8h,066h,0ECh,0B8h,0FCh
0051+  AD84 5B9AEE67D5439ABF02B9D0F866ECB8FC
0052+  AD94                db 006h,07Bh,0D3h,0C9h,0F8h,029h,083h,0FDh,085h,087h,088h,08Ah,08Ch,08Eh,0EEh,008h
0052+  AD94 067BD3C9F82983FD8587888A8C8EEE08
0053+  ADA4                db 093h,0FCh,0FCh,0AAh,06Ch,003h,0E9h,0A7h,03Ch,0CAh,07Bh,079h,0B8h,076h,03Ah,00Ch
0053+  ADA4 93FCFCAA6C03E9A73CCA7B79B8763A0C
0054+  ADB4                db 00Eh,032h,008h,001h,0CEh,0F6h,08Fh,060h,0E3h,063h,0CBh,0E7h,095h,0E7h,079h,02Ch
0054+  ADB4 0E320801CEF68F60E363CBE795E7792C
0055+  ADC4                db 09Eh,008h,0F3h,031h,0D1h,04Ch,0D3h,09Bh,018h,0D2h,037h,0E1h,077h,0D9h,0F6h,074h
0055+  ADC4 9E08F331D14CD39B18D237E177D9F674
0056+  ADD4                db 082h,043h,083h,018h,091h,00Fh,01Ch,0F2h,058h,06Dh,08Dh,064h,0D5h,0C8h,076h,0C3h
0056+  ADD4 82438318910F1CF2586D8D64D5C876C3
0057+  ADE4                db 0F3h,084h,001h,0D3h,053h,0D7h,0B5h,006h,0A8h,01Eh,0FBh,045h,077h,0BEh,0C0h,06Bh
0057+  ADE4 F38401D353D7B506A81EFB4577BEC06B
0058+  ADF4                db 07Bh,08Eh,0B8h,012h,0A2h,056h,089h,01Ah,0D4h,0ADh,074h,052h,0FEh,0B2h,072h,07Ch
0058+  ADF4 7B8EB812A256891AD4AD7452FEB2727C
0059+  AE04                db 07Ch,07Bh,093h,08Eh,079h,08Bh,063h,00Dh,0D7h,019h,06Dh,034h,07Dh,07Dh,0B2h,06Ah
0059+  AE04 7C7B938E798B630DD7196D347D7DB26A
0060+  AE14                db 003h,0C0h,098h,0DCh,05Bh,002h,0F5h,0CBh,041h,032h,0F1h,098h,0C9h,0D4h,04Eh,045h
0060+  AE14 03C098DC5B02F5CB4132F198C9D44E45
0061+  AE24                db 0BFh,0A6h,062h,062h,042h,07Ch,070h,06Dh,047h,079h,066h,0D1h,0D3h,005h,0F2h,058h
0061+  AE24 BFA66262427C706D477966D1D305F258
0062+  AE34                db 0DAh,0D3h,057h,0F2h,03Ah,000h,079h,084h,00Eh,06Ch,014h,076h,0E9h,047h,0B4h,040h
0062+  AE34 DAD357F23A0079840E6C1476E947B440
0063+  AE44                db 063h,060h,08Ch,0E3h,008h,087h,0DCh,085h,002h,07Fh,010h,08Ch,001h,034h,000h,0F1h
0063+  AE44 63608CE30887DC85027F108C013400F1
0064+  AE54                db 0FFh,032h,04Ah,080h,0CAh,013h,094h,0BDh,0D1h,05Ch,0DBh,0A1h,065h,0D6h,00Ah,05Bh
0064+  AE54 FF324A80CA1394BDD15CDBA165D60A5B
0065+  AE64                db 0D9h,007h,096h,08Fh,017h,08Eh,0D1h,03Fh,0FAh,0B2h,05Ch,0C9h,0A1h,0B9h,0C0h,0CAh
0065+  AE64 D907968F178ED13FFAB25CC9A1B9C0CA
0066+  AE74                db 00Ch,0CBh,086h,0CCh,043h,0CDh,021h,08Ch,0D4h,054h,0D8h,0A1h,017h,05Bh,0A2h,0C0h
0066+  AE74 0CCB86CC43CD218CD454D8A1175BA2C0
0067+  AE84                db 0F9h,08Ch,087h,08Fh,08Eh,010h,0B9h,064h,000h,0A7h,013h,083h,07Fh,08Ah,0CDh,001h
0067+  AE84 F98C878F8E10B96400A713837F8ACD01
0068+  AE94                db 03Bh,0FCh,087h,047h,085h,0E5h,084h,0D6h,0CCh,0D1h,05Ah,03Ch,004h,009h,0E0h,032h
0068+  AE94 3BFC874785E584D6CCD15A3C0409E032
0069+  AEA4                db 008h,08Eh,0CDh,067h,08Ch,0D1h,0FDh,064h,058h,05Fh,09Ch,067h,0C0h,0CEh,0EFh,069h
0069+  AEA4 088ECD678CD1FD64585F9C67C0CEEF69
0070+  AEB4                db 04Ch,0EAh,0CFh,010h,051h,0E3h,0F4h,03Dh,021h,03Fh,063h,0D0h,0F2h,021h,020h,022h
0070+  AEB4 4CEACF1051E3F43D213F63D0F2212022
0071+  AEC4                db 0DDh,06Fh,0CEh,06Bh,00Fh,08Ah,085h,02Eh,032h,021h,00Bh,0ECh,0D2h,0CBh,0A1h,03Ah
0071+  AEC4 DD6FCE6B0F8A852E32210BECD2CBA13A
0072+  AED4                db 0D5h,093h,087h,0F9h,086h,006h,085h,084h,0E3h,065h,0D6h,045h,0C3h,060h,021h,0FCh
0072+  AED4 D59387F986068584E365D645C36021FC
0073+  AEE4                db 060h,039h,0D0h,0A3h,022h,0D1h,0EBh,05Fh,0D4h,068h,0D6h,056h,080h,06Ah,085h,0CAh
0073+  AEE4 6039D0A322D1EB5FD468D656806A85CA
0074+  AEF4                db 059h,002h,08Fh,0E8h,0FEh,0F7h,0FFh,017h,02Ch,077h,002h,08Ah,091h,04Bh,083h,030h
0074+  AEF4 59028FE8FEF7FF172C77028A914B8330
0075+  AF04                db 0C0h,0D0h,0B0h,09Ah,083h,0D6h,05Ah,0D8h,0BCh,050h,027h,01Eh,01Ch,0E8h,03Ch,07Fh
0075+  AF04 C0D0B09A83D65AD8BC50271E1CE83C7F
0076+  AF14                db 064h,066h,0D6h,02Eh,080h,01Dh,052h,0D4h,06Ah,087h,0D0h,003h,0D5h,040h,003h,0ECh
0076+  AF14 6466D62E801D52D46A87D003D54003EC
0077+  AF24                db 0FCh,001h,0E7h,0D1h,067h,0C0h,027h,09Eh,080h,001h,0CAh,0E2h,0CAh,0DEh,009h,00Ch
0077+  AF24 FC01E7D167C0279E8001CAE2CADE090C
0078+  AF34                db 001h,08Ah,0E1h,01Bh,089h,022h,006h,016h,00Eh,01Ch,088h,0C3h,098h,087h,070h,086h
0078+  AF34 018AE11B892206160E1C88C398877086
0079+  AF44                db 0A1h,0D8h,085h,000h,0EBh,0E1h,00Bh,010h,08Ah,033h,0B6h,085h,047h,068h,097h,005h
0079+  AF44 A1D88500EBE10B108A33B68547689705
0080+  AF54                db 06Bh,0B4h,033h,03Dh,04Ch,038h,003h,054h,05Ch,0FDh,0FFh,088h,0C4h,0DCh,009h,00Ah
0080+  AF54 6BB4333D4C3803545CFDFF88C4DC090A
0081+  AF64                db 0ECh,08Fh,028h,012h,01Ah,001h,0D0h,0F2h,001h,090h,021h,0A5h,0C3h,00Eh,037h,054h
0081+  AF64 EC8F28121A01D0F2019021A5C30E3754
0082+  AF74                db 03Bh,0D0h,070h,0C1h,012h,0E6h,00Ch,035h,0C8h,083h,053h,00Ch,00Eh,025h,0FDh,002h
0082+  AF74 3BD070C112E60C35C883530C0E25FD02
0083+  AF84                db 004h,00Fh,06Fh,02Fh,0CEh,005h,06Eh,0D2h,06Ch,06Dh,089h,0BFh,069h,08Bh,0ADh,002h
0083+  AF84 040F6F2FCE056ED26C6D89BF698BAD02
0084+  AF94                db 00Dh,0C1h,089h,036h,09Ch,010h,03Eh,049h,018h,0B0h,040h,0C1h,0F2h,0ECh,085h,028h
0084+  AF94 0DC189369C103E4918B040C1F2EC8528
0085+  AFA4                db 075h,084h,030h,0E6h,003h,018h,087h,09Eh,02Fh,06Bh,010h,0D9h,0E3h,04Bh,005h,05Ch
0085+  AFA4 758430E60318879E2F6B10D9E34B055C
0086+  AFB4                db 061h,083h,0B2h,0C6h,0B8h,0C3h,0A9h,083h,086h,06Ch,0F6h,088h,079h,0B3h,0DAh,0C4h
0086+  AFB4 6183B2C6B8C3A983866CF68879B3DAC4
0087+  AFC4                db 004h,0A1h,091h,054h,000h,001h
0087+  AFC4 04A191540001
0246   AFCA             MUSIC2:		db 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
0246   AFCA 000102030405060708090A0B0C0D0E0F
0247   AFDA             			INCLUDE	"audio\music2.asm"
0001+  AFDA                ;  03 DDAMULET.pt3, without 100 bytes of header, compressed by Mizer
0002+  AFDA                db 000h,010h,011h,033h,020h,020h,000h,000h,010h,030h,001h,042h,013h,020h,013h,065h
0002+  AFDA 00101133202000001030014213201365
0003+  AFEA                db 001h,000h,003h,000h,023h,004h,050h,058h,001h,030h,0E0h,003h,005h,004h,0C8h,0CFh
0003+  AFEA 01000300230450580130E0030504C8CF
0004+  AFFA                db 000h,03Ah,02Eh,002h,070h,06Dh,0B6h,0C8h,067h,080h,0C2h,0F2h,006h,074h,000h,010h
0004+  AFFA 003A2E02706DB6C86780C2F206740010
0005+  B00A                db 0C0h,010h,003h,005h,0F6h,003h,08Fh,006h,009h,0FFh,0E7h,075h,012h,0D3h,001h,040h
0005+  B00A C0100305F6038F0609FFE77512D30140
0006+  B01A                db 06Dh,06Bh,08Ah,05Bh,0DFh,013h,002h,0A6h,01Ah,023h,0D0h,02Ah,0C5h,0D2h,0FFh,0CFh
0006+  B01A 6D6B8A5BDF1302A61A23D02AC5D2FFCF
0007+  B02A                db 0B1h,003h,057h,063h,06Fh,07Bh,087h,0FFh,08Ch,080h,074h,068h,067h,073h,07Fh,08Bh
0007+  B02A B10357636F7B87FF8C80746867737F8B
0008+  B03A                db 0EDh,0CDh,0B1h,001h,0C0h,091h,0CBh,091h,0C9h,091h,0C7h,091h,0C5h,091h,0C3h,0AEh
0008+  B03A EDCDB101C091CB91C991C791C591C3AE
0009+  B04A                db 0C1h,0B1h,004h,0E2h,000h,064h,060h,0ABh,05Ch,068h,0FFh,074h,080h,08Ch,087h,07Bh
0009+  B04A C1B104E2006460AB5C68FF74808C877B
0010+  B05A                db 06Fh,063h,06Ah,0E3h,076h,082h,08Eh,04Ch,071h,04Eh,029h,0C5h,038h,0A7h,014h,0E2h
0010+  B05A 6F636AE376828E4C714E29C538A714E2
0011+  B06A                db 09Ah,081h,0A8h,002h,075h,05Eh,00Ah,012h,059h,0CFh,064h,06Fh,07Ch,08Ch,087h,0D8h
0011+  B06A 9A81A802755E0A1259CF646F7C8C87D8
0012+  B07A                db 0DAh,09Bh,053h,06Ah,06Dh,04Dh,0A9h,0B5h,0CDh,0B1h,005h,08Ch,06Fh,002h,083h,082h
0012+  B07A DA9B536A6D4DA9B5CDB1058C6F028382
0013+  B08A                db 080h,021h,090h,07Fh,0E2h,07Ch,07Bh,02Bh,079h,03Bh,026h,0B4h,082h,08Bh,079h,000h
0013+  B08A 8021907FE27C7B2B793B26B4828B7900
0014+  B09A                db 0D4h,0A0h,0F3h,004h,068h,0D3h,0CAh,0BDh,0BDh,06Fh,09Dh,0C9h,09Eh,05Ch,0CBh,09Ch
0014+  B09A D4A0F30468D3CABDBD6F9DC99E5CCB9C
0015+  B0AA                db 0C0h,0CDh,088h,0F7h,0BEh,063h,0D9h,0CAh,074h,0D3h,02Eh,0F9h,0D4h,0CBh,08Ah,0FEh
0015+  B0AA C0CD88F7BE63D9CA74D32EF9D4CB8AFE
0016+  B0BA                db 0CDh,091h,085h,061h,018h,04Fh,0A6h,074h,055h,009h,0B9h,061h,0AAh,022h,03Dh,0B1h
0016+  B0BA CD918561184FA6745509B961AA223DB1
0017+  B0CA                db 071h,09Dh,076h,0A4h,063h,00Fh,088h,0F6h,0CBh,033h,0CCh,000h,0D1h,0B8h,006h,08Ch
0017+  B0CA 719D76A4630F88F6CB33CC00D1B8068C
0018+  B0DA                db 0A5h,08Fh,021h,029h,0ACh,022h,02Bh,08Bh,015h,062h,0CAh,059h,042h,058h,08Fh,0ABh
0018+  B0DA A58F2129AC222B8B1562CA5942588FAB
0019+  B0EA                db 016h,052h,0CAh,012h,0E7h,08Eh,08Bh,0A1h,035h,004h,087h,0BFh,02Ch,01Dh,00Fh,0B0h
0019+  B0EA 1652CA12E78E8BA1350487BF2C1D0FB0
0020+  B0FA                db 027h,005h,088h,08Ch,066h,0B6h,03Fh,0D0h,0CFh,009h,010h,0ACh,0FEh,0DAh,089h,048h
0020+  B0FA 2705888C66B63FD0CF0910ACFEDA8948
0021+  B10A                db 011h,0B0h,01Ah,051h,088h,028h,087h,094h,086h,019h,052h,085h,025h,003h,012h,051h
0021+  B10A 11B01A51882887948619528525031251
0022+  B11A                db 02Ch,0FDh,0FFh,092h,0B6h,010h,011h,030h,081h,0C6h,001h,0D4h,00Ch,0A0h,084h,034h
0022+  B11A 2CFDFF92B610113081C601D40CA08434
0023+  B12A                db 0A2h,083h,050h,082h,065h,081h,012h,092h,090h,0FBh,002h,004h,00Fh,06Fh,02Fh,09Dh
0023+  B12A A28350826581129290FB02040F6F2F9D
0024+  B13A                db 005h,06Eh,08Ah,0C9h,06Dh,044h,0BFh,0B3h,009h,00Ah,0CEh,0F5h,028h,00Bh,0F9h,040h
0024+  B13A 056E8AC96D44BFB3090ACEF5280BF940
0025+  B14A                db 002h,041h,0EFh,003h,007h,0C7h,00Fh,06Ah,071h,06Bh,0DCh,06Ch,016h,0C5h,0C8h,00Ch
0025+  B14A 0241EF0307C70F6A716BDC6C16C5C80C
0026+  B15A 89 A4 00 01    db 089h,0A4h,000h,001h
0248   B15E             MUSIC3:		db 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
0248   B15E 000102030405060708090A0B0C0D0E0F
0249   B16E             			INCLUDE	"audio\music1.asm"
0001+  B16E                ;  02 DDBGM1.pt3, without 100 bytes of header, compressed by Mizer
0002+  B16E                db 010h,011h,042h,034h,003h,003h,043h,000h,022h,031h,032h,043h,065h,054h,074h,089h
0002+  B16E 10114234030343002231324365547489
0003+  B17E                db 021h,000h,010h,010h,043h,015h,054h,060h,011h,021h,0EAh,005h,00Eh,000h,0D8h,048h
0003+  B17E 21001010431554601121EA050E00D848
0004+  B18E                db 01Eh,0DBh,006h,00Dh,007h,043h,0D7h,02Bh,055h,021h,0C6h,005h,07Fh,0DAh,0C1h,069h
0004+  B18E 1EDB060D0743D72B5521C6057FDAC169
0005+  B19E                db 0D3h,0DEh,015h,008h,001h,090h,038h,057h,008h,05Ah,009h,039h,0FCh,003h,006h,009h
0005+  B19E D3DE150801903857085A0939FC030609
0006+  B1AE                db 00Ch,00Fh,021h,07Fh,012h,015h,0FFh,008h,001h,04Ch,04Dh,0ABh,034h,0D7h,0D3h,0F0h
0006+  B1AE 0C0F217F1215FF08014C4DAB34D7D3F0
0007+  B1BE                db 045h,0D3h,002h,072h,08Fh,04Dh,0E0h,03Dh,00Bh,003h,02Eh,034h,088h,0D3h,0ACh,0D3h
0007+  B1BE 45D302728F4DE03D0B032E3488D3ACD3
0008+  B1CE                db 04Fh,029h,004h,083h,04Dh,0A9h,034h,0FFh,0F4h,057h,005h,096h,0D3h,0F3h,016h,0D3h
0008+  B1CE 4F2904834DA934FFF4570596D3F316D3
0009+  B1DE                db 006h,055h,0B8h,04Fh,0D9h,041h,0CFh,0E8h,0B1h,001h,070h,05Dh,005h,044h,055h,0C0h
0009+  B1DE 0655B84FD941CFE8B101705D054455C0
0010+  B1EE                db 063h,003h,073h,016h,075h,021h,07Ah,002h,077h,07Ch,064h,073h,01Ch,070h,06Bh,09Dh
0010+  B1EE 6303731675217A02777C64731C706B9D
0011+  B1FE                db 06Eh,041h,04Ch,0A8h,06Ah,0E0h,071h,0CDh,0FAh,002h,075h,07Ah,064h,071h,01Fh,06Eh
0011+  B1FE 6E414CA86AE071CDFA02757A64711F6E
0012+  B20E                db 069h,000h,0D4h,0C9h,041h,0CEh,0FFh,056h,0D5h,058h,0DAh,0CAh,0B1h,070h,0F7h,070h
0012+  B20E 6900D4C941CEFF56D558DACAB170F770
0013+  B21E                db 0D4h,064h,089h,065h,079h,0D6h,041h,064h,010h,08Ch,059h,097h,05Bh,0ACh,054h,08Ch
0013+  B21E D464896579D64164108C59975BAC548C
0014+  B22E                db 056h,0AEh,0BFh,062h,008h,08Eh,014h,042h,032h,0D8h,012h,016h,051h,09Eh,02Bh,01Ch
0014+  B22E 56AEBF62088E144232D81216519E2B1C
0015+  B23E                db 088h,069h,09Ah,032h,079h,0F0h,06Eh,0D1h,089h,0AEh,000h,0D9h,072h,047h,00Eh,088h
0015+  B23E 88699A3279F06ED189AE00D972470E88
0016+  B24E                db 001h,029h,05Ah,0D0h,0F2h,005h,000h,054h,083h,065h,0C9h,0FDh,0FFh,050h,086h,044h
0016+  B24E 01295AD0F20500548365C9FDFF508644
0017+  B25E                db 071h,00Ch,081h,05Fh,0BEh,072h,073h,075h,000h,0DBh,055h,0CDh,010h,07Ch,05Ah,006h
0017+  B25E 710C815FBE72737500DB55CD107C5A06
0018+  B26E                db 07Fh,0B2h,00Ah,081h,08Fh,07Eh,054h,004h,092h,008h,0F1h,08Ah,0B2h,0FAh,080h,00Dh
0018+  B26E 7FB20A818F7E54049208F18AB2FA800D
0019+  B27E                db 061h,0A0h,01Bh,079h,060h,0D1h,097h,0E6h,072h,0BCh,062h,08Eh,073h,05Dh,00Ah,096h
0019+  B27E 61A01B7960D197E672BC628E735D0A96
0020+  B28E                db 077h,06Dh,070h,0D6h,016h,0A4h,0F6h,0A3h,0A5h,0B2h,09Eh,075h,0DEh,059h,022h,05Ch
0020+  B28E 776D70D616A4F6A3A5B29E75DE59225C
0021+  B29E                db 085h,003h,0BDh,0C5h,0B7h,04Dh,091h,09Ah,07Dh,073h,000h,06Dh,07Eh,0A4h,07Fh,074h
0021+  B29E 8503BDC5B74D919A7D73006D7EA47F74
0022+  B2AE                db 0B0h,083h,0E9h,077h,002h,081h,0D2h,0D3h,04Ah,07Ah,000h,01Ah,080h,0D0h,096h,07Ch
0022+  B2AE B083E9770281D2D34A7A001A80D0967C
0023+  B2BE                db 0D6h,077h,004h,069h,039h,07Fh,083h,088h,02Dh,045h,0D2h,08Ah,065h,012h,074h,08Bh
0023+  B2BE D6770469397F83882D45D28A6512748B
0024+  B2CE                db 001h,0D0h,0A0h,0F6h,0E1h,098h,099h,086h,08Ch,003h,000h,09Ah,010h,073h,0FDh,07Ah
0024+  B2CE 01D0A0F6E19899868C03009A1073FD7A
0025+  B2DE                db 067h,03Bh,095h,03Ah,07Fh,053h,0A7h,001h,0D7h,078h,07Ah,008h,0C9h,07Ch,0CCh,072h
0025+  B2DE 673B953A7F53A701D7787A08C97CCC72
0026+  B2EE                db 081h,05Ch,085h,0B1h,071h,086h,0C0h,0D4h,071h,05Dh,0D5h,05Fh,0C9h,0EEh,0DDh,0D4h
0026+  B2EE 815C85B17186C0D4715DD55FC9EEDDD4
0027+  B2FE                db 08Ch,053h,097h,060h,080h,0AAh,005h,046h,098h,060h,0E0h,067h,01Ah,059h,0F5h,05Bh
0027+  B2FE 8C53976080AA05469860E0671A59F55B
0028+  B30E                db 090h,05Dh,0EFh,0AEh,08Eh,0BCh,05Dh,005h,08Bh,000h,05Bh,017h,065h,085h,086h,0B8h
0028+  B30E 905DEFAE8EBC5D058B005B17658586B8
0029+  B31E                db 02Fh,05Eh,006h,0D2h,05Ch,0C0h,03Eh,04Ah,01Dh,017h,086h,085h,083h,020h,0E9h,081h
0029+  B31E 2F5E06D25CC03E4A1D1786858320E981
0030+  B32E                db 07Eh,07Ah,0DCh,052h,0D7h,088h,092h,02Bh,0BEh,00Ah,08Bh,055h,006h,09Eh,039h,0E2h
0030+  B32E 7E7ADC52D788922BBE0A8B55069E39E2
0031+  B33E                db 018h,0A5h,053h,088h,006h,0EAh,0C8h,0A7h,08Dh,002h,00Bh,0A6h,010h,062h,0F6h,0DBh
0031+  B33E 18A5538806EAC8A78D020BA61062F6DB
0032+  B34E                db 0B6h,0D4h,004h,045h,03Ch,051h,012h,01Ah,010h,06Eh,088h,0E3h,0D6h,061h,024h,065h
0032+  B34E B6D404453C51121A106E88E3D6612465
0033+  B35E                db 06Bh,0F0h,06Dh,088h,0E3h,0D6h,060h,043h,06Ch,0CFh,013h,068h,075h,0B1h,066h,06Eh
0033+  B35E 6BF06D88E3D660436CCF136875B1666E
0034+  B36E                db 049h,000h,0C8h,079h,0D9h,0CCh,034h,07Ch,05Dh,0BAh,03Bh,069h,01Ah,089h,00Eh,0EDh
0034+  B36E 4900C879D9CC347C5DBA3B691A890EED
0035+  B37E                db 07Eh,0DAh,07Ah,07Fh,06Bh,000h,07Dh,052h,09Ch,012h,0CDh,078h,073h,02Bh,074h,09Fh
0035+  B37E 7EDA7A7F6B007D529C12CD78732B749F
0036+  B38E                db 004h,026h,09Eh,000h,09Ch,09Eh,085h,015h,08Ch,059h,00Ah,08Dh,04Bh,0B4h,0F8h,072h
0036+  B38E 04269E009C9E85158C590A8D4BB4F872
0037+  B39E                db 0B1h,0F1h,02Ah,085h,02Ch,08Dh,001h,08Fh,064h,050h,08Ch,05Ch,0FEh,064h,0D5h,066h
0037+  B39E B1F12A852C8D018F64508C5CFE64D566
0038+  B3AE                db 03Ah,066h,0E1h,0D4h,072h,011h,0C7h,0A1h,064h,0E9h,026h,083h,069h,02Bh,063h,012h
0038+  B3AE 3A66E1D47211C7A164E92683692B6312
0039+  B3BE                db 032h,0B5h,0F8h,06Fh,044h,070h,0F5h,02Ch,06Eh,03Dh,04Ah,06Dh,08Bh,0C8h,06Bh,0C1h
0039+  B3BE 32B5F86F4470F52C6E3D4A6D8BC86BC1
0040+  B3CE                db 0F5h,08Ch,075h,073h,07Eh,0ABh,091h,079h,028h,08Dh,044h,08Ch,024h,0EDh,080h,07Ch
0040+  B3CE F58C75737EAB9179288D448C24ED807C
0041+  B3DE                db 081h,000h,0A5h,04Ah,070h,04Bh,034h,07Ah,075h,0ADh,0D3h,0F1h,00Fh,083h,07Ch,000h
0041+  B3DE 8100A54A704B347A75ADD3F10F837C00
0042+  B3EE                db 0DBh,0C8h,041h,0CAh,0E2h,073h,0D4h,04Dh,0F8h,07Ch,0DAh,0C5h,070h,0DBh,0FDh,0EEh
0042+  B3EE DBC841CAE273D44DF87CDAC570DBFDEE
0043+  B3FE                db 007h,02Fh,0F9h,033h,0D0h,07Bh,095h,043h,070h,054h,0C0h,045h,043h,0FAh,07Ah,05Fh
0043+  B3FE 072FF933D07B95437054C04543FA7A5F
0044+  B40E                db 0A1h,003h,074h,047h,064h,0D1h,027h,02Fh,0C0h,0D5h,021h,026h,0D2h,0D5h,0B5h,0DAh
0044+  B40E A103744764D1272FC0D52126D2D5B5DA
0045+  B41E                db 0C7h,008h,0CFh,099h,069h,0A6h,0B2h,08Eh,042h,045h,0DAh,003h,09Ch,0D2h,03Ch,06Fh
0045+  B41E C708CF9969A6B28E4245DA039CD23C6F
0046+  B42E                db 0C7h,03Ch,0AEh,0D4h,002h,04Fh,065h,09Eh,027h,0D8h,008h,0FFh,0C4h,07Dh,0B7h,03Eh
0046+  B42E C73CAED4024F659E27D808FFC47DB73E
0047+  B43E                db 087h,0D8h,085h,02Eh,0C3h,04Ch,008h,05Ah,088h,0CFh,08Bh,001h,01Dh,05Ch,087h,001h
0047+  B43E 87D8852EC34C085A88CF8B011D5C8701
0048+  B44E                db 0F7h,088h,06Bh,000h,00Dh,0E2h,006h,068h,089h,0E6h,000h,005h,0AFh,073h,08Bh,0BEh
0048+  B44E F7886B000DE2066889E60005AF738BBE
0049+  B45E                db 01Fh,06Eh,0DAh,04Ah,0ACh,087h,0FEh,021h,0EFh,000h,009h,00Ch,001h,021h,090h,0B9h
0049+  B45E 1F6EDA4AAC87FE21EF00090C012190B9
0050+  B46E                db 089h,086h,031h,0C0h,098h,073h,088h,00Eh,087h,061h,0C3h,086h,00Eh,085h,04Dh,003h
0050+  B46E 898631C09873880E8761C3860E854D03
0051+  B47E                db 0F6h,007h,00Fh,06Ah,02Fh,0EBh,005h,06Bh,027h,0C8h,06Ch,05Ch,0BFh,06Dh,0C7h,0A8h
0051+  B47E F6070F6A2FEB056B27C86C5CBF6DC7A8
0052+  B48E                db 090h,014h,03Dh,009h,00Ah,0BAh,08Fh,028h,085h,015h,040h,01Fh,00Ch,037h,038h,00Eh
0052+  B48E 90143D090ABA8F288515401F0C37380E
0053+  B49E                db 072h,0FAh,0D2h,021h,0C0h,0C8h,063h,073h,080h,010h,055h,06Ch,003h,0C3h,098h,007h
0053+  B49E 72FAD221C0C863738010556C03C39807
0054+  B4AE                db 062h,033h,0F9h,093h,0FFh,057h,0FDh,002h,0E7h,004h,00Fh,06Fh,06Dh,09Dh,06Eh,096h
0054+  B4AE 6233F993FF57FD02E7040F6F6D9D6E96
0055+  B4BE                db 06Dh,015h,0B7h,00Bh,010h,009h,0E4h,038h,02Ah,0C3h,088h,0ACh,01Ah,041h,00Eh,06Bh
0055+  B4BE 6D15B70B1009E4382AC388AC1A410E6B
0056+  B4CE                db 00Eh,04Dh,038h,0EAh,0E1h,007h,0B5h,038h,0EAh,0CBh,02Ch,003h,021h,069h,00Eh,01Eh
0056+  B4CE 0E4D38EAE107B538EACB2C0321690E1E
0057+  B4DE                db 04Ch,028h,039h,032h,090h,048h,093h,008h,000h,001h
0057+  B4DE 4C283932904893080001
0250   B4E8             MUSIC4:		db 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
0250   B4E8 000102030405060708090A0B0C0D0E0F
0251   B4F8             			INCLUDE	"audio\music4.asm"
0001+  B4F8                ;  05 DDGMOVER.pt3, without 100 bytes of header, compressed by Mizer
0002+  B4F8                db 010h,002h,002h,014h,000h,000h,000h,000h,001h,010h,013h,043h,042h,010h,053h,060h
0002+  B4F8 10020214000000000110134342105360
0003+  B508                db 010h,010h,002h,020h,003h,053h,020h,015h,001h,010h,080h,006h,0F2h,002h,001h,0CCh
0003+  B508 101002200353201501108006F20201CC
0004+  B518                db 000h,00Bh,0DDh,0F7h,01Fh,002h,003h,002h,061h,005h,038h,002h,030h,073h,006h,047h
0004+  B518 000BDDF71F0203026105380230730647
0005+  B528                db 003h,0FFh,0B7h,0D8h,015h,001h,07Dh,04Ch,0BCh,050h,0EBh,0D2h,0CFh,0B1h,0DBh,006h
0005+  B528 03FFB7D815017D4CBC50EBD2CFB1DB06
0006+  B538                db 057h,00Fh,000h,07Bh,070h,080h,07Dh,077h,08Ch,078h,061h,0C5h,082h,07Fh,01Ah,07Ch
0006+  B538 570F007B70807D778C7861C5827F1A7C
0007+  B548                db 0FAh,0CEh,0B1h,002h,07Dh,0FBh,004h,0C0h,0D1h,0CDh,0B2h,00Ch,08Bh,055h,05Ah,001h
0007+  B548 FACEB1027DFB04C0D1CDB20C8B555A01
0008+  B558                db 0DAh,0C0h,009h,0D9h,000h,0D1h,0D6h,003h,05Ch,075h,0D9h,0C9h,0CAh,06Ch,08Ah,065h
0008+  B558 DAC009D900D1D6035C75D9C9CA6C8A65
0009+  B568                db 059h,02Ah,031h,0CAh,001h,023h,06Ch,02Eh,0A8h,0ABh,091h,055h,0D4h,063h,088h,0D4h
0009+  B568 592A31CA01236C2EA8AB9155D46388D4
0010+  B578                db 0E0h,015h,072h,054h,03Ah,08Ch,070h,0B5h,019h,01Ch,067h,07Eh,092h,061h,0CAh,060h
0010+  B578 E01572543A8C70B5191C677E9261CA60
0011+  B588                db 012h,09Fh,031h,0EDh,0CBh,0F9h,007h,073h,0F6h,0D1h,0CBh,003h,0DFh,0F4h,0D2h,0FFh
0011+  B588 129F31EDCBF90773F6D1CB03DFF4D2FF
0012+  B598                db 0E8h,078h,0F7h,092h,084h,0AAh,0D4h,001h,0EEh,0D6h,000h,0E4h,003h,0D0h,0CCh,0CDh
0012+  B598 E878F79284AAD401EED600E403D0CCCD
0013+  B5A8                db 0CBh,04Dh,0CAh,0ADh,0C9h,0C8h,06Bh,0C7h,05Ah,0C6h,0C5h,0D6h,0C4h,0B5h,0C3h,0C2h
0013+  B5A8 CB4DCAADC9C86BC75AC6C5D6C4B5C3C2
0014+  B5B8                db 0ADh,0C1h,0B1h,0FEh,031h,0C0h,000h,009h,010h,001h,08Ah,0E4h,034h,089h,088h,028h
0014+  B5B8 ADC1B1FE31C0000910018AE434898828
0015+  B5C8                db 040h,094h,088h,0CAh,087h,065h,086h,01Ch,0A9h,085h,032h,099h,003h,029h,096h,0FDh
0015+  B5C8 409488CA8765861CA9853299032996FD
0016+  B5D8                db 0FFh,044h,0ADh,00Bh,02Ch,00Bh,0A8h,090h,0B0h,0F3h,02Ch,03Eh,020h,0ECh,098h,03Ah
0016+  B5D8 FF44AD0B2C0BA890B0F32C3E20EC983A
0017+  B5E8                db 0A3h,0B3h,047h,007h,07Bh,096h,0F9h,031h,06Fh,002h,0FEh,004h,00Fh,06Fh,02Fh,000h
0017+  B5E8 A3B347077B96F9316F02FE040F6F2F00
0018+  B5F8                db 005h,06Eh,0C5h,006h,06Dh,045h,0BFh,032h,041h,078h,000h,001h
0018+  B5F8 056EC5066D45BF3241780001
0252   B604             MUSIC5:		db 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
0252   B604 000102030405060708090A0B0C0D0E0F
0253   B614             			INCLUDE	"audio\music5.asm"
0001+  B614                ;  06 DDEND.pt3, without 100 bytes of header, compressed by Mizer
0002+  B614                db 010h,022h,033h,024h,033h,032h,000h,000h,011h,042h,010h,054h,054h,055h,083h,0A8h
0002+  B614 102233243332000011421054545583A8
0003+  B624                db 012h,000h,000h,011h,021h,052h,055h,036h,000h,021h,0EAh,003h,01Eh,000h,0E8h,0A2h
0003+  B624 12000011215255360021EA031E00E8A2
0004+  B634                db 07Dh,0CFh,008h,001h,009h,043h,06Bh,085h,0AFh,05Ah,0D9h,0E5h,003h,00Ah,01Bh,015h
0004+  B634 7DCF080109436B85AF5AD9E5030A1B15
0005+  B644                db 06Bh,027h,06Dh,023h,001h,0B0h,040h,077h,051h,0BBh,003h,006h,0FFh,009h,00Ch,00Fh
0005+  B644 6B276D2301B0407751BB0306FF090C0F
0006+  B654                db 012h,015h,018h,01Bh,01Eh,0C1h,021h,024h,006h,07Fh,027h,02Ah,02Dh,030h,033h,0F5h
0006+  B654 1215181B1EC12124067F272A2D3033F5
0007+  B664                db 0FFh,054h,001h,069h,0ADh,0B8h,0CEh,07Ah,008h,002h,06Dh,0D6h,0A7h,0C8h,0B8h,030h
0007+  B664 FF540169ADB8CE7A08026DD6A7C8B830
0008+  B674                db 003h,0C6h,077h,060h,0EBh,08Bh,0F0h,05Eh,01Fh,004h,041h,0B5h,07Fh,0A9h,0AFh,04Bh
0008+  B674 03C67760EB8BF05E1F0441B57FA9AF4B
0009+  B684                db 0E9h,06Fh,023h,005h,044h,05Ah,0A9h,0D6h,0D4h,0EAh,0BDh,04Eh,006h,068h,06Bh,07Eh
0009+  B684 E96F2305445AA9D6D4EABD4E06686B7E
0010+  B694                db 0A3h,05Ah,0A9h,0D6h,0BEh,0FEh,0BDh,002h,007h,017h,06Bh,03Ch,040h,05Ah,055h,0D6h
0010+  B694 A35AA9D6BEFEBD0207176B3C405A55D6
0011+  B6A4                db 09Fh,0B7h,0B5h,0CAh,0AFh,0D7h,002h,008h,012h,05Ah,01Ah,0D6h,046h,067h,0B5h,081h
0011+  B6A4 9FB7B5CAAFD70208125A1AD64667B581
0012+  B6B4                db 0ADh,0A6h,0AFh,06Bh,0B5h,0BBh,05Ah,0C5h,0D7h,0CAh,0DAh,0C8h,0FBh,0B1h,030h,07Bh
0012+  B6B4 ADA6AF6BB5BB5AC5D7CADAC8FBB1307B
0013+  B6C4                db 0D9h,0CBh,09Bh,001h,06Fh,02Ch,007h,0B7h,0CDh,002h,061h,067h,006h,063h,000h,099h
0013+  B6C4 D9CB9B016F2C07B7CD02616706630099
0014+  B6D4                db 0D4h,086h,05Ch,0C8h,04Ah,0DCh,0D1h,0CEh,043h,005h,073h,004h,0C0h,000h,0A6h,019h
0014+  B6D4 D4865CC84ADCD1CE43057304C000A619
0015+  B6E4                db 0D4h,0CFh,065h,0EEh,061h,0D6h,063h,0D5h,052h,07Eh,064h,0D6h,066h,000h,0D3h,0C6h
0015+  B6E4 D4CF65EE61D663D5527E64D66600D3C6
0016+  B6F4                db 05Ah,0B9h,083h,033h,0C0h,0D9h,089h,0C5h,02Bh,0B2h,009h,0C7h,072h,0B2h,0D6h,01Bh
0016+  B6F4 5AB98333C0D989C52BB209C772B2D61B
0017+  B704                db 064h,0D2h,0DCh,0D7h,074h,049h,01Ah,065h,011h,0A8h,0A6h,012h,076h,08Eh,003h,077h
0017+  B704 64D2DCD774491A6511A8A612768E0377
0018+  B714                db 0CBh,005h,0A0h,062h,0AEh,001h,0CEh,000h,047h,004h,09Ch,068h,081h,0B2h,0D6h,07Bh
0018+  B714 CB05A062AE01CE0047049C6881B2D67B
0019+  B724                db 04Bh,03Bh,0CDh,010h,0D6h,0CFh,050h,0D6h,063h,0D6h,0D4h,007h,0A4h,064h,0D1h,0A6h
0019+  B724 4B3BCD10D6CF50D663D6D407A464D1A6
0020+  B734                db 08Dh,00Ch,09Ah,05Fh,0D6h,083h,052h,06Bh,023h,0CFh,0CFh,05Fh,009h,063h,09Dh,07Bh
0020+  B734 8D0C9A5FD683526B23CFCF5F09639D7B
0021+  B744                db 025h,0A6h,051h,01Ah,08Ah,061h,07Eh,03Ah,04Ch,080h,0ECh,060h,05Ah,08Eh,0C6h,007h
0021+  B744 25A6511A8A617E3A4C80EC605A8EC607
0022+  B754                db 0E8h,0ABh,0C5h,0FBh,010h,074h,07Ch,001h,0F9h,026h,061h,08Dh,034h,068h,0A9h,06Ch
0022+  B754 E8ABC5FB10747C01F926618D3468A96C
0023+  B764                db 011h,024h,05Ch,0B1h,068h,020h,066h,063h,0B6h,09Ah,0DBh,0C0h,036h,0C9h,065h,050h
0023+  B764 11245CB168206663B69ADBC036C96550
0024+  B774                db 02Eh,071h,0F6h,078h,00Eh,0B6h,0B3h,00Ch,088h,027h,06Dh,087h,085h,0B4h,008h,08Bh
0024+  B774 2E71F6780EB6B30C88276D8785B4088B
0025+  B784                db 082h,083h,07Dh,0D0h,045h,0F6h,06Fh,044h,0C2h,036h,007h,0BEh,0E6h,00Ch,080h,0EEh
0025+  B784 82837DD045F66F44C23607BEE60C80EE
0026+  B794                db 091h,07Ch,034h,089h,0D8h,07Bh,000h,0F9h,0C7h,04Dh,05Ch,0D6h,04Dh,002h,0E5h,034h
0026+  B794 917C3489D87B00F9C74D5CD64D02E534
0027+  B7A4                db 016h,083h,06Bh,02Fh,0F0h,06Ah,046h,049h,077h,013h,008h,0D8h,013h,023h,0C7h,051h
0027+  B7A4 16836B2FF06A4649771308D81323C751
0028+  B7B4                db 097h,088h,0A5h,05Ah,083h,0A9h,07Ah,058h,080h,0B8h,0C4h,070h,079h,07Ah,07Bh,076h
0028+  B7B4 9788A55A83A97A5880B8C470797A7B76
0029+  B7C4                db 077h,074h,0CFh,0F2h,014h,0C0h,0D1h,069h,056h,04Dh,0CDh,079h,07Bh,0F2h,0D8h,080h
0029+  B7C4 7774CFF214C0D169564DCD797BF2D880
0030+  B7D4                db 0FAh,03Ah,026h,0ABh,04Fh,064h,0C1h,0DCh,0D1h,0CFh,049h,07Ah,0B9h,015h,068h,030h
0030+  B7D4 FA3A26AB4F64C1DCD1CF497AB9156830
0031+  B7E4                db 0E6h,005h,0D1h,04Bh,059h,061h,087h,0D4h,0CEh,023h,02Ah,0EDh,064h,0BFh,0D5h,066h
0031+  B7E4 E605D14B596187D4CE232AED64BFD566
0032+  B7F4                db 06Eh,0D6h,067h,0C1h,064h,09Fh,086h,087h,0D9h,0C9h,064h,092h,063h,0E3h,074h,076h
0032+  B7F4 6ED667C1649F8687D9C9649263E37476
0033+  B804                db 04Ah,022h,088h,09Bh,0F9h,0D1h,0CEh,077h,076h,0CBh,03Ch,07Fh,083h,0D9h,0CCh,0F5h
0033+  B804 4A22889BF9D1CE7776CB3C7F83D9CCF5
0034+  B814                db 0D0h,09Eh,05Ch,0B9h,024h,06Ch,026h,038h,077h,0F8h,0C8h,0D4h,053h,009h,079h,0EDh
0034+  B814 D09E5CB9246C263877F8C8D4530979ED
0035+  B824                db 0DCh,07Bh,0E5h,0A0h,05Ah,083h,0F3h,0F4h,080h,06Dh,025h,061h,01Ah,08Ah,061h,082h
0035+  B824 DC7BE5A05A83F3F4806D25611A8A6182
0036+  B834                db 036h,049h,083h,0BBh,080h,0B5h,007h,077h,047h,077h,0EBh,082h,036h,004h,08Eh,03Dh
0036+  B834 364983BB80B507774777EB8236048E3D
0037+  B844                db 076h,080h,010h,003h,0BEh,0A5h,005h,006h,0EFh,0ACh,06Bh,015h,0D6h,0B1h,080h,0FAh
0037+  B844 76801003BEA50506EFAC6B15D6B180FA
0038+  B854                db 0D4h,08Dh,081h,02Dh,04Fh,017h,05Bh,00Ch,061h,098h,093h,0DEh,069h,0B2h,0CAh,07Eh
0038+  B854 D48D812D4F175B0C619893DE69B2CA7E
0039+  B864                db 0E5h,010h,0B2h,079h,008h,07Ah,0F4h,0F3h,048h,0B0h,079h,0D9h,0BEh,0DEh,0C0h,0CFh
0039+  B864 E510B279087AF4F348B079D9BEDEC0CF
0040+  B874                db 09Fh,03Bh,00Ah,00Ah,073h,089h,066h,0A3h,04Dh,01Ah,02Ah,01Fh,033h,019h,0B0h,0BEh
0040+  B874 9F3B0A0A738966A34D1A2A1F3319B0BE
0041+  B884                db 022h,087h,0B6h,072h,0D9h,0CBh,071h,056h,065h,06Fh,06Dh,064h,00Dh,0D3h,06Ah,04Ah
0041+  B884 2287B672D9CB7156656F6D640DD36A4A
0042+  B894                db 008h,0F7h,048h,05Fh,003h,0A7h,07Bh,042h,020h,0F2h,0D3h,0C8h,0E1h,0C4h,0ABh,046h
0042+  B894 08F7485F03A77B4220F2D3C8E1C4AB46
0043+  B8A4                db 0D9h,0F7h,05Bh,0DAh,0C8h,03Dh,071h,0FDh,074h,06Fh,079h,076h,072h,07Bh,0EBh,0C9h
0043+  B8A4 D9F75BDAC83D71FD746F7976727BEBC9
0044+  B8B4                db 04Ch,0A1h,00Dh,00Bh,09Bh,039h,08Eh,05Ch,0D5h,0B3h,0D6h,099h,03Bh,068h,096h,0CAh
0044+  B8B4 4CA10D0B9B398E5CD5B3D6993B6896CA
0045+  B8C4                db 04Bh,05Ch,0C0h,055h,09Fh,0D7h,074h,0DEh,0DBh,00Ch,001h,03Eh,027h,0DDh,040h,083h
0045+  B8C4 4B5CC0559FD774DEDB0C013E27DD4083
0046+  B8D4                db 086h,0CAh,07Ah,041h,0CBh,02Fh,04Eh,05Ah,0DBh,0CAh,07Eh,017h,0A1h,0BFh,049h,0E6h
0046+  B8D4 86CA7A41CB2F4E5ADBCA7E17A1BF49E6
0047+  B8E4                db 066h,0E8h,086h,084h,0A3h,042h,06Ah,05Ah,0C0h,0A4h,0D2h,097h,058h,0D5h,035h,01Bh
0047+  B8E4 66E88684A3426A5AC0A4D29758D5351B
0048+  B8F4                db 032h,024h,0D7h,0A8h,0B2h,076h,003h,0C1h,0A5h,012h,000h,0D0h,05Bh,082h,0CCh,00Dh
0048+  B8F4 3224D7A8B27603C1A51200D05B82CC0D
0049+  B904                db 01Bh,0CDh,004h,0C6h,095h,0F1h,042h,0D7h,075h,058h,0C0h,006h,0D7h,04Dh,0E5h,080h
0049+  B904 1BCD04C695F142D77558C006D74DE580
0050+  B914                db 06Ch,0CEh,033h,0CAh,0CFh,000h,0AAh,0DFh,0D1h,0CEh,05Ah,09Dh,0D5h,071h,0CAh,0CBh
0050+  B914 6CCE33CACF00AADFD1CE5A9DD571CACB
0051+  B924                db 0D4h,0CCh,0ADh,0B3h,0D7h,05Dh,074h,096h,003h,009h,0F8h,073h,0A2h,07Ah,0D5h,06Dh
0051+  B924 D4CCADB3D75D74960309F873A27AD56D
0052+  B934                db 02Dh,057h,01Ch,07Eh,0C7h,02Bh,03Eh,0D0h,0C8h,0B5h,0C9h,0ADh,0CAh,0CBh,06Bh,0CCh
0052+  B934 2D571C7EC72B3ED0C8B5C9ADCACB6BCC
0053+  B944                db 0CDh,052h,0DCh,0DBh,008h,000h,0C8h,0D2h,0CFh,07Ch,074h,078h,07Bh,0FBh,09Bh,07Eh
0053+  B944 CD52DCDB0800C8D2CF7C74787BFB9B7E
0054+  B954                db 07Dh,025h,03Eh,0C3h,076h,000h,07Eh,055h,0E4h,020h,068h,0DCh,06Bh,06Fh,09Ch,057h
0054+  B954 7D253EC376007E55E42068DC6B6F9C57
0055+  B964                db 0F2h,0C9h,00Ch,0F9h,099h,0C6h,047h,07Bh,088h,0C4h,055h,026h,099h,0D1h,0C9h,067h
0055+  B964 F2C90CF999C6477B88C4552699D1C967
0056+  B974                db 027h,089h,0E6h,053h,066h,08Ah,017h,0EBh,087h,085h,052h,019h,06Ah,0BEh,008h,080h
0056+  B974 2789E653668A17EB878552196ABE0880
0057+  B984                db 07Bh,078h,074h,03Bh,0F5h,0B2h,080h,089h,0BEh,0B3h,010h,06Bh,09Fh,0F0h,001h,087h
0057+  B984 7B78743BF5B28089BEB3106B9FF00187
0058+  B994                db 089h,050h,04Eh,06Fh,07Bh,017h,0DFh,039h,079h,00Eh,076h,0F1h,0BFh,0CDh,09Ch,067h
0058+  B994 89504E6F7B17DF39790E76F1BFCD9C67
0059+  B9A4                db 0C4h,0D1h,06Ah,09Ch,07Eh,0ABh,0B8h,07Dh,07Dh,060h,07Eh,077h,03Dh,0CBh,03Bh,0ACh
0059+  B9A4 C4D16A9C7EABB87D7D607E773DCB3BAC
0060+  B9B4                db 0C9h,0EFh,0B5h,0C7h,03Eh,0F6h,01Ah,0C2h,075h,0D3h,054h,06Fh,014h,0A3h,0E6h,0F2h
0060+  B9B4 C9EFB5C73EF61AC275D3546F14A3E6F2
0061+  B9C4                db 029h,07Bh,0F3h,029h,0C7h,01Bh,0BCh,086h,05Ah,0B3h,069h,08Eh,080h,0D3h,07Fh,019h
0061+  B9C4 297BF329C71BBC865AB3698E80D37F19
0062+  B9D4                db 0A6h,0D2h,053h,07Ch,010h,08Ch,087h,084h,080h,05Eh,048h,08Ah,074h,04Ch,07Bh,0EFh
0062+  B9D4 A6D2537C108C8784805E488A744C7BEF
0063+  B9E4                db 0A5h,0CDh,095h,056h,085h,0CEh,08Bh,0EFh,079h,028h,010h,0B7h,080h,082h,03Dh,009h
0063+  B9E4 A5CD955685CE8BEF792810B780823D09
0064+  B9F4                db 00Ch,001h,08Ah,0C4h,06Dh,089h,088h,031h,060h,0B1h,0CCh,088h,073h,087h,01Ch,086h
0064+  B9F4 0C018AC46D89883160B1CC8873871C86
0065+  BA04                db 071h,0C9h,085h,0B8h,009h,010h,006h,073h,029h,08Eh,003h,063h,010h,0CFh,0FDh,0FFh
0065+  BA04 71C985B809100673298E036310CFFDFF
0066+  BA14                db 026h,0B1h,030h,00Bh,010h,0ACh,051h,087h,0C7h,088h,01Ch,070h,089h,0F1h,0CDh,009h
0066+  BA14 26B1300B10AC5187C7881C7089F1CD09
0067+  BA24                db 00Ch,0A6h,038h,003h,0EDh,006h,0F6h,06Bh,013h,009h,00Ah,077h,08Fh,028h,060h,08Ch
0067+  BA24 0CA63803ED06F66B13090A778F28608C
0068+  BA34                db 0C8h,007h,08Fh,001h,090h,023h,036h,0E8h,00Eh,048h,045h,018h,0B0h,078h,0C7h,06Eh
0068+  BA34 C8078F01902336E80E484518B078C76E
0069+  BA44                db 099h,00Ch,08Bh,0A2h,00Dh,04Ch,060h,073h,077h,002h,004h,00Fh,0DDh,06Fh,02Fh,0DAh
0069+  BA44 990C8BA20D4C60737702040FDD6F2FDA
0070+  BA54                db 005h,06Eh,04Fh,090h,06Dh,073h,0BFh,019h,09Ch,0CCh,0EFh,0E6h,0EEh,067h,033h,0EDh
0070+  BA54 056E4F906D73BF199CCCEFE6EE6733ED
0071+  BA64                db 039h,031h,0E1h,010h,011h,074h,042h,087h,00Ch,0D4h,0E1h,0C7h,084h,005h,08Eh,083h
0071+  BA64 3931E110117442870CD4E1C784058E83
0072+  BA74                db 063h,08Eh,082h,038h,081h,0D2h,0E6h,0D6h,002h,00Dh,021h,02Ch,032h,014h,000h,001h
0072+  BA74 638E823881D2E6D6020D212C32140001
0254   BA84             MUSIC6:		db 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
0254   BA84 000102030405060708090A0B0C0D0E0F
0255   BA94             			INCLUDE	"audio\music6.asm"
0001+  BA94                ;  07 EMPTY.pt3, without 100 bytes of header, compressed by Mizer
0002+  BA94                db 011h,005h,031h,004h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,011h,004h
0002+  BA94 11053104000000000000000000001104
0003+  BAA4                db 000h,000h,000h,000h,000h,000h,052h,006h,000h,000h,0ECh,003h,001h,000h,0CBh,020h
0003+  BAA4 00000000000052060000EC030100CB20
0004+  BAB4                db 010h,08Eh,0D5h,0FFh,0FFh,0D1h,051h,08Fh,0B1h,040h,0C0h,076h,0FCh,000h,001h
0004+  BAB4 108ED5FFFFD1518FB140C076FC0001
0256   BAC3             
0257   BAC3             ;-------------------------------------
0258   BAC3             ;
0259   BAC3             ;      AYFX replayer
0260   BAC3             ;
0261   BAC3             ;-------------------------------------
0262   BAC3             ;
0263   BAC3             ; --- INCLUDE ayFX-ROM.ASM
0264   BAC3             
0265   BAC3                     INCLUDE "audio\ayFX-ROM.ASM"
0001+  BAC3             		; --- ayFX REPLAYER v1.11r ---
0002+  BAC3             
0003+  BAC3             		; --- v1.11r If a frame volume is zero then no AYREGS update
0004+  BAC3             		; --- v1.1r  Relative volume using PT3 Volume Table
0005+  BAC3             		; --- v1.1   Explicit priority (as suggested by AR)
0006+  BAC3             		; --- v1.0f  Bug fixed (error when using noise)
0007+  BAC3             		; --- v1.0   Initial release
0008+  BAC3             
0009+  BAC3             ayFX_SETUP:	; --- ayFX replayer setup ---
0010+  BAC3 3E 01       		ld	a,1				; Starting channel
0011+  BAC5 32 D2 E5    		ld	[ayFX_CHANNEL],a		; Updated
0012+  BAC8             ayFX_END:	; --- End of an ayFX stream ---
0013+  BAC8 3E FF       		ld	a,255				; Lowest ayFX priority
0014+  BACA 32 CB E5    		ld	[ayFX_PRIORITY],a		; Priority saved (not playing ayFX stream)
0015+  BACD C9          		ret					; Return
0016+  BACE             
0017+  BACE             ayFX_INIT:	; ---     INIT A NEW ayFX STREAM     ---
0018+  BACE             		; --- INPUT: A -> sound to be played ---
0019+  BACE             		; ---        C -> sound priority     ---
0020+  BACE C5          		push	bc				; Store bc in stack
0021+  BACF D5          		push	de				; Store de in stack
0022+  BAD0 E5          		push	hl				; Store hl in stack
0023+  BAD1 47          		ld	b,a				; b:=a (new ayFX stream index)
0024+  BAD2 3A CB E5    		ld	a,[ayFX_PRIORITY]		; a:=Current ayFX stream priority
0025+  BAD5 B9          		cp	c				; If new ayFX stream priority is higher than currently one...
0026+  BAD6 DA 0A BB    		jp	c,_INIT_END			; ...we don't start the new ayFX stream
0027+  BAD9             		; --- INITS ---
0028+  BAD9 79          		ld	a,c				; a:=New priority
0029+  BADA E6 0F       		and	$0F				; We mask the priority
0030+  BADC 32 CB E5    		ld	[ayFX_PRIORITY],a		; new ayFX stream priority saved in RAM
0031+  BADF             		; --- Volume adjust using PT3 volume table ---
0032+  BADF 4F          		ld	c,a				; c:=New priority (fixed)
0033+  BAE0 3E 0F       		ld	a,15				; a:=15
0034+  BAE2 91          		sub	c				; a:=15-New priority = relative volume
0035+  BAE3 CA 0E BB    		jp	z,_INIT_NOSOUND		; If priority is 15 -> no sound output (volume is zero)
0036+  BAE6             
0037+  BAE6 21 D5 E5            ld  hl,_psg_vol_fix
0038+  BAE9 86                  add a,(hl)
0039+  BAEA FA 0E BB            jp  m,_INIT_NOSOUND
0040+  BAED             
0041+  BAED 87          		add	a,a				; a:=a*2
0042+  BAEE 87          		add	a,a				; a:=a*4
0043+  BAEF 87          		add	a,a				; a:=a*8
0044+  BAF0 87          		add	a,a				; a:=a*16
0045+  BAF1 5F          		ld	e,a				; e:=a
0046+  BAF2 16 00       		ld	d,0				; de:=a
0047+  BAF4 21 CB E4    		ld	hl,VT_				; hl:=PT3 volume table
0048+  BAF7 19          		add	hl,de				; hl is a pointer to the relative volume table
0049+  BAF8 22 D3 E5    		ld	[ayFX_VT],hl			; Save pointer
0050+  BAFB             		; --- ayFX stream pointer ---
0051+  BAFB 68          		ld	l,b				; l:=b (new ayFX stream index)
0052+  BAFC 26 00       		ld	h,0				; hl:=b (new ayFX stream index)
0053+  BAFE 29          		add	hl,hl				; hl:=hl*2
0054+  BAFF 11 B9 BB    		ld	de,ayFX_STREAMS			; Pointer to the pointer list of the ayFX streams
0055+  BB02 19          		add	hl,de				; Pointer to the pointer of new ayFX stream to be played
0056+  BB03 5E          		ld	e,[hl]				; e:=lower byte of new ayFX stream pointer
0057+  BB04 23          		inc	hl				; Increment pointer to the pointer
0058+  BB05 56          		ld	d,[hl]				; de:=pointer to the new ayFX stream
0059+  BB06 ED 53 CC E5 		ld	[ayFX_POINTER],de		; Pointer saved in RAM
0060+  BB0A E1          _INIT_END:	pop	hl				; Retrieve hl from stack
0061+  BB0B D1          		pop	de				; Retrieve de from stack
0062+  BB0C C1          		pop	bc				; Retrieve bc from stack
0063+  BB0D C9          		ret					; Return
0064+  BB0E             _INIT_NOSOUND:	; --- Init a sample with relative volume zero -> no sound output ---
0065+  BB0E 3E FF       		ld	a,255				; Lowest ayFX priority
0066+  BB10 32 CB E5    		ld	[ayFX_PRIORITY],a		; Priority saved (not playing ayFX stream)
0067+  BB13 C3 0A BB    		jp	_INIT_END			; Jumps to _INIT_END
0068+  BB16             
0069+  BB16             ayFX_FRAME:
0070+  BB16             ayFX_PLAY:	; --- PLAY A FRAME OF AN ayFX STREAM ---
0071+  BB16 3A CB E5    		ld	a,[ayFX_PRIORITY]		; a:=Current ayFX stream priority
0072+  BB19 B7          		or	a				; If priority has bit 7 on...
0073+  BB1A F8          		ret	m				; ...return
0074+  BB1B             		; --- Extract control byte from stream ---
0075+  BB1B 2A CC E5    		ld	hl,[ayFX_POINTER]		; Pointer to the current ayFX stream
0076+  BB1E 4E          		ld	c,[hl]				; c:=Control byte
0077+  BB1F 23          		inc	hl				; Increment pointer
0078+  BB20             		; --- Check if there's new tone on stream ---
0079+  BB20 CB 69       		bit	5,c				; If bit 5 c is off...
0080+  BB22 CA 2D BB    		jp	z,_CHECK_NN			; ...jump to _CHECK_NN (no new tone)
0081+  BB25             		; --- Extract new tone from stream ---
0082+  BB25 5E          		ld	e,[hl]				; e:=lower byte of new tone
0083+  BB26 23          		inc	hl				; Increment pointer
0084+  BB27 56          		ld	d,[hl]				; d:=higher byte of new tone
0085+  BB28 23          		inc	hl				; Increment pointer
0086+  BB29 ED 53 CE E5 		ld	[ayFX_TONE],de			; ayFX tone updated
0087+  BB2D             _CHECK_NN:	; --- Check if there's new noise on stream ---
0088+  BB2D CB 71       		bit	6,c				; if bit 6 c is off...
0089+  BB2F CA 3C BB    		jp	z,_SETPOINTER			; ...jump to _SETPOINTER (no new noise)
0090+  BB32             		; --- Extract new noise from stream ---
0091+  BB32 7E          		ld	a,[hl]				; a:=New noise
0092+  BB33 23          		inc	hl				; Increment pointer
0093+  BB34 FE 20       		cp	$20				; If it's an illegal value of noise (used to mark end of stream)...
0094+  BB36 CA C8 BA    		jp	z,ayFX_END			; ...jump to ayFX_END
0095+  BB39 32 D0 E5    		ld	[ayFX_NOISE],a			; ayFX noise updated
0096+  BB3C             _SETPOINTER:	; --- Update ayFX pointer ---
0097+  BB3C 22 CC E5    		ld	[ayFX_POINTER],hl		; Update ayFX stream pointer
0098+  BB3F             		; --- Extract volume ---
0099+  BB3F 79          		ld	a,c				; a:=Control byte
0100+  BB40 E6 0F       		and	$0F				; lower nibble
0101+  BB42             		; --- Fix the volume using PT3 Volume Table ---
0102+  BB42 2A D3 E5    		ld	hl,[ayFX_VT]			; hl:=Pointer to relative volume table
0103+  BB45 5F          		ld	e,a				; e:=a (ayFX volume)
0104+  BB46 16 00       		ld	d,0				; d:=0
0105+  BB48 19          		add	hl,de				; hl:=hl+de (hl points to the relative volume of this frame
0106+  BB49 7E          		ld	a,[hl]				; a:=ayFX relative volume
0107+  BB4A 32 D1 E5    		ld	[ayFX_VOLUME],a			; ayFX volume updated
0108+  BB4D B7          		or	a				; If relative volume is zero...
0109+  BB4E C8          		ret	z				; ...return (don't copy ayFX values in to AYREGS)
0110+  BB4F             		; -------------------------------------
0111+  BB4F             		; --- COPY ayFX VALUES IN TO AYREGS ---
0112+  BB4F             		; -------------------------------------
0113+  BB4F             		; --- Set noise channel ---
0114+  BB4F CB 79       		bit	7,c				; If noise is off...
0115+  BB51 C2 5A BB    		jp	nz,_SETMASKS			; ...jump to _SETMASKS
0116+  BB54 3A D0 E5    		ld	a,[ayFX_NOISE]			; ayFX noise value
0117+  BB57 32 D1 E4    		ld	[AYREGS+6],a			; copied in to AYREGS (noise channel)
0118+  BB5A             _SETMASKS:	; --- Set mixer masks ---
0119+  BB5A 79          		ld	a,c				; a:=Control byte
0120+  BB5B E6 90       		and	$90				; Only bits 7 and 4 (noise and tone mask for psg reg 7)
0121+  BB5D FE 90       		cp	$90				; If no noise and no tone...
0122+  BB5F C8          		ret	z				; ...return (don't copy ayFX values in to AYREGS)
0123+  BB60             		; --- Copy ayFX values in to ARYREGS ---
0124+  BB60 CB 0F       		rrc	a				; Rotate a to the right (1 TIME)
0125+  BB62 CB 0F       		rrc	a				; Rotate a to the right (2 TIMES) (OR mask)
0126+  BB64 16 DB       		ld	d,$DB				; d:=Mask for psg mixer (AND mask)
0127+  BB66             		; --- Calculate next ayFX channel ---
0128+  BB66 21 D2 E5    		ld	hl,ayFX_CHANNEL			; Old ayFX playing channel
0129+  BB69 35          		dec	[hl]				; New ayFX playing channel
0130+  BB6A C2 6F BB    		jp	nz,_SETCHAN			; If not zero jump to _SETCHAN
0131+  BB6D 36 03       		ld	[hl],3				; If zero -> set channel 3
0132+  BB6F 46          _SETCHAN:	ld	b,[hl]				; Channel counter
0133+  BB70             _CHK1:		; --- Check if playing channel was 1 ---
0134+  BB70 10 10       		djnz	_CHK2				; Decrement and jump if channel was not 1
0135+  BB72             _PLAY_C:	; --- Play ayFX stream on channel C ---
0136+  BB72 CD AC BB    		call	_SETMIXER			; Set PSG mixer value (a:=ayFX volume)
0137+  BB75 32 D5 E4    		ld	[AYREGS+10],a			; Volume copied in to AYREGS (channel C volume)
0138+  BB78 CB 51       		bit	2,c				; If tone is off...
0139+  BB7A C0          		ret	nz				; ...return
0140+  BB7B 2A CE E5    		ld	hl,[ayFX_TONE]			; ayFX tone value
0141+  BB7E 22 CF E4    		ld	[AYREGS+4],hl			; copied in to AYREGS (channel C tone)
0142+  BB81 C9          		ret					; Return
0143+  BB82             _CHK2:		; --- Check if playing channel was 2 ---
0144+  BB82 CB 0A       		rrc	d				; Rotate right AND mask
0145+  BB84 CB 0F       		rrc	a				; Rotate right OR mask
0146+  BB86 10 10       		djnz	_CHK3				; Decrement and jump if channel was not 2
0147+  BB88             _PLAY_B:	; --- Play ayFX stream on channel B ---
0148+  BB88 CD AC BB    		call	_SETMIXER			; Set PSG mixer value (a:=ayFX volume)
0149+  BB8B 32 D4 E4    		ld	[AYREGS+9],a			; Volume copied in to AYREGS (channel B volume)
0150+  BB8E CB 49       		bit	1,c				; If tone is off...
0151+  BB90 C0          		ret	nz				; ...return
0152+  BB91 2A CE E5    		ld	hl,[ayFX_TONE]			; ayFX tone value
0153+  BB94 22 CD E4    		ld	[AYREGS+2],hl			; copied in to AYREGS (channel B tone)
0154+  BB97 C9          		ret					; Return
0155+  BB98             _CHK3:		; --- Check if playing channel was 3 ---
0156+  BB98 CB 0A       		rrc	d				; Rotate right AND mask
0157+  BB9A CB 0F       		rrc	a				; Rotate right OR mask
0158+  BB9C             _PLAY_A:	; --- Play ayFX stream on channel A ---
0159+  BB9C CD AC BB    		call	_SETMIXER			; Set PSG mixer value (a:=ayFX volume)
0160+  BB9F 32 D3 E4    		ld	[AYREGS+8],a			; Volume copied in to AYREGS (channel A volume)
0161+  BBA2 CB 41       		bit	0,c				; If tone is off...
0162+  BBA4 C0          		ret	nz				; ...return
0163+  BBA5 2A CE E5    		ld	hl,[ayFX_TONE]			; ayFX tone value
0164+  BBA8 22 CB E4    		ld	[AYREGS+0],hl			; copied in to AYREGS (channel A tone)
0165+  BBAB C9          		ret					; Return
0166+  BBAC             _SETMIXER:	; --- Set PSG mixer value ---
0167+  BBAC 4F          		ld	c,a				; c:=OR mask
0168+  BBAD 3A D2 E4    		ld	a,[AYREGS+7]			; a:=PSG mixer value
0169+  BBB0 A2          		and	d				; AND mask
0170+  BBB1 B1          		or	c				; OR mask
0171+  BBB2 32 D2 E4    		ld	[AYREGS+7],a			; PSG mixer value updated
0172+  BBB5 3A D1 E5    		ld	a,[ayFX_VOLUME]			; a:=ayFX volume value
0173+  BBB8 C9          		ret					; Return
0174+  BBB9             
0175+  BBB9             		; --- UNCOMMENT THIS IF YOU DON'T USE THIS REPLAYER WITH PT3 REPLAYER ---
0176+  BBB9             ;VT_:		.INCBIN	"VT.BIN"
0177+  BBB9             		; --- UNCOMMENT THIS IF YOU DON'T USE THIS REPLAYER WITH PT3 REPLAYER ---
0178+  BBB9             		
0266   BBB9             		
0267   BBB9             ; --- INCLUDE ayFX - data
0268   BBB9             
0269   BBB9             ayFX_STREAMS:
0270   BBB9                     dw sfx0,  sfx1, sfx2, sfx3, sfx4, sfx5, sfx6, sfx7,sfx8,sfx9,sfx10
0270   BBB9 CFBBFBBB22BC67BCACBCD3BCF8BC1FBD58BD93BDD5BD
0271   BBCF             
0272   BBCF             sfx0:   incbin   "audio\afx\04_chest.afx"
0273   BBFB             sfx1:   incbin   "audio\afx\05_coin.afx"
0274   BC22             sfx2:   incbin   "audio\afx\01_stairdwn.afx"
0275   BC67             sfx3:   incbin   "audio\afx\02_stairup.afx"
0276   BCAC             sfx4:   incbin   "audio\afx\03_opendoor.afx"
0277   BCD3             sfx5:   incbin   "audio\afx\06_powerup.afx"
0278   BCF8             sfx6:   incbin   "audio\afx\07_potionsm.afx"
0279   BD1F             sfx7:   incbin   "audio\afx\08_potionbg.afx"
0280   BD58             sfx8:   incbin   "audio\afx\09_enehit_1.afx"
0281   BD93             sfx9:   incbin   "audio\afx\10_enehit_2.afx"
0282   BDD5             sfx10:  incbin   "audio\afx\11_plyr_hit.afx"
0283   BDFC             ;-------------------------------------
0284   BDFC             ; intro data
0285   BDFC             ;-------------------------------------
0286   BDFC             
0287   BDFC             firecol:
0288   BDFC                         ;incbin intro\tiles.col.bin.miz
0289   BDFC             
0290   BDFC                     
0291   BDFC             ;-------------------------------------
0292   BDFC             ; Padding, align rom image to a power of two.
0293   BDFC             ;-------------------------------------
0294   BDFC             
0295   BDFC 00          		ds	$C000 - $
0296   C000             
0297   C000             MAXLASTLEVEL = 40
0298   C000             MAXCHESTS    = 5
0299   C000             
0300   C000             		; --- RAM SECTION ---
0301   C000                     MAP 0xc000
0302   C000             
0303   C000             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0304   C000             
0305   C000             nround      FIELD 3
0306   C000             PAGE0       FIELD 256        ; emulate 6502 page 0
0307   C000             buffer      FIELD  2048         ; buffer for unpack
0308   C000             hidden      FIELD 1024       ; hidden level (emulate VIC color ram)
0309   C000             visible     FIELD 1024       ; visible area (emulate VIC color ram)
0310   C000             
0311   C000             dummy       FIELD 100
0312   C000             MUSICBUFF   FIELD 4096
0313   C000             
0314   C000             storedseed  FIELD 1
0315   C000             
0316   C000             levels      FIELD 256        ; dungeon level pseudo-random seeds
0317   C000             
0318   C000             seeds       FIELD MAXLASTLEVEL              ; store the seed for each level
0319   C000             memchst     FIELD MAXLASTLEVEL              ; store the chest status in each floor of the dungeon
0320   C000             locchst     FIELD 2*MAXLASTLEVEL*MAXCHESTS  ; store the chest position in each floor of the dungeon
0321   C000             
0322   C000             
0323   C000             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0324   C000             
0325   C000             vsf         FIELD 1          ; 0 if 50Hz, !0 if 60Hz
0326   C000             cnt         FIELD 1          ; couter to compensate NTSC machines
0327   C000             
0328   C000             	; --- INCLUDE PT3-RAM.ASM in RAM section (no code output, but label definitions) ---
0329   C000             
0330   C000                     INCLUDE	"audio\PT3-RAM.ASM"
0001+  C000             		; --- THIS FILE MUST BE COMPILED IN RAM ---
0002+  C000             
0003+  C000             		; --- PT3 WORKAREA [self-modifying code patched] ---
0004+  C000             
0005+  C000             PT3_SETUP:		FIELD	1	;set bit0 to 1, if you want to play without looping
0006+  C000             					        ;bit7 is set each time, when loop point is passed
0007+  C000             PT3_MODADDR:		FIELD	2
0008+  C000             PT3_CrPsPtr:		FIELD	2  ; Patter# = CrPsPtr-song_buffer-101;
0009+  C000             PT3_SAMPTRS:		FIELD	2
0010+  C000             PT3_OrnPtrs:		FIELD	2
0011+  C000             PT3_PDSP:		FIELD	2
0012+  C000             PT3_CSP:		FIELD	2
0013+  C000             PT3_PSP:		FIELD	2
0014+  C000             PT3_PrNote:		FIELD	1
0015+  C000             PT3_PrSlide:		FIELD	2
0016+  C000             PT3_AdInPtA:		FIELD	2
0017+  C000             PT3_AdInPtB:		FIELD	2
0018+  C000             PT3_AdInPtC:		FIELD	2
0019+  C000             PT3_LPosPtr:		FIELD	2
0020+  C000             PT3_PatsPtr:		FIELD	2
0021+  C000             PT3_Delay:		FIELD	1
0022+  C000             PT3_AddToEn:		FIELD	1
0023+  C000             PT3_Env_Del:		FIELD	1
0024+  C000             PT3_ESldAdd:		FIELD	2
0025+  C000             
0026+  C000             VARS: FIELD 0
0027+  C000             
0028+  C000             ChanA:			FIELD	30			;CHNPRM_Size
0029+  C000             ChanB:			FIELD	30			;CHNPRM_Size
0030+  C000             ChanC:			FIELD	30			;CHNPRM_Size
0031+  C000             
0032+  C000             ;GlobalVars
0033+  C000             DelyCnt:		FIELD	1
0034+  C000             CurESld:		FIELD	2
0035+  C000             CurEDel:		FIELD	1
0036+  C000             
0037+  C000             Ns_Base_AddToNs:    FIELD 0
0038+  C000             Ns_Base:		FIELD	1
0039+  C000             AddToNs:		FIELD	1
0040+  C000             
0041+  C000             AYREGS:     FIELD 0
0042+  C000             VT_:			FIELD	14
0043+  C000             EnvBase:		FIELD	2
0044+  C000             VAR0END:		FIELD	240
0331   C000                     INCLUDE "audio\ayFX-RAM.ASM"
0001+  C000             		; --- ayFX REPLAYER v1.11r ---
0002+  C000             
0003+  C000             		; --- THIS FILE MUST BE COMPILED IN RAM ---
0004+  C000             
0005+  C000             ayFX_PRIORITY:	FIELD	1			; Current ayFX stream priority
0006+  C000             ayFX_POINTER:	FIELD	2			; Pointer to the current ayFX stream
0007+  C000             ayFX_TONE:	    FIELD	2			; Current tone of the ayFX stream
0008+  C000             ayFX_NOISE:	    FIELD	1			; Current noise of the ayFX stream
0009+  C000             ayFX_VOLUME:	FIELD	1			; Current volume of the ayFX stream
0010+  C000             ayFX_CHANNEL:	FIELD	1			; PSG channel to play the ayFX stream
0011+  C000             ayFX_VT:	    FIELD	2			; ayFX relative volume table pointer
0012+  C000             
0013+  C000             _psg_vol_fix:   FIELD	1
0014+  C000             
0015+  C000             		; --- UNCOMMENT THIS IF YOU DON'T USE THIS REPLAYER WITH PT3 REPLAYER ---
0016+  C000             ;AYREGS:		.ds	14			; Ram copy of PSG registers
0017+  C000             		; --- UNCOMMENT THIS IF YOU DON'T USE THIS REPLAYER WITH PT3 REPLAYER ---
0332   C000             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0333   C000             ; Helper variables from PT3 mobule
0334   C000             ;
0335   C000             
0336   C000             ; pt3 samples previously detected (times 2)
0337   C000             
0338   C000             OSmplA          FIELD 1
0339   C000             OSmplB          FIELD 1
0340   C000             OSmplC          FIELD 1
0341   C000             
0342   C000             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0343   C000             
0344   C000             wchA    FIELD 1                  ; wave on channel A
0345   C000             wchB    FIELD 1                  ; wave on channel B
0346   C000             wchC    FIELD 1                  ; wave on channel C
0347   C000             
0348   C000             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0349   C000             _waves	FIELD	15
0350   C000             
0351   C000             
0352   C000             ; ==========
0353   C000             ;    Data
0354   C000             ; ==========
0355   C000             
0356   C000             SLOT            FIELD     1
0357   C000             PAGE1RAM        FIELD     1
0358   C000             RAMSLOT         FIELD     1
0359   C000             
0360   C000             SCC             FIELD     1
0361   C000             SUB             FIELD     1
0362   C000             
0363   C000             AYREGS_CPY:     FIELD  13
0364   C000             
0365   C000             
0366   C000             VolBalance:     FIELD 2
0367   C000                 ;dw VT_
0368   C000             ; =================
0369   C000             ;    Program end
0370   C000             ; =================
0371   C000             
0372   C000             
0373   C000                     ENDMAP
0374   C000             
0375   C000             
